Most of this library is taken from https://github.com/binji/wasm-clang