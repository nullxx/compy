<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:07:09 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>avc_cache_stats</title>

</head>
<body>

<h1 align="center">avc_cache_stats</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">avc_cache_stats,
avc_av_stats, avc_sid_stats &minus; obtain userspace SELinux
AVC statistics</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;selinux/selinux.h&gt; <br>
#include &lt;selinux/avc.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
avc_av_stats(void);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
avc_sid_stats(void);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
avc_cache_stats(struct avc_cache_stats
*</b><i>stats</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The userspace
AVC maintains two internal hash tables, one to store
security ID&rsquo;s and one to cache access decisions.</p>


<p style="margin-left:11%; margin-top: 1em"><b>avc_av_stats</b>()
and <b>avc_sid_stats</b>() produce log messages indicating
the status of the access decision and SID tables,
respectively. The messages contain the number of entries in
the table, number of hash buckets and number of buckets
used, and maximum number of entries in a single bucket.</p>


<p style="margin-left:11%; margin-top: 1em"><b>avc_cache_stats</b>()
populates a structure whose fields reflect cache
activity:</p>

<p style="margin-left:22%; margin-top: 1em">struct
avc_cache_stats {</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>entry_lookups;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>entry_hits;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>entry_misses;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>entry_discards;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>cav_lookups;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>cav_hits;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>cav_probes;</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">
</td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>unsigned</p></td></tr>
<tr valign="top" align="left">
<td width="6%"></td>
<td width="16%"></td>
<td width="78%">


<p>cav_misses;</p></td></tr>
</table>

<p style="margin-left:22%;">};</p>

<p style="margin-left:11%;"><i>entry_lookups</i></p>

<p style="margin-left:22%;">Number of queries made.</p>

<p style="margin-left:11%;"><i>entry_hits</i></p>

<p style="margin-left:22%;">Number of times a decision was
found in the <i>aeref</i> argument.</p>

<p style="margin-left:11%;"><i>entry_misses</i></p>

<p style="margin-left:22%;">Number of times a decision was
not found in the <i>aeref</i> argument.</p>

<p style="margin-left:11%;"><i>entry_discards</i></p>

<p style="margin-left:22%;">Number of times a decision was
not found in the <i>aeref</i> argument and the <i>aeref</i>
argument was non-NULL.</p>

<p style="margin-left:11%;"><i>cav_lookups</i></p>

<p style="margin-left:22%;">Number of cache lookups.</p>

<p style="margin-left:11%;"><i>cav_hits</i></p>

<p style="margin-left:22%;">Number of cache hits.</p>

<p style="margin-left:11%;"><i>cav_misses</i></p>

<p style="margin-left:22%;">Number of cache misses.</p>

<p style="margin-left:11%;"><i>cav_probes</i></p>

<p style="margin-left:22%;">Number of entries examined
while searching the cache.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When the cache
is flushed as a result of a call to <b>avc_reset</b>() or a
policy change notification, the statistics returned by
<b>avc_cache_stats</b>() are reset to zero. The SID table,
however, is left unchanged.</p>

<p style="margin-left:11%; margin-top: 1em">When a policy
change notification is received, a call to
<b>avc_av_stats</b>() is made before the cache is
flushed.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Eamon Walsh
&lt;ewalsh@tycho.nsa.gov&gt;</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>avc_init</b>(3),
<b>avc_has_perm</b>(3), <b>avc_context_to_sid</b>(3),
<b>avc_add_callback</b>(3), <b>selinux</b>(8)</p>
<hr>
</body>
</html>
