<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:23:38 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>BOOTUP</title>

</head>
<body>

<h1 align="center">BOOTUP</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#SYSTEM MANAGER BOOTUP">SYSTEM MANAGER BOOTUP</a><br>
<a href="#BOOTUP IN THE INITIAL RAM DISK (INITRD)">BOOTUP IN THE INITIAL RAM DISK (INITRD)</a><br>
<a href="#SYSTEM MANAGER SHUTDOWN">SYSTEM MANAGER SHUTDOWN</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">bootup &minus;
System bootup process</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A number of
different components are involved in the system boot.
Immediately after power&minus;up, the system BIOS will do
minimal hardware initialization, and hand control over to a
boot loader stored on a persistent storage device. This boot
loader will then invoke an OS kernel from disk (or the
network). In the Linux case, this kernel (optionally)
extracts and executes an initial RAM disk image (initrd),
such as generated by <b>dracut</b>(8), which looks for the
root file system (possibly using <b>systemd</b>(1) for
this). After the root file system is found and mounted, the
initrd hands over control to the host's system manager (such
as <b>systemd</b>(1)) stored on the OS image, which is then
responsible for probing all remaining hardware, mounting all
necessary file systems and spawning all configured
services.</p>

<p style="margin-left:11%; margin-top: 1em">On shutdown,
the system manager stops all services, unmounts all file
systems (detaching the storage technologies backing them),
and then (optionally) jumps back into the initrd code which
unmounts/detaches the root file system and the storage it
resides on. As a last step, the system is powered down.</p>

<p style="margin-left:11%; margin-top: 1em">Additional
information about the system boot process may be found in
<b>boot</b>(7).</p>

<h2>SYSTEM MANAGER BOOTUP
<a name="SYSTEM MANAGER BOOTUP"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">At boot, the
system manager on the OS image is responsible for
initializing the required file systems, services and drivers
that are necessary for operation of the system. On
<b>systemd</b>(1) systems, this process is split up in
various discrete steps which are exposed as target units.
(See <b>systemd.target</b>(5) for detailed information about
target units.) The boot&minus;up process is highly
parallelized so that the order in which specific target
units are reached is not deterministic, but still adheres to
a limited amount of ordering structure.</p>

<p style="margin-left:11%; margin-top: 1em">When systemd
starts up the system, it will activate all units that are
dependencies of default.target (as well as recursively all
dependencies of these dependencies). Usually, default.target
is simply an alias of graphical.target or
multi&minus;user.target, depending on whether the system is
configured for a graphical UI or only for a text console. To
enforce minimal ordering between the units pulled in, a
number of well&minus;known target units are available, as
listed on <b>systemd.special</b>(7).</p>

<p style="margin-left:11%; margin-top: 1em">The following
chart is a structural overview of these well&minus;known
units and their position in the boot&minus;up logic. The
arrows describe which units are pulled in and ordered before
which other units. Units near the top are started before
units nearer to the bottom of the chart.</p>


<p style="margin-left:17%; margin-top: 1em">local&minus;fs&minus;pre.target
<br>
| <br>
v <br>
(various mounts and (various swap (various cryptsetup <br>
fsck services...) devices...) devices...) (various
low&minus;level (various low&minus;level <br>
| | | services: udevd, API VFS mounts: <br>
v v v tmpfiles, random mqueue, configfs, <br>
local&minus;fs.target swap.target cryptsetup.target seed,
sysctl, ...) debugfs, ...) <br>
| | | | | <br>
\__________________|_________________ |
___________________|____________________/ <br>
\|/ <br>
v <br>
sysinit.target <br>
| <br>

____________________________________/|\________________________________________
<br>
/ | | | \ <br>
| | | | | <br>
v v | v v <br>
(various (various | (various rescue.service <br>
timers...) paths...) | sockets...) | <br>
| | | | v <br>
v v | v <i>rescue.target</i> <br>
timers.target paths.target | sockets.target <br>
| | | | <br>
v \_________________ | ___________________/ <br>
\|/ <br>
v <br>
basic.target <br>
| <br>
____________________________________/| emergency.service
<br>
/ | | | <br>
| | | v <br>
v v v <i>emergency.target</i> <br>
display&minus; (various system (various system <br>
manager.service services services) <br>
| required for | <br>
| graphical UIs) v <br>
| | <i>multi&minus;user.target</i> <br>
| | | <br>
\_________________ | _________________/ <br>
\|/ <br>
v <i><br>
graphical.target</i></p>

<p style="margin-left:11%; margin-top: 1em">Target units
that are commonly used as boot targets are
<i>emphasized</i>. These units are good choices as goal
targets, for example by passing them to the
<i>systemd.unit=</i> kernel command line option (see
<b>systemd</b>(1)) or by symlinking default.target to
them.</p>

<p style="margin-left:11%; margin-top: 1em">timers.target
is pulled&minus;in by basic.target asynchronously. This
allows timers units to depend on services which become only
available later in boot.</p>

<h2>BOOTUP IN THE INITIAL RAM DISK (INITRD)
<a name="BOOTUP IN THE INITIAL RAM DISK (INITRD)"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The initial RAM
disk implementation (initrd) can be set up using systemd as
well. In this case, boot up inside the initrd follows the
following structure.</p>

<p style="margin-left:11%; margin-top: 1em">The default
target in the initrd is initrd.target. The bootup process
begins identical to the system manager bootup (see above)
until it reaches basic.target. From there, systemd
approaches the special target initrd.target. If the root
device can be mounted at /sysroot, the sysroot.mount unit
becomes active and initrd&minus;root&minus;fs.target is
reached. The service initrd&minus;parse&minus;etc.service
scans /sysroot/etc/fstab for a possible /usr mount point and
additional entries marked with the
<i>x&minus;initrd.mount</i> option. All entries found are
mounted below /sysroot, and initrd&minus;fs.target is
reached. The service initrd&minus;cleanup.service isolates
to the initrd&minus;switch&minus;root.target, where cleanup
services can run. As the very last step, the
initrd&minus;switch&minus;root.service is activated, which
will cause the system to switch its root to /sysroot.</p>

<p style="margin-left:17%; margin-top: 1em">: (beginning
identical to above) <br>
: <br>
v <br>
basic.target <br>
| emergency.service <br>
______________________/| | <br>
/ | v <br>
| sysroot.mount <i>emergency.target</i> <br>
| | <br>
| v <br>
| initrd&minus;root&minus;fs.target <br>
| | <br>
| v <br>
v initrd&minus;parse&minus;etc.service <br>
(custom initrd | <br>
services...) v <br>
| (sysroot&minus;usr.mount and <br>
| various mounts marked <br>
| with fstab option <br>
| x&minus;initrd.mount...) <br>
| | <br>
| v <br>
| initrd&minus;fs.target <br>
\______________________ | <br>
\| <br>
v <br>
initrd.target <br>
| <br>
v <br>
initrd&minus;cleanup.service <br>
isolates to <br>
initrd&minus;switch&minus;root.target <br>
| <br>
v <br>
______________________/| <br>
/ v <br>
| initrd&minus;udevadm&minus;cleanup&minus;db.service <br>
v | <br>
(custom initrd | <br>
services...) | <br>
\______________________ | <br>
\| <br>
v <br>
initrd&minus;switch&minus;root.target <br>
| <br>
v <br>
initrd&minus;switch&minus;root.service <br>
| <br>
v <br>
Transition to Host OS</p>

<h2>SYSTEM MANAGER SHUTDOWN
<a name="SYSTEM MANAGER SHUTDOWN"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">System shutdown
with systemd also consists of various target units with some
minimal ordering structure applied:</p>

<p style="margin-left:17%; margin-top: 1em">(conflicts with
(conflicts with <br>
all system all file system <br>
services) mounts, swaps, <br>
| cryptsetup <br>
| devices, ...) <br>
| | <br>
v v <br>
shutdown.target umount.target <br>
| | <br>
\_______ ______/ <br>
\ / <br>
v <br>
(various low&minus;level <br>
services) <br>
| <br>
v <br>
final.target <br>
| <br>
_____________________________________/
\_________________________________ <br>
/ | | \ <br>
| | | | <br>
v v v v <br>
systemd&minus;reboot.service systemd&minus;poweroff.service
systemd&minus;halt.service systemd&minus;kexec.service <br>
| | | | <br>
v v v v <i><br>
reboot.target poweroff.target halt.target
kexec.target</i></p>

<p style="margin-left:11%; margin-top: 1em">Commonly used
system shutdown targets are <i>emphasized</i>.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>systemd</b>(1),
<b>boot</b>(7), <b>systemd.special</b>(7),
<b>systemd.target</b>(5), <b>dracut</b>(8)</p>
<hr>
</body>
</html>
