<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:07:54 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>FMTMSG</title>

</head>
<body>

<h1 align="center">FMTMSG</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#ENVIRONMENT">ENVIRONMENT</a><br>
<a href="#VERSIONS">VERSIONS</a><br>
<a href="#ATTRIBUTES">ATTRIBUTES</a><br>
<a href="#CONFORMING TO">CONFORMING TO</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COLOPHON">COLOPHON</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">fmtmsg &minus;
print formatted error messages</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;fmtmsg.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
fmtmsg(long</b> <i>classification</i><b>, const char
*</b><i>label</i><b>, <br>
int</b> <i>severity</i><b>, const char *</b><i>text</i><b>,
<br>
const char *</b><i>action</i><b>, const char
*</b><i>tag</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
displays a message described by its arguments on the
device(s) specified in the <i>classification</i> argument.
For messages written to <i>stderr</i>, the format depends on
the <b>MSGVERB</b> environment variable.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>label</i> argument identifies the source of the message.
The string must consist of two colon separated parts where
the first part has not more than 10 and the second part not
more than 14 characters.</p>

<p style="margin-left:11%; margin-top: 1em">The <i>text</i>
argument describes the condition of the error.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>action</i> argument describes possible steps to recover
from the error. If it is printed, it is prefixed by &quot;TO
FIX: &quot;.</p>

<p style="margin-left:11%; margin-top: 1em">The <i>tag</i>
argument is a reference to the online documentation where
more information can be found. It should contain the
<i>label</i> value and a unique identification number.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Dummy
arguments</b> <br>
Each of the arguments can have a dummy value. The dummy
classification value <b>MM_NULLMC</b> (0L) does not specify
any output, so nothing is printed. The dummy severity value
<b>NO_SEV</b> (0) says that no severity is supplied. The
values <b>MM_NULLLBL</b>, <b>MM_NULLTXT</b>,
<b>MM_NULLACT</b>, <b>MM_NULLTAG</b> are synonyms for
<i>((char&nbsp;*)&nbsp;0)</i>, the empty string, and
<b>MM_NULLSEV</b> is a synonym for <b>NO_SEV</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>The
classification argument</b> <br>
The <i>classification</i> argument is the sum of values
describing 4 types of information.</p>

<p style="margin-left:11%; margin-top: 1em">The first value
defines the output channel.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_PRINT</b></p></td>
<td width="3%"></td>
<td width="45%">


<p>Output to <i>stderr</i>.</p></td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_CONSOLE</b></p></td>
<td width="3%"></td>
<td width="45%">


<p>Output to the system console.</p></td>
<td width="26%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>MM_PRINT |
MM_CONSOLE</b></p>

<p style="margin-left:29%;">Output to both.</p>

<p style="margin-left:11%; margin-top: 1em">The second
value is the source of the error:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p><b>MM_HARD</b></p></td>
<td width="7%"></td>
<td width="40%">


<p>A hardware error occurred.</p></td>
<td width="31%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p><b>MM_FIRM</b></p></td>
<td width="7%"></td>
<td width="40%">


<p>A firmware error occurred.</p></td>
<td width="31%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="11%">


<p><b>MM_SOFT</b></p></td>
<td width="7%"></td>
<td width="40%">


<p>A software error occurred.</p></td>
<td width="31%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The third value
encodes the detector of the problem:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em"><b>MM_APPL</b></p></td>
<td width="6%"></td>
<td width="60%">


<p style="margin-top: 1em">It is detected by an
application.</p> </td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><b>MM_UTIL</b></p></td>
<td width="6%"></td>
<td width="60%">


<p>It is detected by a utility.</p></td>
<td width="11%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><b>MM_OPSYS</b></p></td>
<td width="6%"></td>
<td width="60%">


<p>It is detected by the operating system.</p></td>
<td width="11%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The fourth
value shows the severity of the incident:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p style="margin-top: 1em"><b>MM_RECOVER</b></p></td>
<td width="3%"></td>
<td width="45%">


<p style="margin-top: 1em">It is a recoverable error.</p></td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_NRECOV</b></p></td>
<td width="3%"></td>
<td width="45%">


<p>It is a nonrecoverable error.</p></td>
<td width="26%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>The severity
argument</b> <br>
The <i>severity</i> argument can take one of the following
values:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p style="margin-top: 1em"><b>MM_NOSEV</b></p></td>
<td width="3%"></td>
<td width="51%">


<p style="margin-top: 1em">No severity is printed.</p></td>
<td width="20%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_HALT</b></p></td>
<td width="3%"></td>
<td width="51%">


<p>This value is printed as HALT.</p></td>
<td width="20%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_ERROR</b></p></td>
<td width="3%"></td>
<td width="51%">


<p>This value is printed as ERROR.</p></td>
<td width="20%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_WARNING</b></p></td>
<td width="3%"></td>
<td width="51%">


<p>This value is printed as WARNING.</p></td>
<td width="20%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="15%">


<p><b>MM_INFO</b></p></td>
<td width="3%"></td>
<td width="51%">


<p>This value is printed as INFO.</p></td>
<td width="20%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The numeric
values are between 0 and 4. Using <b>addseverity</b>(3) or
the environment variable <b>SEV_LEVEL</b> you can add more
levels and strings to print.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The function
can return 4 values:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em"><b>MM_OK</b></p></td>
<td width="6%"></td>
<td width="45%">


<p style="margin-top: 1em">Everything went smooth.</p></td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><b>MM_NOTOK</b></p></td>
<td width="6%"></td>
<td width="45%">


<p>Complete failure.</p></td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><b>MM_NOMSG</b></p></td>
<td width="6%"></td>
<td width="45%">


<p>Error writing to <i>stderr</i>.</p></td>
<td width="26%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><b>MM_NOCON</b></p></td>
<td width="6%"></td>
<td width="45%">


<p>Error writing to the console.</p></td>
<td width="26%">
</td></tr>
</table>

<h2>ENVIRONMENT
<a name="ENVIRONMENT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The environment
variable <b>MSGVERB</b> (&quot;message verbosity&quot;) can
be used to suppress parts of the output to <i>stderr</i>.
(It does not influence output to the console.) When this
variable is defined, is non-NULL, and is a colon-separated
list of valid keywords, then only the parts of the message
corresponding to these keywords is printed. Valid keywords
are &quot;label&quot;, &quot;severity&quot;,
&quot;text&quot;, &quot;action&quot; and
&quot;tag&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">The environment
variable <b>SEV_LEVEL</b> can be used to introduce new
severity levels. By default, only the five severity levels
described above are available. Any other numeric value would
make <b>fmtmsg</b>() print nothing. If the user puts
<b>SEV_LEVEL</b> with a format like</p>


<p style="margin-left:22%; margin-top: 1em">SEV_LEVEL=[description[:description[:...]]]</p>

<p style="margin-left:11%; margin-top: 1em">in the
environment of the process before the first call to
<b>fmtmsg</b>(), where each description is of the form</p>


<p style="margin-left:22%; margin-top: 1em">severity-keyword,level,printstring</p>

<p style="margin-left:11%; margin-top: 1em">then
<b>fmtmsg</b>() will also accept the indicated values for
the level (in addition to the standard levels 0-4), and use
the indicated printstring when such a level occurs.</p>

<p style="margin-left:11%; margin-top: 1em">The
severity-keyword part is not used by <b>fmtmsg</b>() but it
has to be present. The level part is a string representation
of a number. The numeric value must be a number greater than
4. This value must be used in the severity argument of
<b>fmtmsg</b>() to select this class. It is not possible to
overwrite any of the predefined classes. The printstring is
the string printed when a message of this class is processed
by <b>fmtmsg</b>().</p>

<h2>VERSIONS
<a name="VERSIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>fmtmsg</b>()
is provided in glibc since version 2.1.</p>

<h2>ATTRIBUTES
<a name="ATTRIBUTES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Multithreading
(see pthreads(7))</b> <br>
Before glibc 2.16, the <b>fmtmsg</b>() function uses a
static variable that is not protected, so it is not
thread-safe.</p>

<p style="margin-left:11%; margin-top: 1em">Since glibc
2.16, the <b>fmtmsg</b>() function uses a lock to protect
the static variable, so it is thread-safe.</p>

<h2>CONFORMING TO
<a name="CONFORMING TO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The functions
<b>fmtmsg</b>() and <b>addseverity</b>(3), and environment
variables <b>MSGVERB</b> and <b>SEV_LEVEL</b> come from
System V. The function <b>fmtmsg</b>() and the environment
variable <b>MSGVERB</b> are described in POSIX.1-2001.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">System V and
UnixWare man pages tell us that these functions have been
replaced by &quot;pfmt() and addsev()&quot; or by
&quot;pfmt(), vpfmt(), lfmt(), and vlfmt()&quot;, and will
be removed later.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">#include
&lt;stdio.h&gt; <br>
#include &lt;stdlib.h&gt; <br>
#include &lt;fmtmsg.h&gt;</p>

<p style="margin-left:11%; margin-top: 1em">int <br>
main(void) <br>
{ <br>
long class = MM_PRINT | MM_SOFT | MM_OPSYS | MM_RECOVER;
<br>
int err;</p>

<p style="margin-left:11%; margin-top: 1em">err =
fmtmsg(class, &quot;util&minus;linux:mount&quot;, MM_ERROR,
<br>
&quot;unknown mount option&quot;, &quot;See mount(8).&quot;,
<br>
&quot;util&minus;linux:mount:017&quot;); <br>
switch (err) { <br>
case MM_OK: <br>
break; <br>
case MM_NOTOK: <br>
printf(&quot;Nothing printed\n&quot;); <br>
break; <br>
case MM_NOMSG: <br>
printf(&quot;Nothing printed to stderr\n&quot;); <br>
break; <br>
case MM_NOCON: <br>
printf(&quot;No console output\n&quot;); <br>
break; <br>
default: <br>
printf(&quot;Unknown error from fmtmsg()\n&quot;); <br>
} <br>
exit(EXIT_SUCCESS); <br>
}</p>

<p style="margin-left:11%; margin-top: 1em">The output
should be:</p>


<p style="margin-left:11%; margin-top: 1em">util&minus;linux:mount:
ERROR: unknown mount option <br>
TO FIX: See mount(8). util&minus;linux:mount:017</p>

<p style="margin-left:11%; margin-top: 1em">and after</p>


<p style="margin-left:11%; margin-top: 1em">MSGVERB=text:action;
export MSGVERB</p>

<p style="margin-left:11%; margin-top: 1em">the output
becomes:</p>

<p style="margin-left:11%; margin-top: 1em">unknown mount
option <br>
TO FIX: See mount(8).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>addseverity</b>(3),
<b>perror</b>(3)</p>

<h2>COLOPHON
<a name="COLOPHON"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This page is
part of release 3.53 of the Linux <i>man-pages</i> project.
A description of the project, and information about
reporting bugs, can be found at
http://www.kernel.org/doc/man&minus;pages/.</p>
<hr>
</body>
</html>
