<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:09:22 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PTHREAD_SETCANCELSTATE</title>

</head>
<body>

<h1 align="center">PTHREAD_SETCANCELSTATE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#ERRORS">ERRORS</a><br>
<a href="#CONFORMING TO">CONFORMING TO</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COLOPHON">COLOPHON</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">pthread_setcancelstate,
pthread_setcanceltype &minus; set cancelability state and
type</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;pthread.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
pthread_setcancelstate(int</b> <i>state</i><b>, int
*</b><i>oldstate</i><b>); <br>
int pthread_setcanceltype(int</b> <i>type</i><b>, int
*</b><i>oldtype</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em">Compile and
link with <i>&minus;pthread</i>.</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>pthread_setcancelstate</b>() sets the cancelability state
of the calling thread to the value given in <i>state</i>.
The previous cancelability state of the thread is returned
in the buffer pointed to by <i>oldstate</i>. The
<i>state</i> argument must have one of the following values:
<b><br>
PTHREAD_CANCEL_ENABLE</b></p>

<p style="margin-left:22%;">The thread is cancelable. This
is the default cancelability state in all new threads,
including the initial thread. The thread&rsquo;s
cancelability type determines when a cancelable thread will
respond to a cancellation request.</p>


<p style="margin-left:11%;"><b>PTHREAD_CANCEL_DISABLE</b></p>

<p style="margin-left:22%;">The thread is not cancelable.
If a cancellation request is received, it is blocked until
cancelability is enabled.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>pthread_setcanceltype</b>() sets the cancelability type
of the calling thread to the value given in <i>type</i>. The
previous cancelability type of the thread is returned in the
buffer pointed to by <i>oldtype</i>. The <i>type</i>
argument must have one of the following values: <b><br>
PTHREAD_CANCEL_DEFERRED</b></p>

<p style="margin-left:22%;">A cancellation request is
deferred until the thread next calls a function that is a
cancellation point (see <b>pthreads</b>(7)). This is the
default cancelability type in all new threads, including the
initial thread.</p>


<p style="margin-left:11%;"><b>PTHREAD_CANCEL_ASYNCHRONOUS</b></p>

<p style="margin-left:22%;">The thread can be canceled at
any time. (Typically, it will be canceled immediately upon
receiving a cancellation request, but the system
doesn&rsquo;t guarantee this.)</p>

<p style="margin-left:11%; margin-top: 1em">The set-and-get
operation performed by each of these functions is atomic
with respect to other threads in the process calling the
same function.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">On success,
these functions return 0; on error, they return a nonzero
error number.</p>

<h2>ERRORS
<a name="ERRORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>pthread_setcancelstate</b>() can fail with the following
error:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>EINVAL</b></p></td>
<td width="2%"></td>
<td width="36%">


<p>Invalid value for <i>state</i>.</p></td>
<td width="42%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The
<b>pthread_setcanceltype</b>() can fail with the following
error:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>EINVAL</b></p></td>
<td width="2%"></td>
<td width="35%">


<p style="margin-top: 1em">Invalid value for
<i>type</i>.</p> </td>
<td width="43%">
</td></tr>
</table>

<h2>CONFORMING TO
<a name="CONFORMING TO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">POSIX.1-2001.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">For details of
what happens when a thread is canceled, see
<b>pthread_cancel</b>(3).</p>

<p style="margin-left:11%; margin-top: 1em">Briefly
disabling cancelability is useful if a thread performs some
critical action that must not be interrupted by a
cancellation request. Beware of disabling cancelability for
long periods, or around operations that may block for long
periods, since that will render the thread unresponsive to
cancellation requests.</p>

<p style="margin-left:11%; margin-top: 1em">Setting the
cancelability type to <b>PTHREAD_CANCEL_ASYNCHRONOUS</b> is
rarely useful. Since the thread could be canceled at
<i>any</i> time, it cannot safely reserve resources (e.g.,
allocating memory with <b>malloc</b>(3)), acquire mutexes,
semaphores, or locks, and so on. Reserving resources is
unsafe because the application has no way of knowing what
the state of these resources is when the thread is canceled;
that is, did cancellation occur before the resources were
reserved, while they were reserved, or after they were
released? Furthermore, some internal data structures (e.g.,
the linked list of free blocks managed by the
<b>malloc</b>(3) family of functions) may be left in an
inconsistent state if cancellation occurs in the middle of
the function call. Consequently, clean-up handlers cease to
be useful. Functions that can be safely asynchronously
canceled are called <i>async-cancel-safe functions</i>.
POSIX.1-2001 requires only that <b>pthread_cancel</b>(3),
<b>pthread_setcancelstate</b>(), and
<b>pthread_setcanceltype</b>() be async-cancel-safe. In
general, other library functions can&rsquo;t be safely
called from an asynchronously cancelable thread. One of the
few circumstances in which asynchronous cancelability is
useful is for cancellation of a thread that is in a pure
compute-bound loop.</p>

<p style="margin-left:11%; margin-top: 1em">The Linux
threading implementations permit the <i>oldstate</i>
argument of <b>pthread_setcancelstate</b>() to be NULL, in
which case the information about the previous cancelability
state is not returned to the caller. Many other
implementations also permit a NULL <i>oldstat</i> argument,
but POSIX.1-2001 does not specify this point, so portable
applications should always specify a non-NULL value in
<i>oldstate</i>. A precisely analogous set of statements
applies for the <i>oldtype</i> argument of
<b>pthread_setcanceltype</b>().</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">See
<b>pthread_cancel</b>(3).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>pthread_cancel</b>(3),
<b>pthread_cleanup_push</b>(3),
<b>pthread_testcancel</b>(3), <b>pthreads</b>(7)</p>

<h2>COLOPHON
<a name="COLOPHON"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This page is
part of release 3.53 of the Linux <i>man-pages</i> project.
A description of the project, and information about
reporting bugs, can be found at
http://www.kernel.org/doc/man&minus;pages/.</p>
<hr>
</body>
</html>
