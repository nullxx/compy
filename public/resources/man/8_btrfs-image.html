<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:24:33 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>BTRFS&minus;IMAGE</title>

</head>
<body>

<h1 align="center">BTRFS&minus;IMAGE</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">btrfs-image
&minus; create/restore an image of the filesystem</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>btrfs&minus;image</b>
[options] <i>&lt;source&gt; &lt;target&gt;</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i><b>btrfs&minus;image</b></i>
is used to create an image of a btrfs filesystem. All data
will be zeroed, but metadata and the like is preserved.
Mainly used for debugging purposes.</p>

<p style="margin-left:11%; margin-top: 1em">In the dump
mode, source is the btrfs device/file and target is the
output file (use <i>&minus;</i> for stdout).</p>

<p style="margin-left:11%; margin-top: 1em">In the restore
mode (option &minus;r), source is the dumped image and
target is the btrfs device/file.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">&minus;r</p>

<p style="margin-left:17%;">Restore metadump image. By
default, this fixes super&rsquo;s chunk tree, by using 1
stripe pointing to primary device, so that file system can
be restored by running tree log reply if possible. To
restore without changing number of stripes in chunk tree
check &minus;o option.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;c
<i>&lt;value&gt;</i></p>

<p style="margin-left:17%;">Compression level (0 ~ 9).</p>

<p style="margin-left:11%; margin-top: 1em">&minus;t
<i>&lt;value&gt;</i></p>

<p style="margin-left:17%;">Number of threads (1 ~ 32) to
be used to process the image dump or restore.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;o</p>

<p style="margin-left:17%;">Use the old restore method,
this does not fixup the chunk tree so the restored file
system will not be able to be mounted.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;s</p>

<p style="margin-left:17%;">Sanitize the file names when
generating the image. One &minus;s means just generate
random garbage, which means that the directory indexes
won&rsquo;t match up since the hashes won&rsquo;t match with
the garbage filenames. Using &minus;ss will calculate a
collision for the filename so that the hashes match, and if
it can&rsquo;t calculate a collision then it will just
generate garbage. The collision calculator is very time and
CPU intensive so only use it if you are having problems with
your file system tree and need to have it mostly
working.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;w</p>

<p style="margin-left:17%;">Walk all the trees manually and
copy any blocks that are referenced. Use this option if your
extent tree is corrupted to make sure that all of the
metadata is captured.</p>

<p style="margin-left:11%; margin-top: 1em">&minus;m</p>

<p style="margin-left:17%;">Restore for multiple devices,
more than 1 device should be provided.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>btrfs&minus;image</b>
will return 0 if no error happened. If any problems
happened, 1 will be returned.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>mkfs.btrfs</b>(8)</p>
<hr>
</body>
</html>
