<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:08:49 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>matchpathcon_checkmatches</title>

</head>
<body>

<h1 align="center">matchpathcon_checkmatches</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">matchpathcon_checkmatches,
matchpathcon_filespec_add, matchpathcon_filespec_destroy,
matchpathcon_filespec_eval &minus; check and report whether
any specification index has no matches with any inode.
Maintenance and statistics on inode associations</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;selinux/selinux.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
matchpathcon_checkmatches(char *</b><i>str</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
matchpathcon_filespec_add(ino_t</b> <i>ino</i><b>, int</b>
<i>specind</i><b>, const char *</b><i>file</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
matchpathcon_filespec_destroy(void);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>void
matchpathcon_filespec_eval(void);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>matchpathcon_checkmatches</b>()
checks whether any specification has no matches and reports
them. The <i>str</i> argument is used as a prefix for any
warning messages.</p>


<p style="margin-left:11%; margin-top: 1em"><b>matchpathcon_filespec_add</b>()
maintains an association between an inode <i>ino</i> and a
specification index <i>specind</i>, and checks whether a
conflicting specification is already associated with the
same inode (e.g. due to multiple hard links). If so, then it
uses the latter of the two specifications based on their
order in the <i>file</i> context configuration. Returns the
specification index used or &minus;1 on error.</p>


<p style="margin-left:11%; margin-top: 1em"><b>matchpathcon_filespec_destroy</b>()
destroys any inode associations that have been added, e.g.
to restart for a new filesystem.</p>


<p style="margin-left:11%; margin-top: 1em"><b>matchpathcon_filespec_eval</b>()
displays statistics on the hash table usage for the inode
associations.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Returns zero on
success or &minus;1 otherwise.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>selinux</b>(8),
<b>matchpathcon</b>(3), <b>matchpathcon_index</b>(3),
<b>freecon</b>(3), <b>setfilecon</b>(3),
<b>setfscreatecon</b>(3)</p>
<hr>
</body>
</html>
