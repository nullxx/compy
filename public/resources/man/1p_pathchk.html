<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:01:01 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PATHCHK</title>

</head>
<body>

<h1 align="center">PATHCHK</h1>

<a href="#PROLOG">PROLOG</a><br>
<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#OPERANDS">OPERANDS</a><br>
<a href="#STDIN">STDIN</a><br>
<a href="#INPUT FILES">INPUT FILES</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#ASYNCHRONOUS EVENTS">ASYNCHRONOUS EVENTS</a><br>
<a href="#STDOUT">STDOUT</a><br>
<a href="#STDERR">STDERR</a><br>
<a href="#OUTPUT FILES">OUTPUT FILES</a><br>
<a href="#EXTENDED DESCRIPTION">EXTENDED DESCRIPTION</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#CONSEQUENCES OF ERRORS">CONSEQUENCES OF ERRORS</a><br>
<a href="#APPLICATION USAGE">APPLICATION USAGE</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#RATIONALE">RATIONALE</a><br>
<a href="#FUTURE DIRECTIONS">FUTURE DIRECTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>PROLOG
<a name="PROLOG"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page is part of the POSIX Programmer&rsquo;s Manual. The
Linux implementation of this interface may differ (consult
the corresponding Linux manual page for details of Linux
behavior), or the interface may not be implemented on
Linux.</p>

<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">pathchk &minus;
check pathnames</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>pathchk
[-p]</b> <i>pathname</i><b>...</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<i>pathchk</i> utility shall check that one or more
pathnames are valid (that is, they could be used to access
or create a file without causing syntax errors) and portable
(that is, no filename truncation results). More extensive
portability checks are provided by the <b>-p</b> option.</p>

<p style="margin-left:11%; margin-top: 1em">By default, the
<i>pathchk</i> utility shall check each component of each
<i>pathname</i> operand based on the underlying file system.
A diagnostic shall be written for each <i>pathname</i>
operand that:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Is longer than {PATH_MAX} bytes (see <b>Pathname
Variable Values</b> in the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, Chapter 13, Headers,
<i>&lt;limits.h&gt;</i>)</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Contains any component longer than {NAME_MAX} bytes in
its containing directory</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Contains any component in a directory that is not
searchable</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Contains any character in any component that is not
valid in its containing directory</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The format of
the diagnostic message is not specified, but shall indicate
the error detected and the corresponding <i>pathname</i>
operand.</p>

<p style="margin-left:11%; margin-top: 1em">It shall not be
considered an error if one or more components of a
<i>pathname</i> operand do not exist as long as a file
matching the pathname specified by the missing components
could be created that does not violate any of the checks
specified above.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<i>pathchk</i> utility shall conform to the Base Definitions
volume of IEEE&nbsp;Std&nbsp;1003.1-2001, Section 12.2,
Utility Syntax Guidelines.</p>

<p style="margin-left:11%; margin-top: 1em">The following
option shall be supported:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>-p</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Instead of performing checks
based on the underlying file system, write a diagnostic for
each <i>pathname</i> operand that:</p></td></tr>
</table>

<p style="margin-left:22%;">*</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="23%"></td>
<td width="2%"></td>
<td width="1%"></td>
<td width="74%">


<p style="margin-top: 1em">Is longer than {_POSIX_PATH_MAX}
bytes (see <b>Minimum Values</b> in the Base Definitions
volume of IEEE&nbsp;Std&nbsp;1003.1-2001, Chapter 13,
Headers, <i>&lt;limits.h&gt;</i>)</p></td></tr>
<tr valign="top" align="left">
<td width="23%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="74%">


<p>Contains any component longer than {_POSIX_NAME_MAX}
bytes</p> </td></tr>
<tr valign="top" align="left">
<td width="23%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="74%">


<p>Contains any character in any component that is not in
the portable filename character set</p></td></tr>
</table>

<h2>OPERANDS
<a name="OPERANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
operand shall be supported: <i><br>
pathname</i></p>

<p style="margin-left:22%;">A pathname to be checked.</p>

<h2>STDIN
<a name="STDIN"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Not used.</p>

<h2>INPUT FILES
<a name="INPUT FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
environment variables shall affect the execution of
<i>pathchk</i>:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>LANG</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Provide a default value for the internationalization
variables that are unset or null. (See the Base Definitions
volume of IEEE&nbsp;Std&nbsp;1003.1-2001, Section 8.2,
Internationalization Variables for the precedence of
internationalization variables used to determine the values
of locale categories.)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>LC_ALL</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>If set to a non-empty string value, override the values
of all the other internationalization variables.</p></td></tr>
</table>

<p style="margin-left:11%;"><i>LC_CTYPE</i></p>

<p style="margin-left:22%;">Determine the locale for the
interpretation of sequences of bytes of text data as
characters (for example, single-byte as opposed to
multi-byte characters in arguments).</p>

<p style="margin-left:11%;"><i>LC_MESSAGES</i></p>

<p style="margin-left:22%;">Determine the locale that
should be used to affect the format and contents of
diagnostic messages written to standard error.</p>

<p style="margin-left:11%;"><i>NLSPATH</i></p>

<p style="margin-left:22%;">Determine the location of
message catalogs for the processing of <i>LC_MESSAGES
.</i></p>

<h2>ASYNCHRONOUS EVENTS
<a name="ASYNCHRONOUS EVENTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Default.</p>

<h2>STDOUT
<a name="STDOUT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Not used.</p>

<h2>STDERR
<a name="STDERR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The standard
error shall be used only for diagnostic messages.</p>

<h2>OUTPUT FILES
<a name="OUTPUT FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>EXTENDED DESCRIPTION
<a name="EXTENDED DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
exit values shall be returned:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&nbsp; 0</p></td>
<td width="8%"></td>
<td width="72%">


<p>All <i>pathname</i> operands passed all of the
checks.</p> </td>
<td width="6%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&gt;0</p></td>
<td width="8%"></td>
<td width="72%">


<p>An error occurred.</p></td>
<td width="6%">
</td></tr>
</table>

<h2>CONSEQUENCES OF ERRORS
<a name="CONSEQUENCES OF ERRORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Default.</p>

<p style="margin-left:11%; margin-top: 1em"><i>The
following sections are informative.</i></p>

<h2>APPLICATION USAGE
<a name="APPLICATION USAGE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <i>test</i>
utility can be used to determine whether a given pathname
names an existing file; it does not, however, give any
indication of whether or not any component of the pathname
was truncated in a directory where the _POSIX_NO_TRUNC
feature is not in effect. The <i>pathchk</i> utility does
not check for file existence; it performs checks to
determine whether a pathname does exist or could be created
with no pathname component truncation.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>noclobber</i> option in the shell (see the <i>set</i>
special built-in) can be used to atomically create a file.
As with all file creation semantics in the System Interfaces
volume of IEEE&nbsp;Std&nbsp;1003.1-2001, it guarantees
atomic creation, but still depends on applications to agree
on conventions and cooperate on the use of files after they
have been created.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">To verify that
all pathnames in an imported data interchange archive are
legitimate and unambiguous on the current system:</p>

<p style="margin-left:22%; margin-top: 1em"><b>pax -f
archive | sed -e &rsquo;/ == .*/s///&rsquo; | xargs pathchk
<br>
if [ $? -eq 0 ] <br>
then <br>
pax -r -f archive <br>
else <br>
echo Investigate problems before importing files. <br>
exit 1 <br>
fi</b></p>

<p style="margin-left:11%; margin-top: 1em">To verify that
all files in the current directory hierarchy could be moved
to any system conforming to the System Interfaces volume of
IEEE&nbsp;Std&nbsp;1003.1-2001 that also supports the
<i>pax</i> utility:</p>

<p style="margin-left:22%; margin-top: 1em"><b>find .
-print | xargs pathchk -p <br>
if [ $? -eq 0 ] <br>
then <br>
pax -w -f archive . <br>
else <br>
echo Portable archive cannot be created. <br>
exit 1 <br>
fi</b></p>

<p style="margin-left:11%; margin-top: 1em">To verify that
a user-supplied pathname names a readable file and that the
application can create a file extending the given path
without truncation and without overwriting any existing
file:</p>

<p style="margin-left:22%; margin-top: 1em"><b>case $- in
<br>
*C*) reset=&quot;&quot;;; <br>
*) reset=&quot;set +C&quot; <br>
set -C;; <br>
esac <br>
test -r &quot;$path&quot; &amp;&amp; pathchk
&quot;$path.out&quot; &amp;&amp; <br>
rm &quot;$path.out&quot; &gt; &quot;$path.out&quot; <br>
if [ $? -ne 0 ]; then <br>
printf &quot;%s: %s not found or %s.out fails \ <br>
creation checks.\n&quot; $0 &quot;$path&quot;
&quot;$path&quot; <br>
$reset # Reset the noclobber option in case a trap <br>
# on EXIT depends on it. <br>
exit 1 <br>
fi <br>
$reset <br>
PROCESSING &lt; &quot;$path&quot; &gt;
&quot;$path.out&quot;</b></p>

<p style="margin-left:11%; margin-top: 1em">The following
assumptions are made in this example:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p style="margin-top: 1em">1.</p></td>
<td width="2%"></td>
<td width="83%">


<p style="margin-top: 1em"><b>PROCESSING</b> represents the
code that is used by the application to use <b>$path</b>
once it is verified that <b>$path.out</b> works as
intended.</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>2.</p></td>
<td width="2%"></td>
<td width="83%">


<p>The state of the <i>noclobber</i> option is unknown when
this code is invoked and should be set on exit to the state
it was in when this code was invoked. (The <b>reset</b>
variable is used in this example to restore the initial
state.)</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>3.</p></td>
<td width="2%"></td>
<td width="83%">


<p>Note the usage of:</p></td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em"><b>rm
&quot;$path.out&quot; &gt; &quot;$path.out&quot;</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="18%"></td>
<td width="4%">


<p style="margin-top: 1em">a.</p></td>
<td width="1%"></td>
<td width="77%">


<p style="margin-top: 1em">The <i>pathchk</i> command has
already verified, at this point, that <b>$path.out</b> is
not truncated.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="4%">


<p>b.</p></td>
<td width="1%"></td>
<td width="77%">


<p>With the <i>noclobber</i> option set, the shell verifies
that <b>$path.out</b> does not already exist before invoking
<i>rm</i>.</p> </td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="4%">


<p>c.</p></td>
<td width="1%"></td>
<td width="77%">


<p>If the shell succeeded in creating <b>$path.out</b>,
<i>rm</i> removes it so that the application can create the
file again in the <b>PROCESSING</b> step.</p></td></tr>
<tr valign="top" align="left">
<td width="18%"></td>
<td width="4%">


<p>d.</p></td>
<td width="1%"></td>
<td width="77%">


<p>If the <b>PROCESSING</b> step wants the file to exist
already when it is invoked, the:</p></td></tr>
</table>

<p style="margin-left:23%; margin-top: 1em"><b>rm
&quot;$path.out&quot; &gt; &quot;$path.out&quot;</b></p>

<p style="margin-left:17%; margin-top: 1em">should be
replaced with:</p>

<p style="margin-left:28%; margin-top: 1em"><b>&gt;
&quot;$path.out&quot;</b></p>

<p style="margin-left:17%; margin-top: 1em">which verifies
that the file did not already exist, but leaves
<b>$path.out</b> in place for use by <b>PROCESSING</b>.</p>

<h2>RATIONALE
<a name="RATIONALE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<i>pathchk</i> utility was new for the ISO&nbsp;POSIX-2:1993
standard. It, along with the <i>set</i> <b>-C</b>(
<i>noclobber</i>) option added to the shell, replaces the
<i>mktemp</i>, <i>validfnam</i>, and <i>create</i> utilities
that appeared in early proposals. All of these utilities
were attempts to solve several common problems:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">Verify the validity (for several
different definitions of &quot;valid&quot;) of a pathname
supplied by a user, generated by an application, or imported
from an external source.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Atomically create a file.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>Perform various string handling functions to generate a
temporary filename.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The
<i>create</i> utility, included in an early proposal,
provided checking and atomic creation in a single invocation
of the utility; these are orthogonal issues and need not be
grouped into a single utility. Note that the
<i>noclobber</i> option also provides a way of creating a
lock for process synchronization; since it provides an
atomic <i>create</i>, there is no race between a test for
existence and the following creation if it did not
exist.</p>

<p style="margin-left:11%; margin-top: 1em">Having a
function like <i>tmpnam</i>() in the ISO&nbsp;C standard is
important in many high-level languages. The shell
programming language, however, has built-in string
manipulation facilities, making it very easy to construct
temporary filenames. The names needed obviously depend on
the application, but are frequently of a form similar
to:</p>


<p style="margin-left:22%; margin-top: 1em"><b>$TMPDIR/</b><i>application_abbreviation</i><b>$$.</b><i>suffix</i></p>

<p style="margin-left:11%; margin-top: 1em">In cases where
there is likely to be contention for a given suffix, a
simple shell <b>for</b> or <b>while</b> loop can be used
with the shell <i>noclobber</i> option to create a file
without risk of collisions, as long as applications trying
to use the same filename name space are cooperating on the
use of files after they have been created.</p>

<h2>FUTURE DIRECTIONS
<a name="FUTURE DIRECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>Redirection</i>,
<i>set</i>, <i>test</i></p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Portions of
this text are reprinted and reproduced in electronic form
from IEEE Std 1003.1, 2003 Edition, Standard for Information
Technology -- Portable Operating System Interface (POSIX),
The Open Group Base Specifications Issue 6, Copyright (C)
2001-2003 by the Institute of Electrical and Electronics
Engineers, Inc and The Open Group. In the event of any
discrepancy between this version and the original IEEE and
The Open Group Standard, the original IEEE and The Open
Group Standard is the referee document. The original
Standard can be obtained online at
http://www.opengroup.org/unix/online.html .</p>
<hr>
</body>
</html>
