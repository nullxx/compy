<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:23:21 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>selabel_x</title>

</head>
<body>

<h1 align="center">selabel_x</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#FILES">FILES</a><br>
<a href="#Object Name String Values">Object Name String Values</a><br>
<a href="#FILE FORMAT">FILE FORMAT</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">selabel_x
&minus; userspace SELinux labeling interface and
configuration file format for the X Window System contexts
backend. This backend is also used to determine the default
context for labeling remotely connected X clients</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;selinux/label.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
selabel_lookup(struct selabel_handle
*</b><i>hnd</i><b>,</b></p>

<p style="margin-left:40%;"><b>security_context_t
*</b><i>context</i><b>, <br>
const char *</b><i>object_name</i><b>, int</b>
<i>object_type</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
selabel_lookup_raw(struct selabel_handle
*</b><i>hnd</i><b>,</b></p>

<p style="margin-left:40%;"><b>security_context_t
*</b><i>context</i><b>, <br>
const char *</b><i>object_name</i><b>, int</b>
<i>object_type</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The X contexts
backend maps from X Window System object names into security
contexts. It is used to find the appropriate context for X
Window System objects whose significance and/or usage
semantics are determined primarily by name. The returned
<i>context</i> must be freed using <b>freecon</b>(3).
<b><br>
selabel_lookup</b>(3) describes the function with its return
and error codes.</p>

<p style="margin-left:11%; margin-top: 1em">This backend is
also used to determine the default context for labeling
remotely connected X clients.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>object_type</i> argument should be set to one of the
following values:</p>

<p style="margin-left:22%;"><b>SELABEL_X_PROP</b></p>

<p style="margin-left:32%;">The <i>object_name</i> argument
specifies the name of a window property, such as
&quot;WM_NAME&quot;.</p>

<p style="margin-left:22%;"><b>SELABEL_X_SELN</b></p>

<p style="margin-left:32%;">The <i>object_name</i> argument
specifies the name of a selection, such as
&quot;PRIMARY&quot;.</p>

<p style="margin-left:22%;"><b>SELABEL_X_EXT</b></p>

<p style="margin-left:32%;">The <i>object_name</i> argument
specifies the name of a protocol extension, such as
&quot;RENDER&quot;.</p>

<p style="margin-left:22%;"><b>SELABEL_X_EVENT</b></p>

<p style="margin-left:32%;">The <i>object_name</i> argument
specifies the name of an event type, such as
&quot;X11:ButtonPress&quot;.</p>

<p style="margin-left:22%;"><b>SELABEL_X_CLIENT</b></p>

<p style="margin-left:32%;">The <i>object_name</i> argument
is ignored, however it should be set to either <i>*</i> (an
asterisk or &rsquo;wildcard&rsquo; that will select the
default entry) or a specific entry such as
&quot;remote&quot; in the X contexts file as shown in the
<b>EXAMPLE</b> section. The default context for labeling
remote X clients is then returned.</p>

<p style="margin-left:22%;"><b>SELABEL_X_POLYPROP</b></p>

<p style="margin-left:32%;">Like <b>SELABEL_X_PROP</b>, but
checks if the property was marked as being polyinstantiated.
See <b>NOTES</b> below.</p>

<p style="margin-left:22%;"><b>SELABEL_X_POLYSELN</b></p>

<p style="margin-left:32%;">Like <b>SELABEL_X_SELN</b>, but
checks if the selection was marked as being
polyinstantiated. See <b>NOTES</b> below.</p>

<p style="margin-left:11%; margin-top: 1em">Any messages
generated by <b>selabel_lookup</b>(3) are sent to
<i>stderr</i> by default, although this can be changed by
<b>selinux_set_callback</b>(3).</p>


<p style="margin-left:11%; margin-top: 1em"><b>selabel_lookup_raw</b>
behaves identically to <b>selabel_lookup</b> but does not
perform context translation.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>FILES</b> section details the configuration files used to
determine the X object context.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">In addition to
the global options described in <b>selabel_open</b>(3), this
backend recognizes the following options:</p>

<p style="margin-left:22%;"><b>SELABEL_OPT_PATH</b></p>

<p style="margin-left:32%;">A non-null value for this
option specifies a path to a file that will be opened in
lieu of the standard X contexts file (see the <b>FILES</b>
section for details).</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The X context
file used to retrieve a default context depends on the
<b>SELABEL_OPT_PATH</b> parameter passed to
<b>selabel_open</b>(3). If <i>NULL</i>, then the
<b>SELABEL_OPT_PATH</b> value will default to the active
policy X contexts location (as returned by
<b>selinux_x_context_path</b>(3)), otherwise the actual
<b>SELABEL_OPT_PATH</b> value specified is used.</p>

<p style="margin-left:11%; margin-top: 1em">The default X
object contexts file is:</p>


<p style="margin-left:22%;"><i>/etc/selinux/{SELINUXTYPE}/contexts/x_contexts</i></p>

<p style="margin-left:11%; margin-top: 1em">Where
<i>{SELINUXTYPE}</i> is the entry from the selinux
configuration file <i>config</i> (see
<b>selinux_config</b>(5)).</p>

<p style="margin-left:11%; margin-top: 1em">The entries
within the X contexts file are shown in the <b>Object Name
String Values</b> and <b>FILE FORMAT</b> sections.</p>

<h2>Object Name String Values
<a name="Object Name String Values"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The string name
assigned to each <i>object_type</i> argument that can be
present in the X contexts file are:</p>

<h2>FILE FORMAT
<a name="FILE FORMAT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Each line
within the X contexts file is as follows:</p>

<p style="margin-left:22%;"><i>object_type object_name
context</i></p>

<p style="margin-left:11%; margin-top: 1em">Where:</p>

<p style="margin-left:22%;"><i>object_type</i></p>

<p style="margin-left:32%;">This is the string
representation of the object type shown in the <b>Object
Name String Values</b> section. There can be multiple lines
with the same <i>object_type</i> string that will form a
block of entries (each with a different <i>object_name</i>
entry).</p>

<p style="margin-left:22%;"><i>object_name</i></p>

<p style="margin-left:32%;">These are the object names of
the specific X-server resource such as <b>PRIMARY</b>,
<b>CUT_BUFFER0</b> etc. They are generally defined in the
X-server source code (<i>protocol.txt</i> and
<i>BuiltInAtoms</i> in the dix directory of the
xorg&minus;server source package). The entry can contain
&rsquo;*&rsquo; for wildcard matching or &rsquo;?&rsquo; for
substitution. Note that if the &rsquo;*&rsquo; is used, then
be aware that the order of entries in the file is important.
The &rsquo;*&rsquo; on its own is used to ensure a default
fallback context is assigned and should be the last entry in
the <i>object_type</i> block.</p>

<p style="margin-left:22%;"><i>context</i></p>

<p style="margin-left:32%;">The security context that will
be applied to the object.</p>

<p style="margin-left:11%; margin-top: 1em">Example 1:</p>

<p style="margin-left:11%; margin-top: 1em"># object_type
object_name context <br>
selection PRIMARY
system_u:object_r:clipboard_xselection_t:s0 <br>
selection * system_u:object_r:xselection_t:s0</p>

<p style="margin-left:11%; margin-top: 1em">Example 2 -
This example shows how a client entry can be configured to
ensure an entry is always found:</p>

<p style="margin-left:11%; margin-top: 1em"># object_type
object_name context <br>
client * system_u:object_r:remote_t:s0</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em">1.</p></td>
<td width="3%"></td>
<td width="83%">


<p style="margin-top: 1em">Properties and selections are
marked as either polyinstantiated or not. For these name
types, the &quot;POLY&quot; option searches only the names
marked as being polyinstantiated, while the other option
searches only the names marked as not being
polyinstantiated. Users of the interface should check both
mappings, optionally taking action based on the result (e.g.
polyinstantiating the object).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>2.</p></td>
<td width="3%"></td>
<td width="83%">


<p>If contexts are to be validated, then the global option
<b>SELABEL_OPT_VALIDATE</b> must be set before calling
<b>selabel_open</b>(3). If this is not set, then it is
possible for an invalid context to be returned.</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>selinux</b>(8),
<b>selabel_open</b>(3), <b>selabel_lookup</b>(3),
<b>selabel_stats</b>(3), <b>selabel_close</b>(3),
<b>selinux_set_callback</b>(3),
<b>selinux_x_context_path</b>(3), <b>freecon</b>(3),
<b>selinux_config</b>(5)</p>
<hr>
</body>
</html>
