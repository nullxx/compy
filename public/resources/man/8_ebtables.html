<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:24:42 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>EBTABLES</title>

</head>
<body>

<h1 align="center">EBTABLES</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#EBTABLES COMMAND LINE ARGUMENTS">EBTABLES COMMAND LINE ARGUMENTS</a><br>
<a href="#FILES">FILES</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#MAILINGLISTS">MAILINGLISTS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ebtables
(v2.0.10-4) &minus; Ethernet bridge frame table
administration</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ebtables</b>
[<b>-t</b> table ] <b>-</b>[<b>ACDI</b>] chain rule
specification [match extensions] [watcher extensions] target
<b><br>
ebtables</b> [<b>-t</b> table ] <b>-P</b> chain
<b>ACCEPT</b> | <b>DROP</b> | <b>RETURN <br>
ebtables</b> [<b>-t</b> table ] <b>-F</b> [chain] <b><br>
ebtables</b> [<b>-t</b> table ] <b>-Z</b> [chain] <b><br>
ebtables</b> [<b>-t</b> table ] <b>-L</b> [<b>-Z</b>]
[chain] [ [<b>--Ln</b>] | [<b>--Lx</b>] ] [<b>--Lc</b>]
[<b>--Lmac2</b>] <b><br>
ebtables</b> [<b>-t</b> table ] <b>-N</b> chain [<b>-P
ACCEPT</b> | <b>DROP</b> | <b>RETURN</b>] <b><br>
ebtables</b> [<b>-t</b> table ] <b>-X</b> [chain] <b><br>
ebtables</b> [<b>-t</b> table ] <b>-E</b> old-chain-name
new-chain-name <b><br>
ebtables</b> [<b>-t</b> table ] <b>--init-table <br>
ebtables</b> [<b>-t</b> table ] [<b>--atomic-file</b> file]
<b>--atomic-commit <br>
ebtables</b> [<b>-t</b> table ] [<b>--atomic-file</b> file]
<b>--atomic-init <br>
ebtables</b> [<b>-t</b> table ] [<b>--atomic-file</b> file]
<b>--atomic-save</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>ebtables</b>
is an application program used to set up and maintain the
tables of rules (inside the Linux kernel) that inspect
Ethernet frames. It is analogous to the <b>iptables</b>
application, but less complicated, due to the fact that the
Ethernet protocol is much simpler than the IP protocol.</p>

<p style="margin-left:11%; margin-top: 1em"><b>CHAINS</b>
<br>
There are three ebtables tables with built-in chains in the
Linux kernel. These tables are used to divide functionality
into different sets of rules. Each set of rules is called a
chain. Each chain is an ordered list of rules that can match
Ethernet frames. If a rule matches an Ethernet frame, then a
processing specification tells what to do with that matching
frame. The processing specification is called a
&rsquo;target&rsquo;. However, if the frame does not match
the current rule in the chain, then the next rule in the
chain is examined and so forth. The user can create new
(user-defined) chains that can be used as the
&rsquo;target&rsquo; of a rule. User-defined chains are very
useful to get better performance over the linear traversal
of the rules and are also essential for structuring the
filtering rules into well-organized and maintainable sets of
rules.</p>

<p style="margin-left:11%; margin-top: 1em"><b>TARGETS</b>
<br>
A firewall rule specifies criteria for an Ethernet frame and
a frame processing specification called a target. When a
frame matches a rule, then the next action performed by the
kernel is specified by the target. The target can be one of
these values: <b>ACCEPT</b>, <b>DROP</b>, <b>CONTINUE</b>,
<b>RETURN</b>, an &rsquo;extension&rsquo; (see below) or a
jump to a user-defined chain.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ACCEPT</b>
means to let the frame through. <b>DROP</b> means the frame
has to be dropped. In the <b>BROUTING</b> chain however, the
<b>ACCEPT</b> and <b>DROP</b> target have different meanings
(see the info provided for the <b>-t</b> option).
<b>CONTINUE</b> means the next rule has to be checked. This
can be handy, f.e., to know how many frames pass a certain
point in the chain, to log those frames or to apply multiple
targets on a frame. <b>RETURN</b> means stop traversing this
chain and resume at the next rule in the previous (calling)
chain. For the extension targets please refer to the
<b>TARGET EXTENSIONS</b> section of this man page.</p>

<p style="margin-left:11%; margin-top: 1em"><b>TABLES</b>
<br>
As stated earlier, there are three ebtables tables in the
Linux kernel. The table names are <b>filter</b>, <b>nat</b>
and <b>broute</b>. Of these three tables, the filter table
is the default table that the command operates on. If you
are working with the filter table, then you can drop the
&rsquo;-t filter&rsquo; argument to the ebtables command.
However, you will need to provide the -t argument for the
other two tables. Moreover, the -t argument must be the
first argument on the ebtables command line, if used.
<b><br>
-t, --table</b></p>

<p style="margin-left:22%;"><b>filter</b> is the default
table and contains three built-in chains: <b>INPUT</b> (for
frames destined for the bridge itself, on the level of the
MAC destination address), <b>OUTPUT</b> (for
locally-generated or (b)routed frames) and <b>FORWARD</b>
(for frames being forwarded by the bridge). <b><br>
nat</b> is mostly used to change the mac addresses and
contains three built-in chains: <b>PREROUTING</b> (for
altering frames as soon as they come in), <b>OUTPUT</b> (for
altering locally generated or (b)routed frames before they
are bridged) and <b>POSTROUTING</b> (for altering frames as
they are about to go out). A small note on the naming of
chains PREROUTING and POSTROUTING: it would be more accurate
to call them PREFORWARDING and POSTFORWARDING, but for all
those who come from the iptables world to ebtables it is
easier to have the same names. Note that you can change the
name (<b>-E</b>) if you don&rsquo;t like the default.
<b><br>
broute</b> is used to make a brouter, it has one built-in
chain: <b>BROUTING</b>. The targets <b>DROP</b> and
<b>ACCEPT</b> have a special meaning in the broute table
(these names are used instead of more descriptive names to
keep the implementation generic). <b>DROP</b> actually means
the frame has to be routed, while <b>ACCEPT</b> means the
frame has to be bridged. The <b>BROUTING</b> chain is
traversed very early. However, it is only traversed by
frames entering on a bridge port that is in forwarding
state. Normally those frames would be bridged, but you can
decide otherwise here. The <b>redirect</b> target is very
handy here.</p>

<h2>EBTABLES COMMAND LINE ARGUMENTS
<a name="EBTABLES COMMAND LINE ARGUMENTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">After the
initial ebtables &rsquo;-t table&rsquo; command line
argument, the remaining arguments can be divided into
several groups. These groups are commands, miscellaneous
commands, rule specifications, match extensions, watcher
extensions and target extensions.</p>


<p style="margin-left:11%; margin-top: 1em"><b>COMMANDS</b>
<br>
The ebtables command arguments specify the actions to
perform on the table defined with the -t argument. If you do
not use the -t argument to name a table, the commands apply
to the default filter table. Only one command may be used on
the command line at a time, except when the commands
<b>-L</b> and <b>-Z</b> are combined, the commands <b>-N</b>
and <b>-P</b> are combined, or when <b>--atomic-file</b> is
used. <b><br>
-A, --append</b></p>

<p style="margin-left:22%;">Append a rule to the end of the
selected chain.</p>

<p style="margin-left:11%;"><b>-D, --delete</b></p>

<p style="margin-left:22%;">Delete the specified rule or
rules from the selected chain. There are two ways to use
this command. The first is by specifying an interval of rule
numbers to delete (directly after <b>-D</b>). Syntax:
<i>start_nr</i>[<i>:end_nr</i>] (use <b>-L --Ln</b> to list
the rules with their rule number). When <i>end_nr</i> is
omitted, all rules starting from <i>start_nr</i> are
deleted. Using negative numbers is allowed, for more details
about using negative numbers, see the <b>-I</b> command. The
second usage is by specifying the complete rule as it would
have been specified when it was added. Only the first
encountered rule that is the same as this specified rule, in
other words the matching rule with the lowest (positive)
rule number, is deleted.</p>

<p style="margin-left:11%;"><b>-C,
--change-counters</b></p>

<p style="margin-left:22%;">Change the counters of the
specified rule or rules from the selected chain. There are
two ways to use this command. The first is by specifying an
interval of rule numbers to do the changes on (directly
after <b>-C</b>). Syntax: <i>start_nr</i>[<i>:end_nr</i>]
(use <b>-L --Ln</b> to list the rules with their rule
number). The details are the same as for the <b>-D</b>
command. The second usage is by specifying the complete rule
as it would have been specified when it was added. Only the
counters of the first encountered rule that is the same as
this specified rule, in other words the matching rule with
the lowest (positive) rule number, are changed. In the first
usage, the counters are specified directly after the
interval specification, in the second usage directly after
<b>-C</b>. First the packet counter is specified, then the
byte counter. If the specified counters start with a
&rsquo;+&rsquo;, the counter values are added to the
respective current counter values. If the specified counters
start with a &rsquo;-&rsquo;, the counter values are
decreased from the respective current counter values. No
bounds checking is done. If the counters don&rsquo;t start
with &rsquo;+&rsquo; or &rsquo;-&rsquo;, the current
counters are changed to the specified counters.</p>

<p style="margin-left:11%;"><b>-I, --insert</b></p>

<p style="margin-left:22%;">Insert the specified rule into
the selected chain at the specified rule number. If the rule
number is not specified, the rule is added at the head of
the chain. If the current number of rules equals <i>N</i>,
then the specified number can be between <i>-N</i> and
<i>N+1</i>. For a positive number <i>i</i>, it holds that
<i>i</i> and <i>i-N-1</i> specify the same place in the
chain where the rule should be inserted. The rule number 0
specifies the place past the last rule in the chain and
using this number is therefore equivalent to using the
<b>-A</b> command. Rule numbers structly smaller than 0 can
be useful when more than one rule needs to be inserted in a
chain.</p>

<p style="margin-left:11%;"><b>-P, --policy</b></p>

<p style="margin-left:22%;">Set the policy for the chain to
the given target. The policy can be <b>ACCEPT</b>,
<b>DROP</b> or <b>RETURN</b>.</p>

<p style="margin-left:11%;"><b>-F, --flush</b></p>

<p style="margin-left:22%;">Flush the selected chain. If no
chain is selected, then every chain will be flushed.
Flushing a chain does not change the policy of the chain,
however.</p>

<p style="margin-left:11%;"><b>-Z, --zero</b></p>

<p style="margin-left:22%;">Set the counters of the
selected chain to zero. If no chain is selected, all the
counters are set to zero. The <b>-Z</b> command can be used
in conjunction with the <b>-L</b> command. When both the
<b>-Z</b> and <b>-L</b> commands are used together in this
way, the rule counters are printed on the screen before they
are set to zero.</p>

<p style="margin-left:11%;"><b>-L, --list</b></p>

<p style="margin-left:22%;">List all rules in the selected
chain. If no chain is selected, all chains are listed. <br>
The following options change the output of the <b>-L</b>
command. <b><br>
--Ln</b> <br>
Places the rule number in front of every rule. This option
is incompatible with the <b>--Lx</b> option. <b><br>
--Lc</b> <br>
Shows the counters at the end of each rule displayed by the
<b>-L</b> command. Both a frame counter (pcnt) and a byte
counter (bcnt) are displayed. The frame counter shows how
many frames have matched the specific rule, the byte counter
shows the sum of the frame sizes of these matching frames.
Using this option in combination with the <b>--Lx</b> option
causes the counters to be written out in the
&rsquo;<b>-c</b> &lt;pcnt&gt; &lt;bcnt&gt;&rsquo; option
format. <b><br>
--Lx</b> <br>
Changes the output so that it produces a set of ebtables
commands that construct the contents of the chain, when
specified. If no chain is specified, ebtables commands to
construct the contents of the table are given, including
commands for creating the user-defined chains (if any). You
can use this set of commands in an ebtables boot or reload
script. For example the output could be used at system
startup. The <b>--Lx</b> option is incompatible with the
<b>--Ln</b> listing option. Using the <b>--Lx</b> option
together with the <b>--Lc</b> option will cause the counters
to be written out in the &rsquo;<b>-c</b> &lt;pcnt&gt;
&lt;bcnt&gt;&rsquo; option format. <b><br>
--Lmac2</b> <br>
Shows all MAC addresses with the same length, adding leading
zeroes if necessary. The default representation omits
leading zeroes in the addresses.</p>

<p style="margin-left:11%;"><b>-N, --new-chain</b></p>

<p style="margin-left:22%;">Create a new user-defined chain
with the given name. The number of user-defined chains is
limited only by the number of possible chain names. A
user-defined chain name has a maximum length of 31
characters. The standard policy of the user-defined chain is
ACCEPT. The policy of the new chain can be initialized to a
different standard target by using the <b>-P</b> command
together with the <b>-N</b> command. In this case, the chain
name does not have to be specified for the <b>-P</b>
command.</p>

<p style="margin-left:11%;"><b>-X, --delete-chain</b></p>

<p style="margin-left:22%;">Delete the specified
user-defined chain. There must be no remaining references
(jumps) to the specified chain, otherwise ebtables will
refuse to delete it. If no chain is specified, all
user-defined chains that aren&rsquo;t referenced will be
removed.</p>

<p style="margin-left:11%;"><b>-E, --rename-chain</b></p>

<p style="margin-left:22%;">Rename the specified chain to a
new name. Besides renaming a user-defined chain, you can
rename a standard chain to a name that suits your taste. For
example, if you like PREFORWARDING more than PREROUTING,
then you can use the -E command to rename the PREROUTING
chain. If you do rename one of the standard ebtables chain
names, please be sure to mention this fact should you post a
question on the ebtables mailing lists. It would be wise to
use the standard name in your post. Renaming a standard
ebtables chain in this fashion has no effect on the
structure or functioning of the ebtables kernel table.</p>

<p style="margin-left:11%;"><b>--init-table</b></p>

<p style="margin-left:22%;">Replace the current table data
by the initial table data.</p>

<p style="margin-left:11%;"><b>--atomic-init</b></p>

<p style="margin-left:22%;">Copy the kernel&rsquo;s initial
data of the table to the specified file. This can be used as
the first action, after which rules are added to the file.
The file can be specified using the <b>--atomic-file</b>
command or through the <i>EBTABLES_ATOMIC_FILE</i>
environment variable.</p>

<p style="margin-left:11%;"><b>--atomic-save</b></p>

<p style="margin-left:22%;">Copy the kernel&rsquo;s current
data of the table to the specified file. This can be used as
the first action, after which rules are added to the file.
The file can be specified using the <b>--atomic-file</b>
command or through the <i>EBTABLES_ATOMIC_FILE</i>
environment variable.</p>

<p style="margin-left:11%;"><b>--atomic-commit</b></p>

<p style="margin-left:22%;">Replace the kernel table data
with the data contained in the specified file. This is a
useful command that allows you to load all your rules of a
certain table into the kernel at once, saving the kernel a
lot of precious time and allowing atomic updates of the
tables. The file which contains the table data is
constructed by using either the <b>--atomic-init</b> or the
<b>--atomic-save</b> command to generate a starting file.
After that, using the <b>--atomic-file</b> command when
constructing rules or setting the
<i>EBTABLES_ATOMIC_FILE</i> environment variable allows you
to extend the file and build the complete table before
committing it to the kernel. This command can be very useful
in boot scripts to populate the ebtables tables in a fast
way.</p>


<p style="margin-left:11%; margin-top: 1em"><b>MISCELLANOUS
COMMANDS <br>
-V, --version</b></p>

<p style="margin-left:22%;">Show the version of the
ebtables userspace program.</p>

<p style="margin-left:11%;"><b>-h, --help</b> [<i>list of
module names</i>]</p>

<p style="margin-left:22%;">Give a brief description of the
command syntax. Here you can also specify names of
extensions and ebtables will try to write help about those
extensions. E.g. <i>ebtables -h snat log ip arp</i>. Specify
<i>list_extensions</i> to list all extensions supported by
the userspace utility.</p>

<p style="margin-left:11%;"><b>-j, --jump</b>
<i>target</i></p>

<p style="margin-left:22%;">The target of the rule. This is
one of the following values: <b>ACCEPT</b>, <b>DROP</b>,
<b>CONTINUE</b>, <b>RETURN</b>, a target extension (see
<b>TARGET EXTENSIONS</b>) or a user-defined chain name.</p>

<p style="margin-left:11%;"><b>--atomic-file</b>
<i>file</i></p>

<p style="margin-left:22%;">Let the command operate on the
specified <i>file</i>. The data of the table to operate on
will be extracted from the file and the result of the
operation will be saved back into the file. If specified,
this option should come before the command specification. An
alternative that should be preferred, is setting the
<i>EBTABLES_ATOMIC_FILE</i> environment variable.</p>

<p style="margin-left:11%;"><b>-M, --modprobe</b>
<i>program</i></p>

<p style="margin-left:22%;">When talking to the kernel, use
this <i>program</i> to try to automatically load missing
kernel modules.</p>

<p style="margin-left:11%;"><b>--concurrent</b></p>

<p style="margin-left:22%;">Use a file lock to support
concurrent scripts updating the ebtables kernel tables.</p>

<p style="margin-left:11%; margin-top: 1em"><b>RULE
SPECIFICATIONS</b> <br>
The following command line arguments make up a rule
specification (as used in the add and delete commands). A
&quot;!&quot; option before the specification inverts the
test for that specification. Apart from these standard rule
specifications there are some other command line arguments
of interest. See both the <b>MATCH EXTENSIONS</b> and the
<b>WATCHER EXTENSIONS</b> below. <b><br>
-p, --protocol</b> [!] <i>protocol</i></p>

<p style="margin-left:22%;">The protocol that was
responsible for creating the frame. This can be a
hexadecimal number, above <i>0x0600</i>, a name (e.g.
<i>ARP</i> ) or <b>LENGTH</b>. The protocol field of the
Ethernet frame can be used to denote the length of the
header (802.2/802.3 networks). When the value of that field
is below or equals <i>0x0600</i>, the value equals the size
of the header and shouldn&rsquo;t be used as a protocol
number. Instead, all frames where the protocol field is used
as the length field are assumed to be of the same
&rsquo;protocol&rsquo;. The protocol name used in ebtables
for these frames is <b>LENGTH</b>. <br>
The file <b>/etc/ethertypes</b> can be used to show readable
characters instead of hexadecimal numbers for the protocols.
For example, <i>0x0800</i> will be represented by
<i>IPV4</i>. The use of this file is not case sensitive. See
that file for more information. The flag <b>--proto</b> is
an alias for this option.</p>

<p style="margin-left:11%;"><b>-i, --in-interface</b> [!]
<i>name</i></p>

<p style="margin-left:22%;">The interface (bridge port) via
which a frame is received (this option is useful in the
<b>INPUT</b>, <b>FORWARD</b>, <b>PREROUTING</b> and
<b>BROUTING</b> chains). If the interface name ends with
&rsquo;+&rsquo;, then any interface name that begins with
this name (disregarding &rsquo;+&rsquo;) will match. The
flag <b>--in-if</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--logical-in</b> [!]
<i>name</i></p>

<p style="margin-left:22%;">The (logical) bridge interface
via which a frame is received (this option is useful in the
<b>INPUT</b>, <b>FORWARD</b>, <b>PREROUTING</b> and
<b>BROUTING</b> chains). If the interface name ends with
&rsquo;+&rsquo;, then any interface name that begins with
this name (disregarding &rsquo;+&rsquo;) will match.</p>

<p style="margin-left:11%;"><b>-o, --out-interface</b> [!]
<i>name</i></p>

<p style="margin-left:22%;">The interface (bridge port) via
which a frame is going to be sent (this option is useful in
the <b>OUTPUT</b>, <b>FORWARD</b> and <b>POSTROUTING</b>
chains). If the interface name ends with &rsquo;+&rsquo;,
then any interface name that begins with this name
(disregarding &rsquo;+&rsquo;) will match. The flag
<b>--out-if</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--logical-out</b> [!]
<i>name</i></p>

<p style="margin-left:22%;">The (logical) bridge interface
via which a frame is going to be sent (this option is useful
in the <b>OUTPUT</b>, <b>FORWARD</b> and <b>POSTROUTING</b>
chains). If the interface name ends with &rsquo;+&rsquo;,
then any interface name that begins with this name
(disregarding &rsquo;+&rsquo;) will match.</p>

<p style="margin-left:11%;"><b>-s, --source</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The source MAC address. Both
mask and address are written as 6 hexadecimal numbers
separated by colons. Alternatively one can specify Unicast,
Multicast, Broadcast or BGA (Bridge Group Address): <i><br>
Unicast</i>=00:00:00:00:00:00/01:00:00:00:00:00,
<i>Multicast</i>=01:00:00:00:00:00/01:00:00:00:00:00,
<i>Broadcast</i>=ff:ff:ff:ff:ff:ff/ff:ff:ff:ff:ff:ff or
<i>BGA</i>=01:80:c2:00:00:00/ff:ff:ff:ff:ff:ff. Note that a
broadcast address will also match the multicast
specification. The flag <b>--src</b> is an alias for this
option.</p>

<p style="margin-left:11%;"><b>-d, --destination</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The destination MAC address.
See <b>-s</b> (above) for more details on MAC addresses. The
flag <b>--dst</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>-c, --set-counter</b>
<i>pcnt bcnt</i></p>

<p style="margin-left:22%;">If used with <b>-A</b> or
<b>-I</b>, then the packet and byte counters of the new rule
will be set to <i>pcnt</i>, resp. <i>bcnt</i>. If used with
the <b>-C</b> or <b>-D</b> commands, only rules with a
packet and byte count equal to <i>pcnt</i>, resp.
<i>bcnt</i> will match.</p>

<p style="margin-left:11%; margin-top: 1em"><b>MATCH
EXTENSIONS</b> <br>
Ebtables extensions are dynamically loaded into the
userspace tool, there is therefore no need to explicitly
load them with a -m option like is done in iptables. These
extensions deal with functionality supported by kernel
modules supplemental to the core ebtables code.</p>

<p style="margin-left:11%; margin-top: 1em"><b>802_3</b>
<br>
Specify 802.3 DSAP/SSAP fields or SNAP type. The protocol
must be specified as <i>LENGTH</i> (see the option <i>-p</i>
above). <b><br>
--802_3-sap</b> [!] <i>sap</i></p>

<p style="margin-left:22%;">DSAP and SSAP are two one byte
802.3 fields. The bytes are always equal, so only one byte
(hexadecimal) is needed as an argument.</p>

<p style="margin-left:11%;"><b>--802_3-type</b> [!]
<i>type</i></p>

<p style="margin-left:22%;">If the 802.3 DSAP and SSAP
values are 0xaa then the SNAP type field must be consulted
to determine the payload protocol. This is a two byte
(hexadecimal) argument. Only 802.3 frames with DSAP/SSAP
0xaa are checked for type.</p>

<p style="margin-left:11%; margin-top: 1em"><b>among</b>
<br>
Match a MAC address or MAC/IP address pair versus a list of
MAC addresses and MAC/IP address pairs. A list entry has the
following format: <i>xx:xx:xx:xx:xx:xx[=ip.ip.ip.ip][,]</i>.
Multiple list entries are separated by a comma, specifying
an IP address corresponding to the MAC address is optional.
Multiple MAC/IP address pairs with the same MAC address but
different IP address (and vice versa) can be specified. If
the MAC address doesn&rsquo;t match any entry from the list,
the frame doesn&rsquo;t match the rule (unless &quot;!&quot;
was used). <b><br>
--among-dst</b> [!] <i>list</i></p>

<p style="margin-left:22%;">Compare the MAC destination to
the given list. If the Ethernet frame has type <i>IPv4</i>
or <i>ARP</i>, then comparison with MAC/IP destination
address pairs from the list is possible.</p>

<p style="margin-left:11%;"><b>--among-src</b> [!]
<i>list</i></p>

<p style="margin-left:22%;">Compare the MAC source to the
given list. If the Ethernet frame has type <i>IPv4</i> or
<i>ARP</i>, then comparison with MAC/IP source address pairs
from the list is possible.</p>

<p style="margin-left:11%;"><b>--among-dst-file</b> [!]
<i>file</i></p>

<p style="margin-left:22%;">Same as <b>--among-dst</b> but
the list is read in from the specified file.</p>

<p style="margin-left:11%;"><b>--among-src-file</b> [!]
<i>file</i></p>

<p style="margin-left:22%;">Same as <b>--among-src</b> but
the list is read in from the specified file.</p>

<p style="margin-left:11%; margin-top: 1em"><b>arp</b> <br>
Specify (R)ARP fields. The protocol must be specified as
<i>ARP</i> or <i>RARP</i>. <b><br>
--arp-opcode</b> [!] <i>opcode</i></p>

<p style="margin-left:22%;">The (R)ARP opcode (decimal or a
string, for more details see <b>ebtables -h arp</b>).</p>

<p style="margin-left:11%;"><b>--arp-htype</b> [!]
<i>hardware type</i></p>

<p style="margin-left:22%;">The hardware type, this can be
a decimal or the string <i>Ethernet</i> (which sets
<i>type</i> to 1). Most (R)ARP packets have Eternet as
hardware type.</p>

<p style="margin-left:11%;"><b>--arp-ptype</b> [!]
<i>protocol type</i></p>

<p style="margin-left:22%;">The protocol type for which the
(r)arp is used (hexadecimal or the string <i>IPv4</i>,
denoting 0x0800). Most (R)ARP packets have protocol type
IPv4.</p>

<p style="margin-left:11%;"><b>--arp-ip-src</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The (R)ARP IP source address
specification.</p>

<p style="margin-left:11%;"><b>--arp-ip-dst</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The (R)ARP IP destination
address specification.</p>

<p style="margin-left:11%;"><b>--arp-mac-src</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The (R)ARP MAC source address
specification.</p>

<p style="margin-left:11%;"><b>--arp-mac-dst</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The (R)ARP MAC destination
address specification.</p>

<p style="margin-left:11%;">[!] <b>--arp-gratuitous</b></p>

<p style="margin-left:22%;">Checks for ARP gratuitous
packets: checks equality of IPv4 source address and IPv4
destination address inside the ARP header.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ip</b> <br>
Specify IPv4 fields. The protocol must be specified as
<i>IPv4</i>. <b><br>
--ip-source</b> [!] <i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The source IP address. The flag
<b>--ip-src</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip-destination</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The destination IP address. The
flag <b>--ip-dst</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip-tos</b> [!]
<i>tos</i></p>

<p style="margin-left:22%;">The IP type of service, in
hexadecimal numbers. <b>IPv4</b>.</p>

<p style="margin-left:11%;"><b>--ip-protocol</b> [!]
<i>protocol</i></p>

<p style="margin-left:22%;">The IP protocol. The flag
<b>--ip-proto</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip-source-port</b> [!]
<i>port1</i>[:<i>port2</i>]</p>

<p style="margin-left:22%;">The source port or port range
for the IP protocols 6 (TCP), 17 (UDP), 33 (DCCP) or 132
(SCTP). The <b>--ip-protocol</b> option must be specified as
<i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or <i>SCTP</i>. If
<i>port1</i> is omitted, <i>0:port2</i> is used; if
<i>port2</i> is omitted but a colon is specified,
<i>port1:65535</i> is used. The flag <b>--ip-sport</b> is an
alias for this option.</p>

<p style="margin-left:11%;"><b>--ip-destination-port</b>
[!] <i>port1</i>[:<i>port2</i>]</p>

<p style="margin-left:22%;">The destination port or port
range for ip protocols 6 (TCP), 17 (UDP), 33 (DCCP) or 132
(SCTP). The <b>--ip-protocol</b> option must be specified as
<i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or <i>SCTP</i>. If
<i>port1</i> is omitted, <i>0:port2</i> is used; if
<i>port2</i> is omitted but a colon is specified,
<i>port1:65535</i> is used. The flag <b>--ip-dport</b> is an
alias for this option.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ip6</b> <br>
Specify IPv6 fields. The protocol must be specified as
<i>IPv6</i>. <b><br>
--ip6-source</b> [!] <i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The source IPv6 address. The
flag <b>--ip6-src</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip6-destination</b> [!]
<i>address</i>[/<i>mask</i>]</p>

<p style="margin-left:22%;">The destination IPv6 address.
The flag <b>--ip6-dst</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip6-tclass</b> [!]
<i>tclass</i></p>

<p style="margin-left:22%;">The IPv6 traffic class, in
hexadecimal numbers.</p>

<p style="margin-left:11%;"><b>--ip6-protocol</b> [!]
<i>protocol</i></p>

<p style="margin-left:22%;">The IP protocol. The flag
<b>--ip6-proto</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip6-source-port</b> [!]
<i>port1</i>[:<i>port2</i>]</p>

<p style="margin-left:22%;">The source port or port range
for the IPv6 protocols 6 (TCP), 17 (UDP), 33 (DCCP) or 132
(SCTP). The <b>--ip6-protocol</b> option must be specified
as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or <i>SCTP</i>. If
<i>port1</i> is omitted, <i>0:port2</i> is used; if
<i>port2</i> is omitted but a colon is specified,
<i>port1:65535</i> is used. The flag <b>--ip6-sport</b> is
an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip6-destination-port</b>
[!] <i>port1</i>[:<i>port2</i>]</p>

<p style="margin-left:22%;">The destination port or port
range for IPv6 protocols 6 (TCP), 17 (UDP), 33 (DCCP) or 132
(SCTP). The <b>--ip6-protocol</b> option must be specified
as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or <i>SCTP</i>. If
<i>port1</i> is omitted, <i>0:port2</i> is used; if
<i>port2</i> is omitted but a colon is specified,
<i>port1:65535</i> is used. The flag <b>--ip6-dport</b> is
an alias for this option.</p>

<p style="margin-left:11%;"><b>--ip6-icmp-type</b> [!]
{<i>type</i>[:<i>type</i>]/<i>code</i>[:<i>code</i>]|<i>typename</i>}</p>

<p style="margin-left:22%;">Specify ipv6&minus;icmp type
and code to match. Ranges for both type and code are
supported. Type and code are separated by a slash. Valid
numbers for type and range are 0 to 255. To match a single
type including all valid codes, symbolic names can be used
instead of numbers. The list of known type names is shown by
the command <br>
ebtables &minus;&minus;help ip6 <br>
This option is only valid for &minus;&minus;ip6-prococol
ipv6-icmp.</p>

<p style="margin-left:11%; margin-top: 1em"><b>limit</b>
<br>
This module matches at a limited rate using a token bucket
filter. A rule using this extension will match until this
limit is reached. It can be used with the <b>--log</b>
watcher to give limited logging, for example. Its use is the
same as the limit match of iptables. <b><br>
--limit</b> [<i>value</i>]</p>

<p style="margin-left:22%;">Maximum average matching rate:
specified as a number, with an optional <i>/second</i>,
<i>/minute</i>, <i>/hour</i>, or <i>/day</i> suffix; the
default is <i>3/hour</i>.</p>

<p style="margin-left:11%;"><b>--limit-burst</b>
[<i>number</i>]</p>

<p style="margin-left:22%;">Maximum initial number of
packets to match: this number gets recharged by one every
time the limit specified above is not reached, up to this
number; the default is <i>5</i>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>mark_m <br>
--mark</b> [!] [<i>value</i>][/<i>mask</i>]</p>

<p style="margin-left:22%;">Matches frames with the given
unsigned mark value. If a <i>value</i> and <i>mask</i> are
specified, the logical AND of the mark value of the frame
and the user-specified <i>mask</i> is taken before comparing
it with the user-specified mark <i>value</i>. When only a
mark <i>value</i> is specified, the packet only matches when
the mark value of the frame equals the user-specified mark
<i>value</i>. If only a <i>mask</i> is specified, the
logical AND of the mark value of the frame and the
user-specified <i>mask</i> is taken and the frame matches
when the result of this logical AND is non-zero. Only
specifying a <i>mask</i> is useful to match multiple mark
values.</p>

<p style="margin-left:11%; margin-top: 1em"><b>pkttype <br>
--pkttype-type</b> [!] <i>type</i></p>

<p style="margin-left:22%;">Matches on the Ethernet
&quot;class&quot; of the frame, which is determined by the
generic networking code. Possible values: <i>broadcast</i>
(MAC destination is the broadcast address), <i>multicast</i>
(MAC destination is a multicast address), <i>host</i> (MAC
destination is the receiving network device), or
<i>otherhost</i> (none of the above).</p>

<p style="margin-left:11%; margin-top: 1em"><b>stp</b> <br>
Specify stp BPDU (bridge protocol data unit) fields. The
destination address (<b>-d</b>) must be specified as the
bridge group address (<i>BGA</i>). For all options for which
a range of values can be specified, it holds that if the
lower bound is omitted (but the colon is not), then the
lowest possible lower bound for that option is used, while
if the upper bound is omitted (but the colon again is not),
the highest possible upper bound for that option is used.
<b><br>
--stp-type</b> [!] <i>type</i></p>

<p style="margin-left:22%;">The BPDU type (0-255),
recognized non-numerical types are <i>config</i>, denoting a
configuration BPDU (=0), and <i>tcn</i>, denothing a
topology change notification BPDU (=128).</p>

<p style="margin-left:11%;"><b>--stp-flags</b> [!]
<i>flag</i></p>

<p style="margin-left:22%;">The BPDU flag (0-255),
recognized non-numerical flags are <i>topology-change</i>,
denoting the topology change flag (=1), and
<i>topology-change-ack</i>, denoting the topology change
acknowledgement flag (=128).</p>

<p style="margin-left:11%;"><b>--stp-root-prio</b> [!]
[<i>prio</i>][:<i>prio</i>]</p>

<p style="margin-left:22%;">The root priority (0-65535)
range.</p>

<p style="margin-left:11%;"><b>--stp-root-addr</b> [!]
[<i>address</i>][/<i>mask</i>]</p>

<p style="margin-left:22%;">The root mac address, see the
option <b>-s</b> for more details.</p>

<p style="margin-left:11%;"><b>--stp-root-cost</b> [!]
[<i>cost</i>][:<i>cost</i>]</p>

<p style="margin-left:22%;">The root path cost
(0-4294967295) range.</p>

<p style="margin-left:11%;"><b>--stp-sender-prio</b> [!]
[<i>prio</i>][:<i>prio</i>]</p>

<p style="margin-left:22%;">The BPDU&rsquo;s sender
priority (0-65535) range.</p>

<p style="margin-left:11%;"><b>--stp-sender-addr</b> [!]
[<i>address</i>][/<i>mask</i>]</p>

<p style="margin-left:22%;">The BPDU&rsquo;s sender mac
address, see the option <b>-s</b> for more details.</p>

<p style="margin-left:11%;"><b>--stp-port</b> [!]
[<i>port</i>][:<i>port</i>]</p>

<p style="margin-left:22%;">The port identifier (0-65535)
range.</p>

<p style="margin-left:11%;"><b>--stp-msg-age</b> [!]
[<i>age</i>][:<i>age</i>]</p>

<p style="margin-left:22%;">The message age timer (0-65535)
range.</p>

<p style="margin-left:11%;"><b>--stp-max-age</b> [!]
[<i>age</i>][:<i>age</i>]</p>

<p style="margin-left:22%;">The max age timer (0-65535)
range.</p>

<p style="margin-left:11%;"><b>--stp-hello-time</b> [!]
[<i>time</i>][:<i>time</i>]</p>

<p style="margin-left:22%;">The hello time timer (0-65535)
range.</p>

<p style="margin-left:11%;"><b>--stp-forward-delay</b> [!]
[<i>delay</i>][:<i>delay</i>]</p>

<p style="margin-left:22%;">The forward delay timer
(0-65535) range.</p>

<p style="margin-left:11%; margin-top: 1em"><b>vlan</b>
<br>
Specify 802.1Q Tag Control Information fields. The protocol
must be specified as <i>802_1Q</i> (0x8100). <b><br>
--vlan-id</b> [!] <i>id</i></p>

<p style="margin-left:22%;">The VLAN identifier field
(VID). Decimal number from 0 to 4095.</p>

<p style="margin-left:11%;"><b>--vlan-prio</b> [!]
<i>prio</i></p>

<p style="margin-left:22%;">The user priority field, a
decimal number from 0 to 7. The VID should be set to 0
(&quot;null VID&quot;) or unspecified (in the latter case
the VID is deliberately set to 0).</p>

<p style="margin-left:11%;"><b>--vlan-encap</b> [!]
<i>type</i></p>

<p style="margin-left:22%;">The encapsulated Ethernet frame
type/length. Specified as a hexadecimal number from 0x0000
to 0xFFFF or as a symbolic name from
<b>/etc/ethertypes</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>WATCHER
EXTENSIONS</b> <br>
Watchers only look at frames passing by, they don&rsquo;t
modify them nor decide to accept the frames or not. These
watchers only see the frame if the frame matches the rule,
and they see it before the target is executed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>log</b> <br>
The log watcher writes descriptive data about a frame to the
syslog.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>--log</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Log with the default loggin options: log-level=
<i>info</i>, log-prefix=&quot;&quot;, no ip logging, no arp
logging.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>--log-level</b>
<i>level</i></p>

<p style="margin-left:22%;">Defines the logging level. For
the possible values, see <b>ebtables -h log</b>. The default
level is <i>info</i>.</p>

<p style="margin-left:11%;"><b>--log-prefix</b>
<i>text</i></p>

<p style="margin-left:22%;">Defines the prefix <i>text</i>
to be printed at the beginning of the line with the logging
information.</p>

<p style="margin-left:11%;"><b>--log-ip</b></p>

<p style="margin-left:22%;">Will log the ip information
when a frame made by the ip protocol matches the rule. The
default is no ip information logging.</p>

<p style="margin-left:11%;"><b>--log-ip6</b></p>

<p style="margin-left:22%;">Will log the ipv6 information
when a frame made by the ipv6 protocol matches the rule. The
default is no ipv6 information logging.</p>

<p style="margin-left:11%;"><b>--log-arp</b></p>

<p style="margin-left:22%;">Will log the (r)arp information
when a frame made by the (r)arp protocols matches the rule.
The default is no (r)arp information logging.</p>

<p style="margin-left:11%; margin-top: 1em"><b>nflog</b>
<br>
The nflog watcher passes the packet to the loaded logging
backend in order to log the packet. This is usually used in
combination with nfnetlink_log as logging backend, which
will multicast the packet through a <i>netlink</i> socket to
the specified multicast group. One or more userspace
processes may subscribe to the group to receive the packets.
<b><br>
--nflog</b></p>

<p style="margin-left:22%;">Log with the default logging
options</p>

<p style="margin-left:11%;"><b>--nflog-group</b>
<i>nlgroup</i></p>

<p style="margin-left:22%;">The netlink group (1 - 2^32-1)
to which packets are (only applicable for nfnetlink_log).
The default value is 1.</p>

<p style="margin-left:11%;"><b>--nflog-prefix</b>
<i>prefix</i></p>

<p style="margin-left:22%;">A prefix string to include in
the log message, up to 30 characters long, useful for
distinguishing messages in the logs.</p>

<p style="margin-left:11%;"><b>--nflog-range</b>
<i>size</i></p>

<p style="margin-left:22%;">The number of bytes to be
copied to userspace (only applicable for nfnetlink_log).
nfnetlink_log instances may specify their own range, this
option overrides it.</p>

<p style="margin-left:11%;"><b>--nflog-threshold</b>
<i>size</i></p>

<p style="margin-left:22%;">Number of packets to queue
inside the kernel before sending them to userspace (only
applicable for nfnetlink_log). Higher values result in less
overhead per packet, but increase delay until the packets
reach userspace. The default value is 1.</p>

<p style="margin-left:11%; margin-top: 1em"><b>ulog</b>
<br>
The ulog watcher passes the packet to a userspace logging
daemon using netlink multicast sockets. This differs from
the log watcher in the sense that the complete packet is
sent to userspace instead of a descriptive text and that
netlink multicast sockets are used instead of the syslog.
This watcher enables parsing of packets with userspace
programs, the physical bridge in and out ports are also
included in the netlink messages. The ulog watcher module
accepts 2 parameters when the module is loaded into the
kernel (e.g. with modprobe): <b>nlbufsiz</b> specifies how
big the buffer for each netlink multicast group is. If you
say <i>nlbufsiz=8192</i>, for example, up to eight kB of
packets will get accumulated in the kernel until they are
sent to userspace. It is not possible to allocate more than
128kB. Please also keep in mind that this buffer size is
allocated for each nlgroup you are using, so the total
kernel memory usage increases by that factor. The default is
4096. <b>flushtimeout</b> specifies after how many
hundredths of a second the queue should be flushed, even if
it is not full yet. The default is 10 (one tenth of a
second).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>--ulog</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>Use the default settings: ulog-prefix=&quot;&quot;,
ulog-nlgroup=1, ulog-cprange=4096, ulog-qthreshold=1.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>--ulog-prefix</b>
<i>text</i></p>

<p style="margin-left:22%;">Defines the prefix included
with the packets sent to userspace.</p>

<p style="margin-left:11%;"><b>--ulog-nlgroup</b>
<i>group</i></p>

<p style="margin-left:22%;">Defines which netlink group
number to use (a number from 1 to 32). Make sure the netlink
group numbers used for the iptables ULOG target differ from
those used for the ebtables ulog watcher. The default group
number is 1.</p>

<p style="margin-left:11%;"><b>--ulog-cprange</b>
<i>range</i></p>

<p style="margin-left:22%;">Defines the maximum copy range
to userspace, for packets matching the rule. The default
range is 0, which means the maximum copy range is given by
<b>nlbufsiz</b>. A maximum copy range larger than 128*1024
is meaningless as the packets sent to userspace have an
upper size limit of 128*1024.</p>

<p style="margin-left:11%;"><b>--ulog-qthreshold</b>
<i>threshold</i></p>

<p style="margin-left:22%;">Queue at most <i>threshold</i>
number of packets before sending them to userspace with a
netlink socket. Note that packets can be sent to userspace
before the queue is full, this happens when the ulog kernel
timer goes off (the frequency of this timer depends on
<b>flushtimeout</b>).</p>

<p style="margin-left:11%; margin-top: 1em"><b>TARGET
EXTENSIONS <br>
arpreply</b> <br>
The <b>arpreply</b> target can be used in the
<b>PREROUTING</b> chain of the <b>nat</b> table. If this
target sees an ARP request it will automatically reply with
an ARP reply. The used MAC address for the reply can be
specified. The protocol must be specified as <i>ARP</i>.
When the ARP message is not an ARP request or when the ARP
request isn&rsquo;t for an IP address on an Ethernet
network, it is ignored by this target (<b>CONTINUE</b>).
When the ARP request is malformed, it is dropped
(<b>DROP</b>). <b><br>
--arpreply-mac</b> <i>address</i></p>

<p style="margin-left:22%;">Specifies the MAC address to
reply with: the Ethernet source MAC and the ARP payload
source MAC will be filled in with this address.</p>

<p style="margin-left:11%;"><b>--arpreply-target</b>
<i>target</i></p>

<p style="margin-left:22%;">Specifies the standard target.
After sending the ARP reply, the rule still has to give a
standard target so ebtables knows what to do with the ARP
request. The default target is <b>DROP</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>dnat</b>
<br>
The <b>dnat</b> target can only be used in the
<b>BROUTING</b> chain of the <b>broute</b> table and the
<b>PREROUTING</b> and <b>OUTPUT</b> chains of the <b>nat</b>
table. It specifies that the destination MAC address has to
be changed. <b><br>
--to-destination</b> <i>address</i></p>

<p style="margin-left:22%;">Change the destination MAC
address to the specified <i>address</i>. The flag
<b>--to-dst</b> is an alias for this option.</p>

<p style="margin-left:11%;"><b>--dnat-target</b>
<i>target</i></p>

<p style="margin-left:22%;">Specifies the standard target.
After doing the dnat, the rule still has to give a standard
target so ebtables knows what to do with the dnated frame.
The default target is <b>ACCEPT</b>. Making it
<b>CONTINUE</b> could let you use multiple target extensions
on the same frame. Making it <b>DROP</b> only makes sense in
the <b>BROUTING</b> chain but using the <b>redirect</b>
target is more logical there. <b>RETURN</b> is also allowed.
Note that using <b>RETURN</b> in a base chain is not allowed
(for obvious reasons).</p>

<p style="margin-left:11%; margin-top: 1em"><b>mark</b>
<br>
The <b>mark</b> target can be used in every chain of every
table. It is possible to use the marking of a frame/packet
in both ebtables and iptables, if the bridge-nf code is
compiled into the kernel. Both put the marking at the same
place. This allows for a form of communication between
ebtables and iptables. <b><br>
--mark-set</b> <i>value</i></p>

<p style="margin-left:22%;">Mark the frame with the
specified non-negative <i>value</i>.</p>

<p style="margin-left:11%;"><b>--mark-or</b>
<i>value</i></p>

<p style="margin-left:22%;">Or the frame with the specified
non-negative <i>value</i>.</p>

<p style="margin-left:11%;"><b>--mark-and</b>
<i>value</i></p>

<p style="margin-left:22%;">And the frame with the
specified non-negative <i>value</i>.</p>

<p style="margin-left:11%;"><b>--mark-xor</b>
<i>value</i></p>

<p style="margin-left:22%;">Xor the frame with the
specified non-negative <i>value</i>.</p>

<p style="margin-left:11%;"><b>--mark-target</b>
<i>target</i></p>

<p style="margin-left:22%;">Specifies the standard target.
After marking the frame, the rule still has to give a
standard target so ebtables knows what to do. The default
target is <b>ACCEPT</b>. Making it <b>CONTINUE</b> can let
you do other things with the frame in subsequent rules of
the chain.</p>


<p style="margin-left:11%; margin-top: 1em"><b>redirect</b>
<br>
The <b>redirect</b> target will change the MAC target
address to that of the bridge device the frame arrived on.
This target can only be used in the <b>BROUTING</b> chain of
the <b>broute</b> table and the <b>PREROUTING</b> chain of
the <b>nat</b> table. In the <b>BROUTING</b> chain, the MAC
address of the bridge port is used as destination address,
in the <b>PREROUTING</b> chain, the MAC address of the
bridge is used. <b><br>
--redirect-target</b> <i>target</i></p>

<p style="margin-left:22%;">Specifies the standard target.
After doing the MAC redirect, the rule still has to give a
standard target so ebtables knows what to do. The default
target is <b>ACCEPT</b>. Making it <b>CONTINUE</b> could let
you use multiple target extensions on the same frame. Making
it <b>DROP</b> in the <b>BROUTING</b> chain will let the
frames be routed. <b>RETURN</b> is also allowed. Note that
using <b>RETURN</b> in a base chain is not allowed.</p>

<p style="margin-left:11%; margin-top: 1em"><b>snat</b>
<br>
The <b>snat</b> target can only be used in the
<b>POSTROUTING</b> chain of the <b>nat</b> table. It
specifies that the source MAC address has to be changed.
<b><br>
--to-source</b> <i>address</i></p>

<p style="margin-left:22%;">Changes the source MAC address
to the specified <i>address</i>. The flag <b>--to-src</b> is
an alias for this option.</p>

<p style="margin-left:11%;"><b>--snat-target</b>
<i>target</i></p>

<p style="margin-left:22%;">Specifies the standard target.
After doing the snat, the rule still has to give a standard
target so ebtables knows what to do. The default target is
<b>ACCEPT</b>. Making it <b>CONTINUE</b> could let you use
multiple target extensions on the same frame. Making it
<b>DROP</b> doesn&rsquo;t make sense, but you could do that
too. <b>RETURN</b> is also allowed. Note that using
<b>RETURN</b> in a base chain is not allowed.</p>

<p style="margin-left:11%;"><b>--snat-arp</b></p>

<p style="margin-left:22%;">Also change the hardware source
address inside the arp header if the packet is an arp
message and the hardware address length in the arp header is
6 bytes.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>/etc/ethertypes
/var/lib/ebtables/lock</i></p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>EBTABLES_ATOMIC_FILE</i></p>

<h2>MAILINGLISTS
<a name="MAILINGLISTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">See
<b>http://netfilter.org/mailinglists.html</b></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>iptables</b>(8),
<b>brctl</b>(8), <b>ifconfig</b>(8), <b>route</b>(8)</p>

<p style="margin-left:11%; margin-top: 1em">See
<b>http://ebtables.sf.net</b></p>
<hr>
</body>
</html>
