<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:23:10 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title></title>
</head>
<body>

<hr>


<p>MODULI(5) BSD File Formats Manual MODULI(5)</p>

<p style="margin-top: 1em"><b>NAME</b></p>

<p style="margin-left:6%;"><b>moduli</b> &mdash;
Diffie-Hellman moduli</p>

<p style="margin-top: 1em"><b>DESCRIPTION</b></p>

<p style="margin-left:6%;">The <i>/etc/ssh/moduli</i> file
contains prime numbers and generators for use by sshd(8) in
the Diffie-Hellman Group Exchange key exchange method.</p>

<p style="margin-left:6%; margin-top: 1em">New moduli may
be generated with ssh-keygen(1) using a two-step process. An
initial <i>candidate generation</i> pass, using
<b>ssh-keygen -G</b>, calculates numbers that are likely to
be useful. A second <i>primality testing</i> pass, using
<b>ssh-keygen -T</b>, provides a high degree of assurance
that the numbers are prime and are safe for use in
Diffie-Hellman operations by sshd(8). This <b>moduli</b>
format is used as the output from each pass.</p>

<p style="margin-left:6%; margin-top: 1em">The file
consists of newline-separated records, one per modulus,
containing seven space-separated fields. These fields are as
follows:</p>

<p style="margin-top: 1em">timestamp</p>

<p style="margin-left:31%; margin-top: 1em">The time that
the modulus was last processed as YYYYMMDDHHMMSS.</p>

<p style="margin-top: 1em">type</p>

<p style="margin-left:31%; margin-top: 1em">Decimal number
specifying the internal structure of the prime modulus.
Supported types are:</p>

<p style="margin-top: 1em">0</p>

<p style="margin-left:38%; margin-top: 1em">Unknown, not
tested.</p>

<p>2</p>


<p style="margin-left:38%; margin-top: 1em">&quot;Safe&quot;
prime; (p-1)/2 is also prime.</p>

<p>4</p>

<p style="margin-left:38%; margin-top: 1em">Sophie Germain;
2p+1 is also prime.</p>

<p style="margin-left:31%; margin-top: 1em">Moduli
candidates initially produced by ssh-keygen(1) are Sophie
Germain primes (type 4). Further primality testing with
ssh-keygen(1) produces safe prime moduli (type 2) that are
ready for use in sshd(8). Other types are not used by
OpenSSH.</p>

<p style="margin-top: 1em">tests</p>

<p style="margin-left:31%; margin-top: 1em">Decimal number
indicating the type of primality tests that the number has
been subjected to represented as a bitmask of the following
values:</p>

<p style="margin-top: 1em">0x00</p>

<p style="margin-left:38%; margin-top: 1em">Not tested.</p>

<p>0x01</p>

<p style="margin-left:38%; margin-top: 1em">Composite
number &ndash; not prime.</p>

<p>0x02</p>

<p style="margin-left:38%; margin-top: 1em">Sieve of
Eratosthenes.</p>

<p>0x04</p>

<p style="margin-left:38%; margin-top: 1em">Probabilistic
Miller-Rabin primality tests.</p>

<p style="margin-left:31%; margin-top: 1em">The
ssh-keygen(1) moduli candidate generation uses the Sieve of
Eratosthenes (flag 0x02). Subsequent ssh-keygen(1) primality
tests are Miller-Rabin tests (flag 0x04).</p>

<p style="margin-top: 1em">trials</p>

<p style="margin-left:31%; margin-top: 1em">Decimal number
indicating the number of primality trials that have been
performed on the modulus.</p>

<p style="margin-top: 1em">size</p>

<p style="margin-left:31%; margin-top: 1em">Decimal number
indicating the size of the prime in bits.</p>

<p style="margin-top: 1em">generator</p>

<p style="margin-left:31%; margin-top: 1em">The recommended
generator for use with this modulus (hexadecimal).</p>

<p style="margin-top: 1em">modulus</p>

<p style="margin-left:31%; margin-top: 1em">The modulus
itself in hexadecimal.</p>

<p style="margin-left:6%; margin-top: 1em">When performing
Diffie-Hellman Group Exchange, sshd(8) first estimates the
size of the modulus required to produce enough
Diffie-Hellman output to sufficiently key the selected
symmetric cipher. sshd(8) then randomly selects a modulus
from <i>/etc/ssh/moduli</i> that best meets the size
requirement.</p>

<p style="margin-top: 1em"><b>SEE ALSO</b></p>

<p style="margin-left:6%;">ssh-keygen(1), sshd(8)</p>

<p style="margin-top: 1em"><b>STANDARDS</b> <br>
M. Friedl</p>

<p style="margin-left:6%;">,</p>

<p>N. Provos , and <br>
W. Simpson , <i><br>
Diffie-Hellman Group Exchange for the Secure Shell (SSH)
Transport Layer Protocol</i> , <br>
RFC 4419 , <br>
March 2006 <br>
2006 .</p>

<p style="margin-left:6%; margin-top: 1em">BSD
August&nbsp;18, 2016 BSD</p>
<hr>
</body>
</html>
