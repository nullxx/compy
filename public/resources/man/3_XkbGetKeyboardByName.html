<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:06:31 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>XkbGetKeyboardByName</title>

</head>
<body>

<h1 align="center">XkbGetKeyboardByName</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#ARGUMENTS">ARGUMENTS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#STRUCTURES">STRUCTURES</a><br>
<a href="#DIAGNOSTICS">DIAGNOSTICS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">XkbGetKeyboardByName
&minus; Build a new keyboard description from a set of named
components, and to optionally have the server use the
resulting description to replace an active one</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="52%">


<p style="margin-top: 1em"><b>XkbDescPtr
XkbGetKeyboardByName</b></p> </td>
<td width="6%"></td>
<td width="31%">


<p style="margin-top: 1em"><b>(Display *</b><i>dpy</i><b>,
unsigned int</b></p></td></tr>
</table>

<p style="margin-left:11%;"><i>device_spec</i><b>,
XkbComponentNamesPtr</b> <i>names</i><b>, unsigned int</b>
<i>want</i><b>, unsigned int</b> <i>need</i><b>, Bool</b>
<i>load</i><b>);</b></p>

<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p style="margin-top: 1em"><b><i>&minus; dpy</i></b></p></td>
<td width="4%"></td>
<td width="33%">


<p style="margin-top: 1em">connection to X server</p></td>
<td width="45%">
</td></tr>
</table>

<p style="margin-left:11%;"><i>&minus; device_spec</i></p>

<p style="margin-left:22%;">device ID, or XkbUseCoreKbd</p>

<p style="margin-left:11%;"><i>&minus; names</i></p>

<p style="margin-left:22%;">names of components to
fetch</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>&minus; want</i></p></td>
<td width="2%"></td>
<td width="60%">


<p>desired structures in returned record</p></td>
<td width="18%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>&minus; need</i></p></td>
<td width="2%"></td>
<td width="60%">


<p>mandatory structures in returned record</p></td>
<td width="18%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>&minus; load</i></p></td>
<td width="2%"></td>
<td width="60%">


<p>True =&gt; load into <i>device_spec</i></p></td>
<td width="18%">
</td></tr>
</table>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">A client may
request that the server fetch one or more components from
its database and use those components to build a new server
keyboard description. The new keyboard description may be
built from scratch, or it may be built starting with the
current keyboard description for a particular device. Once
the keyboard description is built, all or part of it may be
returned to the client. The parts returned to the client
need not include all of the parts used to build the
description. At the time it requests the server to build a
new keyboard description, a client may also request that the
server use the new description internally to replace the
current keyboard description for a specific device, in which
case the behavior of the device changes accordingly.</p>

<p style="margin-left:11%; margin-top: 1em">To build a new
keyboard description from a set of named components, and to
optionally have the server use the resulting description to
replace an active one, use <i>XkbGetKeyboardByName.</i></p>

<p style="margin-left:11%; margin-top: 1em"><i>names</i>
contains a set of expressions describing the keyboard
components the server should use to build the new keyboard
description. <i>want</i> and <i>need</i> are bit fields
describing the parts of the resulting keyboard description
that should be present in the returned XkbDescRec.</p>

<p style="margin-left:11%; margin-top: 1em">The individual
fields in <i>names</i> are <i>component expressions</i>
composed of keyboard component names (no wildcarding as may
be used in <i>XkbListComponents),</i> the special component
name symbol &lsquo;%&rsquo;, and the special operator
characters &lsquo;+&rsquo; and &lsquo;|&rsquo;. A component
expression is parsed left to right, as follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p style="margin-top: 1em">&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p style="margin-top: 1em">The special component name
&quot;computed&quot; may be used in keycodes component
expressions and refers to a component consisting of a set of
keycodes computed automatically by the server as needed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The special component name &quot;canonical&quot; may be
used in types component expressions and refers to a partial
component defining the four standard key types: ALPHABETIC,
ONE_LEVEL, TWO_LEVEL, and KEYPAD.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The special component name &lsquo;%&rsquo; refers to the
keyboard description for the device specified in device_spec
or the keymap names component. If a keymap names component
is specified that does not begin with &lsquo;+&rsquo; or
&lsquo;|&rsquo; and does not contain &lsquo;%&rsquo;, then
&lsquo;%&rsquo; refers to the description generated by the
keymap names component. Otherwise, it refers to the keyboard
description for device_spec.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The &lsquo;+&rsquo; operator specifies that the
following component should override the currently assembled
description; any definitions that are present in both
components are taken from the second.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>The &lsquo;|&rsquo; operator specifies that the next
specified component should augment the currently assembled
description; any definitions that are present in both
components are taken from the first.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>If the component expression begins with an operator, a
leading &lsquo;%&rsquo; is implied.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="1%">


<p>&bull;</p></td>
<td width="6%"></td>
<td width="82%">


<p>If any unknown or illegal characters appear anywhere in
the expression, the entire expression is invalid and is
ignored.</p> </td></tr>
</table>

<p style="margin-left:18%; margin-top: 1em">For example, if
<i>names-&gt;symbols</i> contained the expression
&quot;+de&quot;, it specifies that the default member of the
&quot;de&quot; class of symbols should be applied to the
current keyboard mapping, overriding any existing
definitions (it could also be written
&quot;+de(default)&quot;).</p>

<p style="margin-left:18%; margin-top: 1em">Here is a
slightly more involved example: the expression
&quot;acme(ascii)+de(basic)|iso9995-3&quot; constructs a
German (de) mapping for the ASCII keyboard supplied by the
&quot;acme&quot; vendor. The new definition begins with the
symbols for the ASCII keyboard for Acme
<i>(acme(ascii)),</i> overrides them with definitions for
the basic German keyboard <i>(de(basic)),</i> and then
applies the definitions from the default iso9995-3 keyboard
<i>(iso9995-3)</i> to any undefined keys or groups of keys
(part three of the iso9995 standard defines a common set of
bindings for the secondary group, but allows national
layouts to override those definitions where necessary).</p>

<p style="margin-left:18%; margin-top: 1em"><b>NOTE</b> The
interpretation of the above expression components (acme,
ascii, de, basic, iso9995-3) is not defined by Xkb; only the
operations and their ordering are.</p>

<p style="margin-left:18%; margin-top: 1em">Note that the
presence of a keymap <i>names</i> component that does not
contain &lsquo;%&rsquo; (either explicit or implied by
virtue of an expression starting with an operator) indicates
a description that is independent of the keyboard
description for the device specified in <i>device_spec.</i>
The same is true of requests in which the keymap names
component is empty and all five other names components
contain expressions void of references to &lsquo;%&rsquo;.
Requests of this form allow you to deal with keyboard
definitions independent of any actual device.</p>

<p style="margin-left:18%; margin-top: 1em">The server
parses all non-NULL fields in <i>names</i> and uses them to
build a keyboard description. However, before parsing the
expressions in <i>names,</i> the server ORs the bits in
<i>want</i> and <i>need</i> together and examines the result
in relationship to the expressions in <i>names.</i> Table 1
identifies the components that are required for each of the
possible bits in <i>want</i> or <i>need.</i> If a required
component has not been specified in the <i>names structure
(the corresponding field is NULL), the server substitutes
the</i> expression &quot;%&quot;, resulting in the component
values being taken from <i>device_spec.</i> In addition, if
<i>load</i> is True, the server modifies <i>names</i> if
necessary (again using a &quot;%&quot; entry) to ensure all
of the following fields are non-NULL: <i>types, keycodes,
symbols,</i> and <i>compat.</i></p>

<p style="margin-top: 1em"><i>need</i> specifies a set of
keyboard components that the server must be able to resolve
in order for <i>XkbGetKeyboardByName</i> to succeed; if any
of the components specified in <i>need</i> cannot be
successfully resolved, <i>XkbGetKeyboardByName</i>
fails.</p>

<p style="margin-top: 1em"><i>want</i> specifies a set of
keyboard components that the server should attempt to
resolve, but that are not mandatory. If the server is unable
to resolve any of these components,
<i>XkbGetKeyboardByName</i> still succeeds. Bits specified
in <i>want</i> that are also specified in <i>need</i> have
no effect in the context of <i>want.</i></p>

<p style="margin-top: 1em">If <i>load</i> is True, the
server updates its keyboard description for
<i>device_spec</i> to match the result of the keyboard
description just built. If load is False, the server&rsquo;s
description for device <i>device_spec</i> is not updated. In
all cases, the parts specified by <i>want</i> and
<i>need</i> from the just-built keyboard description are
returned.</p>

<p style="margin-top: 1em">The <i>names</i> structure in an
XkbDescRec keyboard description record contains one field
for each of the five component types used to build a
keyboard description. When a keyboard description is built
from a set of database components, the corresponding fields
in this <i>names</i> structure are set to match the
expressions used to build the component.</p>

<p style="margin-top: 1em">Building a New Keyboard
Description from the Server Database</p>

<p style="margin-top: 1em">The information returned to the
client in the XkbDescRec is essentially the result of a
series of calls to extract information from a fictitious
device whose description matches the one just built. The
calls corresponding to each of the mask bits are summarized
in Table 2, together with the XkbDescRec components that are
filled in.</p>

<p style="margin-top: 1em">There is no way to determine
which components specified in <i>want</i> (but not in
<i>need)</i> were actually fetched, other than breaking the
call into successive calls to <i>XkbGetKeyboardByName</i>
and specifying individual components.</p>

<p style="margin-top: 1em"><i>XkbGetKeyboardByName</i>
always sets <i>min_key_code</i> and <i>max_key_code</i> in
the returned XkbDescRec structure.</p>

<p style="margin-top: 1em"><i>XkbGetKeyboardByName</i> is
synchronous; it sends the request to the server to build a
new keyboard description and waits for the reply. If
successful, the return value is non-NULL.
<i>XkbGetKeyboardByName</i> generates a BadMatch protocol
error if errors are encountered when building the keyboard
description.</p>

<h2>STRUCTURES
<a name="STRUCTURES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The complete
description of an Xkb keyboard is given by an XkbDescRec.
The component structures in the XkbDescRec represent the
major Xkb components outlined in Figure 1.1.</p>

<p style="margin-left:11%; margin-top: 1em">typedef struct
{ <br>
struct _XDisplay * display; /&lowast; connection to X server
*/ <br>
unsigned short flags; /&lowast; private to Xkb, do not
modify */ <br>
unsigned short device_spec; /&lowast; device of interest */
<br>
KeyCode min_key_code; /&lowast; minimum keycode for device
*/ <br>
KeyCode max_key_code; /&lowast; maximum keycode for device
*/ <br>
XkbControlsPtr ctrls; /&lowast; controls */ <br>
XkbServerMapPtr server; /&lowast; server keymap */ <br>
XkbClientMapPtr map; /&lowast; client keymap */ <br>
XkbIndicatorPtr indicators; /&lowast; indicator map */ <br>
XkbNamesPtr names; /&lowast; names for all components */
<br>
XkbCompatMapPtr compat; /&lowast; compatibility map */ <br>
XkbGeometryPtr geom; /&lowast; physical geometry of keyboard
*/ <br>
} XkbDescRec, *XkbDescPtr;</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>display</i> field points to an X display structure. The
<i>flags field is private to the library: modifying
flags</i> may yield unpredictable results. The
<i>device_spec</i> field specifies the device identifier of
the keyboard input device, or XkbUseCoreKeyboard, which
specifies the core keyboard device. The <i>min_key_code</i>
and <i>max_key_code</i> fields specify the least and
greatest keycode that can be returned by the keyboard.</p>

<p style="margin-left:11%; margin-top: 1em">Each structure
component has a corresponding mask bit that is used in
function calls to indicate that the structure should be
manipulated in some manner, such as allocating it or freeing
it. These masks and their relationships to the fields in the
XkbDescRec are shown in Table 3.</p>

<h2>DIAGNOSTICS
<a name="DIAGNOSTICS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p style="margin-top: 1em"><b>BadMatch</b></p></td>
<td width="11%"></td>
<td width="66%">


<p style="margin-top: 1em">A compatible version of Xkb was
not available in the server or an argument has correct type
and range, but is otherwise invalid</p></td></tr>
</table>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>XkbListComponents</b>(3)</p>
<hr>
</body>
</html>
