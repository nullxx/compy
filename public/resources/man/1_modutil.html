<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 14:58:37 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>MODUTIL</title>

</head>
<body>

<h1 align="center">MODUTIL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#STATUS">STATUS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#USAGE AND EXAMPLES">USAGE AND EXAMPLES</a><br>
<a href="#JAR INSTALLATION FILE FORMAT">JAR INSTALLATION FILE FORMAT</a><br>
<a href="#NSS DATABASE TYPES">NSS DATABASE TYPES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#ADDITIONAL RESOURCES">ADDITIONAL RESOURCES</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">modutil &minus;
Manage PKCS #11 module information within the security
module database.</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="47%">


<p style="margin-top: 1em"><b>modutil</b> [<i>options</i>]
[[<i>arguments</i>]]</p> </td>
<td width="42%">
</td></tr>
</table>

<h2>STATUS
<a name="STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This
documentation is still work in progress. Please contribute
to the initial review in <b><font color="#0000FF">Mozilla
NSS bug 836477</font></b>
<small><font color="#000000">[1]</font></small></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
Security Module Database Tool, <b>modutil</b>, is a
command&minus;line utility for managing PKCS #11 module
information both within secmod.db files and within hardware
tokens. <b>modutil</b> can add and delete PKCS #11 modules,
change passwords on security databases, set defaults, list
module contents, enable or disable slots, enable or disable
FIPS 140&minus;2 compliance, and assign default providers
for cryptographic operations. This tool can also create
certificate, key, and module security database
files.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
tasks associated with security module database management
are part of a process that typically also involves managing
key databases and certificate databases.</font></p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Running
<b>modutil</b> always requires one (and only one) option to
specify the type of module operation. Each option may take
arguments, anywhere from none to multiple
arguments.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Options</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;add
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Add the
named PKCS #11 module to the database. Use this option with
the <b>&minus;libfile</b>, <b>&minus;ciphers</b>, and
<b>&minus;mechanisms</b> arguments.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;changepw
tokenname</font></p>

<p style="margin-left:17%;"><font color="#000000">Change
the password on the named token. If the token has not been
initialized, this option initializes the password. Use this
option with the <b>&minus;pwfile</b> and
<b>&minus;newpwfile</b> arguments. A <i>password</i> is
equivalent to a personal identification number
(PIN).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;chkfips</font></p>

<p style="margin-left:17%;"><font color="#000000">Verify
whether the module is in the given FIPS mode. <b>true</b>
means to verify that the module is in FIPS mode, while
<b>false</b> means to verify that the module is not in FIPS
mode.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;create</font></p>

<p style="margin-left:17%;"><font color="#000000">Create
new certificate, key, and module databases. Use the
<b>&minus;dbdir</b> directory argument to specify a
directory. If any of these databases already exist in a
specified directory, <b>modutil</b> returns an error
message.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;default
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the security mechanisms for which the named module will be a
default provider. The security mechanisms are specified with
the <b>&minus;mechanisms</b> argument.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;delete
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Delete
the named module. The default NSS PKCS #11 module cannot be
deleted.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;disable
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Disable
all slots on the named module. Use the <b>&minus;slot</b>
argument to disable a specific slot.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
internal NSS PKCS #11 module cannot be disabled.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;enable
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Enable
all slots on the named module. Use the <b>&minus;slot</b>
argument to enable a specific slot.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;fips
[true | false]</font></p>

<p style="margin-left:17%;"><font color="#000000">Enable
(true) or disable (false) FIPS 140&minus;2 compliance for
the default NSS module.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;force</font></p>

<p style="margin-left:17%;"><font color="#000000">Disable
<b>modutil</b>'s interactive prompts so it can be run from a
script. Use this option only after manually testing each
planned operation to check for warnings and to ensure that
bypassing the prompts will cause no security lapses or loss
of database integrity.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;jar
JAR&minus;file</font></p>

<p style="margin-left:17%;"><font color="#000000">Add a new
PKCS #11 module to the database using the named JAR file.
Use this command with the <b>&minus;installdir</b> and
<b>&minus;tempdir</b> arguments. The JAR file uses the NSS
PKCS #11 JAR format to identify all the files to be
installed, the module's name, the mechanism flags, and the
cipher flags, as well as any files to be installed on the
target machine, including the PKCS #11 module library file
and other files such as documentation. This is covered in
the JAR installation file section in the man page, which
details the special script needed to perform an installation
through a server or with <b>modutil</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;list
[modulename]</font></p>

<p style="margin-left:17%;"><font color="#000000">Display
basic information about the contents of the secmod.db file.
Specifying a <i>modulename</i> displays detailed information
about a particular module and its slots and
tokens.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;rawadd</font></p>

<p style="margin-left:17%;"><font color="#000000">Add the
module spec string to the secmod.db database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;rawlist</font></p>

<p style="margin-left:17%;"><font color="#000000">Display
the module specs for a specified module or for all loadable
modules.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;undefault
modulename</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the security mechanisms for which the named module will not
be a default provider. The security mechanisms are specified
with the <b>&minus;mechanisms</b> argument.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Arguments</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">MODULE</font></p>

<p style="margin-left:17%;"><font color="#000000">Give the
security module to access.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">MODULESPEC</font></p>

<p style="margin-left:17%;"><font color="#000000">Give the
security module spec to load into the security
database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;ciphers
cipher&minus;enable&minus;list</font></p>

<p style="margin-left:17%;"><font color="#000000">Enable
specific ciphers in a module that is being added to the
database. The <i>cipher&minus;enable&minus;list</i> is a
colon&minus;delimited list of cipher names. Enclose this
list in quotation marks if it contains spaces.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;dbdir
[sql:]directory</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the database directory in which to access or create security
module database files.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>modutil</b>
supports two types of databases: the legacy security
databases (cert8.db, key3.db, and secmod.db) and new SQLite
databases (cert9.db, key4.db, and pkcs11.txt). If the prefix
<b>sql:</b> is not used, then the tool assumes that the
given databases are in the old format.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;&minus;dbprefix
prefix</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the prefix used on the database files, such as my_ for
my_cert8.db. This option is provided as a special case.
Changing the names of the certificate and key databases is
not recommended.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;installdir
root&minus;installation&minus;directory</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the root installation directory relative to which files will
be installed by the <b>&minus;jar</b> option. This directory
should be one below which it is appropriate to store dynamic
library files, such as a server's root directory.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;libfile
library&minus;file</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify a
path to a library file containing the implementation of the
PKCS #11 interface module that is being added to the
database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;mechanisms
mechanism&minus;list</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the security mechanisms for which a particular module will
be flagged as a default provider. The
<i>mechanism&minus;list</i> is a colon&minus;delimited list
of mechanism names. Enclose this list in quotation marks if
it contains spaces.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">The
module becomes a default provider for the listed mechanisms
when those mechanisms are enabled. If more than one module
claims to be a particular mechanism's default provider, that
mechanism's default provider is undefined.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>modutil</b>
supports several mechanisms: RSA, DSA, RC2, RC4, RC5, AES,
DES, DH, SHA1, SHA256, SHA512, SSL, TLS, MD5, MD2, RANDOM
(for random number generation), and FRIENDLY (meaning
certificates are publicly readable).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;newpwfile
new&minus;password&minus;file</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify a
text file containing a token's new or replacement password
so that a password can be entered automatically with the
<b>&minus;changepw</b> option.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;nocertdb</font></p>

<p style="margin-left:17%;"><font color="#000000">Do not
open the certificate or key databases. This has several
effects:</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
With the <b>&minus;create</b> command, only a module
security file is created; certificate and key databases are
not created.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
With the <b>&minus;jar</b> command, signatures on the JAR
file are not checked.</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
With the <b>&minus;changepw</b> command, the password on the
NSS internal module cannot be set or changed, since this
password is stored in the key database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;pwfile
old&minus;password&minus;file</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify a
text file containing a token's existing password so that a
password can be entered automatically when the
<b>&minus;changepw</b> option is used to change
passwords.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;secmod
secmodname</font></p>

<p style="margin-left:17%;"><font color="#000000">Give the
name of the security module database (like secmod.db) to
load.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;slot
slotname</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify a
particular slot to be enabled or disabled with the
<b>&minus;enable</b> or <b>&minus;disable</b>
options.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;string
CONFIG_STRING</font></p>

<p style="margin-left:17%;"><font color="#000000">Pass a
configuration string for the module being added to the
database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;tempdir
temporary&minus;directory</font></p>

<p style="margin-left:17%;"><font color="#000000">Give a
directory location where temporary files are created during
the installation by the <b>&minus;jar</b> option. If no
temporary directory is specified, the current directory is
used.</font></p>

<h2>USAGE AND EXAMPLES
<a name="USAGE AND EXAMPLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Creating
Database Files</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Before
any operations can be performed, there must be a set of
security databases available. <b>modutil</b> can be used to
create these files. The only required argument is the
database that where the databases will be
located.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;create &minus;dbdir [sql:]directory</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Adding
a Cryptographic Module</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Adding
a PKCS #11 module means submitting a supporting library
file, enabling its ciphers, and setting default provider
status for various security mechanisms. This can be done by
supplying all of the information through <b>modutil</b>
directly or by running a JAR file and install script. For
the most basic case, simply upload the library:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;add modulename &minus;libfile library&minus;file
[&minus;ciphers cipher&minus;enable&minus;list]
[&minus;mechanisms mechanism&minus;list]</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;dbdir sql:/home/my/sharednssdb &minus;add
&quot;Example PKCS #11 Module&quot; &minus;libfile
&quot;/tmp/crypto.so&quot; &minus;mechanisms
RSA:DSA:RC2:RANDOM</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Using
database directory ... <br>
Module &quot;Example PKCS #11 Module&quot; added to
database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Installing
a Cryptographic Module from a JAR File</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">PKCS
#11 modules can also be loaded using a JAR file, which
contains all of the required libraries and an installation
script that describes how to install the module. The JAR
install script is described in more detail in the section
called &ldquo;JAR INSTALLATION FILE
FORMAT&rdquo;.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
JAR installation script defines the setup information for
each platform that the module can be installed on. For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Platforms
{ <br>
Linux:5.4.08:x86 { <br>
ModuleName { &quot;Example PKCS #11 Module&quot; } <br>
ModuleFile { crypto.so } <br>
DefaultMechanismFlags{0x0000} <br>
CipherEnableFlags{0x0000} <br>
Files { <br>
crypto.so { <br>
Path{ /tmp/crypto.so } <br>
} <br>
setup.sh { <br>
Executable <br>
Path{ /tmp/setup.sh } <br>
} <br>
} <br>
} <br>
Linux:6.0.0:x86 { <br>
EquivalentPlatform { Linux:5.4.08:x86 } <br>
} <br>
}</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Both
the install script and the required libraries must be
bundled in a JAR file, which is specified with the
<b>&minus;jar</b> argument.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;dbdir
sql:/home/mt&quot;jar&minus;install&minus;filey/sharednssdb
&minus;jar install.jar &minus;installdir
sql:/home/my/sharednssdb</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">This
installation JAR file was signed by: <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">**SUBJECT
NAME**</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">C=US,
ST=California, L=Mountain View, CN=Cryptorific Inc.,
OU=Digital ID <br>
Class 3 &minus; Netscape Object Signing,
OU=&quot;www.verisign.com/repository/CPS <br>
Incorp. by Ref.,LIAB.LTD(c)9 6&quot;,
OU=www.verisign.com/CPS Incorp.by Ref <br>
. LIABILITY LTD.(c)97 VeriSign, OU=VeriSign Object Signing
CA &minus; Class 3 <br>
Organization, OU=&quot;VeriSign, Inc.&quot;, O=VeriSign
Trust Network **ISSUER <br>
NAME**, OU=www.verisign.com/CPS Incorp.by Ref. LIABILITY
LTD.(c)97 <br>
VeriSign, OU=VeriSign Object Signing CA &minus; Class 3
Organization, <br>
OU=&quot;VeriSign, Inc.&quot;, O=VeriSign Trust Network <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Do
you wish to continue this installation? (y/n) y <br>
Using installer script &quot;installer_script&quot; <br>
Successfully parsed installation script <br>
Current platform is Linux:5.4.08:x86 <br>
Using installation parameters for platform Linux:5.4.08:x86
<br>
Installed file crypto.so to /tmp/crypto.so <br>
Installed file setup.sh to ./pk11inst.dir/setup.sh <br>
Executing &quot;./pk11inst.dir/setup.sh&quot;... <br>
&quot;./pk11inst.dir/setup.sh&quot; executed successfully
<br>
Installed module &quot;Example PKCS #11 Module&quot; into
module database</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Installation
completed successfully</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Adding
Module Spec</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Each
module has information stored in the security database about
its configuration and parameters. These can be added or
edited using the <b>&minus;rawadd</b> command. For the
current settings or to see the format of the module spec in
the database, use the <b>&minus;rawlist</b>
option.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;rawadd modulespec</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Deleting
a Module</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">A
specific PKCS #11 module can be deleted from the secmod.db
database:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;delete modulename &minus;dbdir
[sql:]directory</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Displaying
Module Information</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
secmod.db database contains information about the PKCS #11
modules that are available to an application or server to
use. The list of all modules, information about specific
modules, and database configuration specs for modules can
all be viewed.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">To
simply get a list of modules in the database, use the
<b>&minus;list</b> command.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;list [modulename] &minus;dbdir
[sql:]directory</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Listing
the modules shows the module name, their status, and other
associated security databases for certificates and keys. For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;list &minus;dbdir sql:/home/my/sharednssdb</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Listing
of PKCS #11 Modules <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
1. NSS Internal PKCS #11 Module <br>
slots: 2 slots attached <br>
status: loaded</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">slot:
NSS Internal Cryptographic Services <br>
token: NSS Generic Crypto Services</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">slot:
NSS User Private Key and Certificate Services <br>
token: NSS Certificate DB <br>

&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Passing
a specific module name with the <b>&minus;list</b> returns
details information about the module itself, like supported
cipher mechanisms, version numbers, serial numbers, and
other information about the module and the token it is
loaded on. For example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;list &quot;NSS Internal PKCS #11 Module&quot;
&minus;dbdir sql:/home/my/sharednssdb</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;&minus;
<br>
Name: NSS Internal PKCS #11 Module <br>
Library file: **Internal ONLY module** <br>
Manufacturer: Mozilla Foundation <br>
Description: NSS Internal Crypto Services <br>
PKCS #11 Version 2.20 <br>
Library Version: 3.11 <br>
Cipher Enable Flags: None <br>
Default Mechanism Flags:
RSA:RC2:RC4:DES:DH:SHA1:MD5:MD2:SSL:TLS:AES</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Slot:
NSS Internal Cryptographic Services <br>
Slot Mechanism Flags:
RSA:RC2:RC4:DES:DH:SHA1:MD5:MD2:SSL:TLS:AES <br>
Manufacturer: Mozilla Foundation <br>
Type: Software <br>
Version Number: 3.11 <br>
Firmware Version: 0.0 <br>
Status: Enabled <br>
Token Name: NSS Generic Crypto Services <br>
Token Manufacturer: Mozilla Foundation <br>
Token Model: NSS 3 <br>
Token Serial Number: 0000000000000000 <br>
Token Version: 4.0 <br>
Token Firmware Version: 0.0 <br>
Access: Write Protected <br>
Login Type: Public (no login required) <br>
User Pin: NOT Initialized</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Slot:
NSS User Private Key and Certificate Services <br>
Slot Mechanism Flags: None <br>
Manufacturer: Mozilla Foundation <br>
Type: Software <br>
Version Number: 3.11 <br>
Firmware Version: 0.0 <br>
Status: Enabled <br>
Token Name: NSS Certificate DB <br>
Token Manufacturer: Mozilla Foundation <br>
Token Model: NSS 3 <br>
Token Serial Number: 0000000000000000 <br>
Token Version: 8.3 <br>
Token Firmware Version: 0.0 <br>
Access: NOT Write Protected <br>
Login Type: Login required <br>
User Pin: Initialized</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">A
related command, <b>&minus;rawlist</b> returns information
about the database configuration for the modules. (This
information can be edited by loading new specs using the
<b>&minus;rawadd</b> command.)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;rawlist &minus;dbdir sql:/home/my/sharednssdb <br>
name=&quot;NSS Internal PKCS #11 Module&quot;
parameters=&quot;configdir=. certPrefix= keyPrefix=
secmod=secmod.db flags=readOnly &quot;
NSS=&quot;trustOrder=75 cipherOrder=100
slotParams={0x00000001=[slotFlags=RSA,RC4,RC2,DES,DH,SHA1,MD5,MD2,SSL,TLS,AES,RANDOM
askpw=any timeout=30 ] }
Flags=internal,critical&quot;</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Setting
a Default Provider for Security Mechanisms</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Multiple
security modules may provide support for the same security
mechanisms. It is possible to set a specific security module
as the default provider for a specific security mechanism
(or, conversely, to prohibit a provider from supplying those
mechanisms).</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;default modulename &minus;mechanisms
mechanism&minus;list</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">To
set a module as the default provider for mechanisms, use the
<b>&minus;default</b> command with a colon&minus;separated
list of mechanisms. The available mechanisms depend on the
module; NSS supplies almost all common mechanisms. For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;default &quot;NSS Internal PKCS #11 Module&quot;
&minus;dbdir &minus;mechanisms RSA:DSA:RC2</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Using
database directory c:\databases...</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Successfully
changed defaults.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Clearing
the default provider has the same format:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;undefault &quot;NSS Internal PKCS #11 Module&quot;
&minus;dbdir &minus;mechanisms MD2:MD5</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Enabling
and Disabling Modules and Slots</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Modules,
and specific slots on modules, can be selectively enabled or
disabled using <b>modutil</b>. Both commands have the same
format:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;enable|&minus;disable modulename [&minus;slot
slotname]</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;enable &quot;NSS Internal PKCS #11 Module&quot;
&minus;slot &quot;NSS Internal Cryptographic Services &quot;
&minus;dbdir .</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Slot
&quot;NSS Internal Cryptographic Services &quot;
enabled.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Be
sure that the appropriate amount of trailing whitespace is
after the slot name. Some slot names have a significant
amount of whitespace that must be included, or the operation
will fail.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Enabling
and Verifying FIPS Compliance</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
NSS modules can have FIPS 140&minus;2 compliance enabled or
disabled using <b>modutil</b> with the <b>&minus;fips</b>
option. For example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;fips true &minus;dbdir
sql:/home/my/sharednssdb/</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">FIPS
mode enabled.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">To
verify that status of FIPS mode, run the
<b>&minus;chkfips</b> command with either a true or false
flag (it doesn't matter which). The tool returns the current
FIPS setting.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;chkfips false &minus;dbdir
sql:/home/my/sharednssdb/</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">FIPS
mode enabled.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Changing
the Password on a Token</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Initializing
or changing a token's password:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;changepw tokenname [&minus;pwfile
old&minus;password&minus;file] [&minus;newpwfile
new&minus;password&minus;file]</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;dbdir sql:/home/my/sharednssdb &minus;changepw
&quot;NSS Certificate DB&quot;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Enter
old password: <br>
Incorrect password, try again... <br>
Enter old password: <br>
Enter new password: <br>
Re&minus;enter new password: <br>
Token &quot;Communicator Certificate DB&quot; password
changed successfully.</font></p>

<h2>JAR INSTALLATION FILE FORMAT
<a name="JAR INSTALLATION FILE FORMAT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">When
a JAR file is run by a server, by <b>modutil</b>, or by any
program that does not interpret JavaScript, a special
information file must be included to install the libraries.
There are several things to keep in mind with this
file:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
It must be declared in the JAR archive's manifest
file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
The script can have any name.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
The metainfo tag for this is <b>Pkcs11_install_script</b>.
To declare meta&minus;information in the manifest file, put
it in a file that is passed to <b>signtool</b>.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Sample
Script</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example, the PKCS #11 installer script could be in the file
pk11install. If so, the metainfo file for <b>signtool</b>
includes a line such as this:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">+
Pkcs11_install_script: pk11install</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
script must define the platform and version number, the
module name and file, and any optional information like
supported ciphers and mechanisms. Multiple platforms can be
defined in a single install file.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">ForwardCompatible
{ IRIX:6.2:mips SUNOS:5.5.1:sparc } <br>
Platforms { <br>
WINNT::x86 { <br>
ModuleName { &quot;Example Module&quot; } <br>
ModuleFile { win32/fort32.dll } <br>
DefaultMechanismFlags{0x0001} <br>
DefaultCipherFlags{0x0001} <br>
Files { <br>
win32/setup.exe { <br>
Executable <br>
RelativePath { %temp%/setup.exe } <br>
} <br>
win32/setup.hlp { <br>
RelativePath { %temp%/setup.hlp } <br>
} <br>
win32/setup.cab { <br>
RelativePath { %temp%/setup.cab } <br>
} <br>
} <br>
} <br>
WIN95::x86 { <br>
EquivalentPlatform {WINNT::x86} <br>
} <br>
SUNOS:5.5.1:sparc { <br>
ModuleName { &quot;Example UNIX Module&quot; } <br>
ModuleFile { unix/fort.so } <br>
DefaultMechanismFlags{0x0001} <br>
CipherEnableFlags{0x0001} <br>
Files { <br>
unix/fort.so { <br>
RelativePath{%root%/lib/fort.so} <br>
AbsolutePath{/usr/local/netscape/lib/fort.so} <br>
FilePermissions{555} <br>
} <br>
xplat/instr.html { <br>
RelativePath{%root%/docs/inst.html} <br>
AbsolutePath{/usr/local/netscape/docs/inst.html} <br>
FilePermissions{555} <br>
} <br>
} <br>
} <br>
IRIX:6.2:mips { <br>
EquivalentPlatform { SUNOS:5.5.1:sparc } <br>
} <br>
}</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Script
Grammar</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
script is basic Java, allowing lists, key&minus;value pairs,
strings, and combinations of all of them.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&minus;&minus;&gt;
valuelist</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">valuelist
&minus;&minus;&gt; value valuelist <br>
&lt;null&gt;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">value
&minus;&minus;&minus;&gt; key_value_pair <br>
string</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">key_value_pair
&minus;&minus;&gt; key { valuelist }</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">key
&minus;&minus;&gt; string</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">string
&minus;&minus;&gt; simple_string <br>
&quot;complex_string&quot;</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">simple_string
&minus;&minus;&gt; [^
\t\n\&quot;&quot;{&quot;&quot;}&quot;]+</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">complex_string
&minus;&minus;&gt;
([^\&quot;\\\r\n]|(\\\&quot;)|(\\\\))+</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Quotes
and backslashes must be escaped with a backslash. A complex
string must not include newlines or carriage returns.Outside
of complex strings, all white space (for example, spaces,
tabs, and carriage returns) is considered equal and is used
only to delimit tokens.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Keys</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
Java install file uses keys to define the platform and
module information.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ForwardCompatible</b>
gives a list of platforms that are forward compatible. If
the current platform cannot be found in the list of
supported platforms, then the <b>ForwardCompatible</b> list
is checked for any platforms that have the same OS and
architecture in an earlier version. If one is found, its
attributes are used for the current platform.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Platforms</b>
(required) Gives a list of platforms. Each entry in the list
is itself a key&minus;value pair: the key is the name of the
platform and the value list contains various attributes of
the platform. The platform string is in the format <i>system
name:OS release:architecture</i>. The installer obtains
these values from NSPR. OS release is an empty string on
non&minus;Unix operating systems. NSPR supports these
platforms:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
AIX (rs6000)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
BSDI (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
FREEBSD (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
HPUX (hppa1.1)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
IRIX (mips)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
LINUX (ppc, alpha, x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
MacOS (PowerPC)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
NCR (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
NEC (mips)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
OS2 (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
OSF (alpha)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
ReliantUNIX (mips)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
SCO (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
SOLARIS (sparc)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
SONY (mips)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
SUNOS (sparc)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
UnixWare (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
WIN16 (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
WIN95 (x86)</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
WINNT (x86)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">IRIX:6.2:mips
<br>
SUNOS:5.5.1:sparc <br>
Linux:2.0.32:x86 <br>
WIN95::x86</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
module information is defined independently for each
platform in the <b>ModuleName</b>, <b>ModuleFile</b>, and
<b>Files</b> attributes. These attributes must be given
unless an <b>EquivalentPlatform</b> attribute is
specified.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Per&minus;Platform
Keys</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Per&minus;platform
keys have meaning only within the value list of an entry in
the <b>Platforms</b> list.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ModuleName</b>
(required) gives the common name for the module. This name
is used to reference the module by servers and by the
<b>modutil</b> tool.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>ModuleFile</b>
(required) names the PKCS #11 module file for this platform.
The name is given as the relative path of the file within
the JAR archive.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Files</b>
(required) lists the files that need to be installed for
this module. Each entry in the file list is a
key&minus;value pair. The key is the path of the file in the
JAR archive, and the value list contains attributes of the
file. At least <b>RelativePath</b> or <b>AbsolutePath</b>
must be specified for each file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>DefaultMechanismFlags</b>
specifies mechanisms for which this module is the default
provider; this is equivalent to the <b>&minus;mechanism</b>
option with the <b>&minus;add</b> command. This
key&minus;value pair is a bitstring specified in hexadecimal
(0x) format. It is constructed as a bitwise OR. If the
DefaultMechanismFlags entry is omitted, the value defaults
to 0x0.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">RSA:
0x00000001 <br>
DSA: 0x00000002 <br>
RC2: 0x00000004 <br>
RC4: 0x00000008 <br>
DES: 0x00000010 <br>
DH: 0x00000020 <br>
FORTEZZA: 0x00000040 <br>
RC5: 0x00000080 <br>
SHA1: 0x00000100 <br>
MD5: 0x00000200 <br>
MD2: 0x00000400 <br>
RANDOM: 0x08000000 <br>
FRIENDLY: 0x10000000 <br>
OWN_PW_DEFAULTS: 0x20000000 <br>
DISABLE: 0x40000000</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>CipherEnableFlags</b>
specifies ciphers that this module provides that NSS does
not provide (so that the module enables those ciphers for
NSS). This is equivalent to the <b>&minus;cipher</b>
argument with the <b>&minus;add</b> command. This key is a
bitstring specified in hexadecimal (0x) format. It is
constructed as a bitwise OR. If the <b>CipherEnableFlags</b>
entry is omitted, the value defaults to 0x0.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>EquivalentPlatform</b>
specifies that the attributes of the named platform should
also be used for the current platform. This makes it easier
when more than one platform uses the same
settings.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Per&minus;File
Keys</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Some
keys have meaning only within the value list of an entry in
a <b>Files</b> list.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Each
file requires a path key the identifies where the file is.
Either <b>RelativePath</b> or <b>AbsolutePath</b> must be
specified. If both are specified, the relative path is tried
first, and the absolute path is used only if no relative
root directory is provided by the installer
program.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>RelativePath</b>
specifies the destination directory of the file, relative to
some directory decided at install time. Two variables can be
used in the relative path: <b>%root%</b> and <b>%temp%</b>.
<b>%root%</b> is replaced at run time with the directory
relative to which files should be installed; for example, it
may be the server's root directory. The <b>%temp%</b>
directory is created at the beginning of the installation
and destroyed at the end. The purpose of <b>%temp%</b> is to
hold executable files (such as setup programs) or files that
are used by these programs. Files destined for the temporary
directory are guaranteed to be in place before any
executable file is run; they are not deleted until all
executable files have finished.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>AbsolutePath</b>
specifies the destination directory of the file as an
absolute path.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Executable</b>
specifies that the file is to be executed during the course
of the installation. Typically, this string is used for a
setup program provided by a module vendor, such as a
self&minus;extracting setup executable. More than one file
can be specified as executable, in which case the files are
run in the order in which they are specified in the script
file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>FilePermissions</b>
sets permissions on any referenced files in a string of
octal digits, according to the standard Unix format. This
string is a bitwise OR.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">user
read: 0400 <br>
user write: 0200 <br>
user execute: 0100 <br>
group read: 0040 <br>
group write: 0020 <br>
group execute: 0010 <br>
other read: 0004 <br>
other write: 0002 <br>
other execute: 0001</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Some
platforms may not understand these permissions. They are
applied only insofar as they make sense for the current
platform. If this attribute is omitted, a default of 777 is
assumed.</font></p>

<h2>NSS DATABASE TYPES
<a name="NSS DATABASE TYPES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">NSS
originally used BerkeleyDB databases to store security
information. The last versions of these <i>legacy</i>
databases are:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
cert8.db for certificates</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
key3.db for keys</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
secmod.db for PKCS #11 module information</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">BerkeleyDB
has performance limitations, though, which prevent it from
being easily used by multiple applications simultaneously.
NSS has some flexibility that allows applications to use
their own, independent database engine while keeping a
shared database and working around the access issues. Still,
NSS requires more flexibility to provide a truly shared
security database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
2009, NSS introduced a new set of databases that are SQLite
databases rather than BerkleyDB. These new databases provide
more accessibility and performance:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
cert9.db for certificates</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
key4.db for keys</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
pkcs11.txt, which is listing of all of the PKCS #11 modules
contained in a new subdirectory in the security databases
directory</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Because
the SQLite databases are designed to be shared, these are
the <i>shared</i> database type. The shared database type is
preferred; the legacy format is included for backward
compatibility.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">By
default, the tools (<b>certutil</b>, <b>pk12util</b>,
<b>modutil</b>) assume that the given security databases
follow the more common legacy type. Using the SQLite
databases must be manually specified by using the
<b>sql:</b> prefix with the given security directory. For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">modutil
&minus;create &minus;dbdir
sql:/home/my/sharednssdb</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">To
set the shared database type as the default type for the
tools, set the <b>NSS_DEFAULT_DB_TYPE</b> environment
variable to <b>sql</b>:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">export
NSS_DEFAULT_DB_TYPE=&quot;sql&quot;</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">This
line can be added to the ~/.bashrc file to make the change
permanent for the user.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Most
applications do not use the shared database by default, but
they can be configured to use them. For example, this
how&minus;to article covers how to configure Firefox and
Thunderbird to use the new shared NSS databases:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
an engineering draft on the changes in the shared NSS
databases, see the NSS project wiki:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">certutil
(1)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pk12util
(1)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">signtool
(1)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
NSS wiki has information on the new database design and how
to configure applications to use it.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>ADDITIONAL RESOURCES
<a name="ADDITIONAL RESOURCES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
information about NSS and other tools related to NSS (like
JSS), check out the NSS project wiki at</font>
<b><font color="#0000FF">http://www.mozilla.org/projects/security/pki/nss/</font></b><font color="#000000">.
The NSS site relates directly to NSS code changes and
releases.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Mailing
lists:
https://lists.mozilla.org/listinfo/dev&minus;tech&minus;crypto</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">IRC:
Freenode at #dogtag&minus;pki</font></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
NSS tools were written and maintained by developers with
Netscape, Red Hat, Sun, Oracle, Mozilla, and
Google.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Authors:
Elio Maldonado &lt;emaldona@redhat.com&gt;, Deon Lackey
&lt;dlackey@redhat.com&gt;.</font></p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Licensed
under the Mozilla Public License, v. 2.0. If a copy of the
MPL was not distributed with this file, You can obtain one
at http://mozilla.org/MPL/2.0/.</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="34%">


<p style="margin-top: 1em"><font color="#000000">Mozilla
NSS bug 836477</font></p></td>
<td width="49%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://bugzilla.mozilla.org/show_bug.cgi?id=836477</font></p>
<hr>
</body>
</html>
