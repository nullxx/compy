<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:20:10 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>X509_VERIFY_PARAM_set_flags</title>

</head>
<body>

<h1 align="center">X509_VERIFY_PARAM_set_flags</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUES">RETURN VALUES</a><br>
<a href="#VERIFICATION FLAGS">VERIFICATION FLAGS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#HISTORY">HISTORY</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">X509_VERIFY_PARAM_set_flags,
X509_VERIFY_PARAM_clear_flags, X509_VERIFY_PARAM_get_flags,
X509_VERIFY_PARAM_set_purpose, X509_VERIFY_PARAM_set_trust,
X509_VERIFY_PARAM_set_depth, X509_VERIFY_PARAM_get_depth,
X509_VERIFY_PARAM_set_time, X509_VERIFY_PARAM_add0_policy,
X509_VERIFY_PARAM_set1_policies &minus; X509 verification
parameters</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<pre style="margin-left:11%; margin-top: 1em"> #include &lt;openssl/x509_vfy.h&gt;
 int X509_VERIFY_PARAM_set_flags(X509_VERIFY_PARAM *param, unsigned long flags);
 int X509_VERIFY_PARAM_clear_flags(X509_VERIFY_PARAM *param,
                                                        unsigned long flags);
 unsigned long X509_VERIFY_PARAM_get_flags(X509_VERIFY_PARAM *param);
 int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose);
 int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust);
 void X509_VERIFY_PARAM_set_time(X509_VERIFY_PARAM *param, time_t t);
 int X509_VERIFY_PARAM_add0_policy(X509_VERIFY_PARAM *param,
                                                ASN1_OBJECT *policy);
 int X509_VERIFY_PARAM_set1_policies(X509_VERIFY_PARAM *param,
                                        STACK_OF(ASN1_OBJECT) *policies);
 void X509_VERIFY_PARAM_set_depth(X509_VERIFY_PARAM *param, int depth);
 int X509_VERIFY_PARAM_get_depth(const X509_VERIFY_PARAM *param);</pre>


<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These functions
manipulate the <b>X509_VERIFY_PARAM</b> structure associated
with a certificate verification operation.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>X509_VERIFY_PARAM_set_flags()</i> function sets the flags
in <b>param</b> by oring it with <b>flags</b>. See the
<b><small>VERIFICATION FLAGS</small></b> section for a
complete description of values the <b>flags</b> parameter
can take.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_get_flags()</i>
returns the flags in <b>param</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_clear_flags()</i>
clears the flags <b>flags</b> in <b>param</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_purpose()</i>
sets the verification purpose in <b>param</b> to
<b>purpose</b>. This determines the acceptable purpose of
the certificate chain, for example <small>SSL</small> client
or <small>SSL</small> server.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_trust()</i>
sets the trust setting in <b>param</b> to <b>trust</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_time()</i>
sets the verification time in <b>param</b> to <b>t</b>.
Normally the current time is used.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_add0_policy()</i>
enables policy checking (it is disabled by default) and adds
<b>policy</b> to the acceptable policy set.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set1_policies()</i>
enables policy checking (it is disabled by default) and sets
the acceptable policy set to <b>policies</b>. Any existing
policy set is cleared. The <b>policies</b> parameter can be
<b><small>NULL</small></b> to clear an existing policy
set.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_depth()</i>
sets the maximum verification depth to <b>depth</b>. That is
the maximum number of untrusted <small>CA</small>
certificates that can appear in a chain.</p>

<h2>RETURN VALUES
<a name="RETURN VALUES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_flags()</i>,
<i>X509_VERIFY_PARAM_clear_flags()</i>,
<i>X509_VERIFY_PARAM_set_purpose()</i>,
<i>X509_VERIFY_PARAM_set_trust()</i>,
<i>X509_VERIFY_PARAM_add0_policy()</i> and
<i>X509_VERIFY_PARAM_set1_policies()</i> return 1 for
success and 0 for failure.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_get_flags()</i>
returns the current verification flags.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_set_time()</i>
and <i>X509_VERIFY_PARAM_set_depth()</i> do not return
values.</p>


<p style="margin-left:11%; margin-top: 1em"><i>X509_VERIFY_PARAM_get_depth()</i>
returns the current verification depth.</p>

<h2>VERIFICATION FLAGS
<a name="VERIFICATION FLAGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
verification flags consists of zero or more of the following
flags ored together.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_CRL_CHECK</b>
enables <small>CRL</small> checking for the certificate
chain leaf certificate. An error occurs if a suitable
<small>CRL</small> cannot be found.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_CRL_CHECK_ALL</b>
enables <small>CRL</small> checking for the entire
certificate chain.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_IGNORE_CRITICAL</b>
disabled critical extension checking. By default any
unhandled critical extensions in certificates or (if
checked) CRLs results in a fatal error. If this flag is set
unhandled critical extensions are ignored.
<b><small>WARNING</small></b> setting this option for
anything other than debugging purposes can be a security
risk. Finer control over which extensions are supported can
be performed in the verification callback.</p>

<p style="margin-left:11%; margin-top: 1em">THe
<b>X509_V_FLAG_X509_STRICT</b> flag disables workarounds for
some broken certificates and makes the verification strictly
apply <b>X509</b> rules.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_ALLOW_PROXY_CERTS</b>
enables proxy certificate verification.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_POLICY_CHECK</b>
enables certificate policy checking, by default no policy
checking is peformed. Additional information is sent to the
verification callback relating to policy checking.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_EXPLICIT_POLICY</b>,
<b>X509_V_FLAG_INHIBIT_ANY</b> and
<b>X509_V_FLAG_INHIBIT_MAP</b> set the <b>require explicit
policy</b>, <b>inhibit any policy</b> and <b>inhibit policy
mapping</b> flags respectively as defined in
<b><small>RFC3280</small></b> . Policy checking is
automatically enabled if any of these flags are set.</p>

<p style="margin-left:11%; margin-top: 1em">If
<b>X509_V_FLAG_NOTIFY_POLICY</b> is set and the policy
checking is successful a special status code is set to the
verification callback. This permits it to examine the valid
policy tree and perform additional checks or simply log it
for debugging purposes.</p>

<p style="margin-left:11%; margin-top: 1em">By default some
addtional features such as indirect CRLs and CRLs signed by
different keys are disabled. If
<b>X509_V_FLAG_EXTENDED_CRL_SUPPORT</b> is set they are
enabled.</p>

<p style="margin-left:11%; margin-top: 1em">If
<b>X509_V_FLAG_USE_DELTAS</b> ise set delta CRLs (if
present) are used to determine certificate status. If not
set deltas are ignored.</p>


<p style="margin-left:11%; margin-top: 1em"><b>X509_V_FLAG_CHECK_SS_SIGNATURE</b>
enables checking of the root <small>CA</small> self signed
cerificate signature. By default this check is disabled
because it doesn&rsquo;t add any additional security but in
some cases applications might want to check the signature
anyway. A side effect of not checking the root
<small>CA</small> signature is that disabled or unsupported
message digests on the root <small>CA</small> are not
treated as fatal errors.</p>

<p style="margin-left:11%; margin-top: 1em">The
<b>X509_V_FLAG_CB_ISSUER_CHECK</b> flag enables debugging of
certificate issuer checks. It is <b>not</b> needed unless
you are logging certificate verification. If this flag is
set then additional status codes will be sent to the
verification callback and it <b>must</b> be prepared to
handle such cases without assuming they are hard errors.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The above
functions should be used to manipulate verification
parameters instead of legacy functions which work in
specific structures such as
<i>X509_STORE_CTX_set_flags()</i>.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Delta
<small>CRL</small> checking is currently primitive. Only a
single delta can be used and (partly due to limitations of
<b>X509_STORE</b>) constructed CRLs are not maintained.</p>

<p style="margin-left:11%; margin-top: 1em">If CRLs
checking is enable CRLs are expected to be available in the
corresponding <b>X509_STORE</b> structure. No attempt is
made to download CRLs from the <small>CRL</small>
distribution points extension.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Enable
<small>CRL</small> checking when performing certificate
verification during <small>SSL</small> connections
associated with an <b><small>SSL_CTX</small></b> structure
<b>ctx</b>:</p>

<pre style="margin-left:11%; margin-top: 1em">  X509_VERIFY_PARAM *param;
  param = X509_VERIFY_PARAM_new();
  X509_VERIFY_PARAM_set_flags(param, X509_V_FLAG_CRL_CHECK);
  SSL_CTX_set1_param(ctx, param);
  X509_VERIFY_PARAM_free(param);</pre>


<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>X509_verify_cert</i>(3)</p>

<h2>HISTORY
<a name="HISTORY"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><small>TBA</small></p>
<hr>
</body>
</html>
