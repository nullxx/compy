<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 14:59:43 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>PK12UTIL</title>

</head>
<body>

<h1 align="center">PK12UTIL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#STATUS">STATUS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS AND ARGUMENTS">OPTIONS AND ARGUMENTS</a><br>
<a href="#RETURN CODES">RETURN CODES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#PASSWORD ENCRYPTION">PASSWORD ENCRYPTION</a><br>
<a href="#NSS DATABASE TYPES">NSS DATABASE TYPES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#ADDITIONAL RESOURCES">ADDITIONAL RESOURCES</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#LICENSE">LICENSE</a><br>
<a href="#NOTES">NOTES</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">pk12util
&minus; Export and import keys and certificate to or from a
PKCS #12 file and the NSS database</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>pk12util</b>
[&minus;i&nbsp;p12File|&minus;l&nbsp;p12File|&minus;o&nbsp;p12File]
[&minus;d&nbsp;[sql:]directory] [&minus;h&nbsp;tokenname]
[&minus;P&nbsp;dbprefix] [&minus;r] [&minus;v]
[&minus;k&nbsp;slotPasswordFile|&minus;K&nbsp;slotPassword]
[&minus;w&nbsp;p12filePasswordFile|&minus;W&nbsp;p12filePassword]</p> </td></tr>
</table>

<h2>STATUS
<a name="STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This
documentation is still work in progress. Please contribute
to the initial review in <b><font color="#0000FF">Mozilla
NSS bug 836477</font></b>
<small><font color="#000000">[1]</font></small></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
PKCS #12 utility, <b>pk12util</b>, enables sharing
certificates among any server that supports PKCS#12. The
tool can import certificates and keys from PKCS#12 files
into security databases, export certificates, and list
certificates and keys.</font></p>

<h2>OPTIONS AND ARGUMENTS
<a name="OPTIONS AND ARGUMENTS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Options</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;i
p12file</font></p>

<p style="margin-left:17%;"><font color="#000000">Import
keys and certificates from a PKCS#12 file into a security
database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;l
p12file</font></p>

<p style="margin-left:17%;"><font color="#000000">List the
keys and certificates in PKCS#12 file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;o
p12file</font></p>

<p style="margin-left:17%;"><font color="#000000">Export
keys and certificates from the security database to a
PKCS#12 file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Arguments</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;c
keyCipher</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the key encryption algorithm.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;C
certCipher</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the key cert (overall package) encryption
algorithm.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;d
[sql:]directory</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the database directory into which to import to or export
from certificates and keys.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000"><b>pk12util</b>
supports two types of databases: the legacy security
databases (cert8.db, key3.db, and secmod.db) and new SQLite
databases (cert9.db, key4.db, and pkcs11.txt). If the prefix
<b>sql:</b> is not used, then the tool assumes that the
given databases are in the old format.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;h
tokenname</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the name of the token to import into or export
from.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;k
slotPasswordFile</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the text file containing the slot's password.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;K
slotPassword</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the slot's password.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;m
| &minus;&minus;key&minus;len keyLength</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the desired length of the symmetric key to be used to
encrypt the private key.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;n
| &minus;&minus;cert&minus;key&minus;len
certKeyLength</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the desired length of the symmetric key to be used to
encrypt the certificates and other
meta&minus;data.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;n
certname</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the nickname of the cert and private key to
export.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;P
prefix</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the prefix used on the certificate and key databases. This
option is provided as a special case. Changing the names of
the certificate and key databases is not
recommended.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;r</font></p>

<p style="margin-left:17%;"><font color="#000000">Dumps all
of the data in raw (binary) form. This must be saved as a
DER file. The default is to return information in a
pretty&minus;print ASCII format, which displays the
information about the certificates and public keys in the
p12 file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;v</font></p>

<p style="margin-left:17%;"><font color="#000000">Enable
debug logging when importing.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;w
p12filePasswordFile</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the text file containing the pkcs #12 file
password.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">&minus;W
p12filePassword</font></p>

<p style="margin-left:17%;"><font color="#000000">Specify
the pkcs #12 file password.</font></p>

<h2>RETURN CODES
<a name="RETURN CODES"></a>
</h2>



<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
0 &minus; No error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
1 &minus; User Cancelled</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
2 &minus; Usage error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
6 &minus; NLS init error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
8 &minus; Certificate DB open error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
9 &minus; Key DB open error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
10 &minus; File initialization error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
11 &minus; Unicode conversion error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
12 &minus; Temporary file creation error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
13 &minus; PKCS11 get slot error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
14 &minus; PKCS12 decoder start error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
15 &minus; error read from import file</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
16 &minus; pkcs12 decode error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
17 &minus; pkcs12 decoder verify error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
18 &minus; pkcs12 decoder validate bags error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
19 &minus; pkcs12 decoder import bags error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
20 &minus; key db conversion version 3 to version 2
error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
21 &minus; cert db conversion version 7 to version 5
error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
22 &minus; cert and key dbs patch error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
23 &minus; get default cert db error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
24 &minus; find cert by nickname error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
25 &minus; create export context error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
26 &minus; PKCS12 add password itegrity error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
27 &minus; cert and key Safes creation error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
28 &minus; PKCS12 add cert and key error</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
29 &minus; PKCS12 encode error</font></p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Importing
Keys and Certificates</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
most basic usage of <b>pk12util</b> for importing a
certificate or key is the PKCS#12 input file
(<b>&minus;i</b>) and some way to specify the security
database being accessed (either <b>&minus;d</b> for a
directory or <b>&minus;h</b> for a token).</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pk12util
&minus;i p12File [&minus;h tokenname] [&minus;v] [&minus;d
[sql:]directory] [&minus;P dbprefix] [&minus;k
slotPasswordFile|&minus;K slotPassword] [&minus;w
p12filePasswordFile|&minus;W p12filePassword]</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
pk12util &minus;i /tmp/cert&minus;files/users.p12 &minus;d
sql:/home/my/sharednssdb</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Enter
a password which will be used to encrypt your keys. <br>
The password should be at least 8 characters long, <br>
and should contain at least one non&minus;alphabetic
character.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Enter
new password: <br>
Re&minus;enter password: <br>
Enter password for PKCS12 file: <br>
pk12util: PKCS12 IMPORT SUCCESSFUL</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Exporting
Keys and Certificates</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Using
the <b>pk12util</b> command to export certificates and keys
requires both the name of the certificate to extract from
the database (<b>&minus;n</b>) and the
PKCS#12&minus;formatted output file to write to. There are
optional parameters that can be used to encrypt the file to
protect the certificate material.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pk12util
&minus;o p12File &minus;n certname [&minus;c keyCipher]
[&minus;C certCipher] [&minus;m|&minus;&minus;key_len
keyLen] [&minus;n|&minus;&minus;cert_key_len certKeyLen]
[&minus;d [sql:]directory] [&minus;P dbprefix] [&minus;k
slotPasswordFile|&minus;K slotPassword] [&minus;w
p12filePasswordFile|&minus;W p12filePassword]</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
pk12util &minus;o certs.p12 &minus;n Server&minus;Cert
&minus;d sql:/home/my/sharednssdb <br>
Enter password for PKCS12 file: <br>
Re&minus;enter password:</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000"><b>Listing
Keys and Certificates</b></font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
information in a .p12 file are not human&minus;readable. The
certificates and keys in the file can be printed (listed) in
a human&minus;readable pretty&minus;print format that shows
information for every certificate and any public keys in the
.p12 file.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">pk12util
&minus;l p12File [&minus;h tokenname] [&minus;r] [&minus;d
[sql:]directory] [&minus;P dbprefix] [&minus;k
slotPasswordFile|&minus;K slotPassword] [&minus;w
p12filePasswordFile|&minus;W p12filePassword]</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
example, this prints the default ASCII output:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
pk12util &minus;l certs.p12</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Enter
password for PKCS12 file: <br>
Key(shrouded): <br>
Friendly Name: Thawte Freemail Member's Thawte Consulting
(Pty) Ltd. ID</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Encryption
algorithm: PKCS #12 V2 PBE With SHA&minus;1 And 3KEY Triple
DES&minus;CBC <br>
Parameters: <br>
Salt: <br>
45:2e:6a:a0:03:4d:7b:a1:63:3c:15:ea:67:37:62:1f <br>
Iteration Count: 1 (0x1) <br>
Certificate: <br>
Data: <br>
Version: 3 (0x2) <br>
Serial Number: 13 (0xd) <br>
Signature Algorithm: PKCS #1 SHA&minus;1 With RSA Encryption
<br>
Issuer: &quot;E=personal&minus;freemail@thawte.com,CN=Thawte
Personal Freemail C <br>
A,OU=Certification Services Division,O=Thawte
Consulting,L=Cape T <br>
own,ST=Western Cape,C=ZA&quot;</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Alternatively,
the <b>&minus;r</b> prints the certificates and then exports
them into separate DER binary files. This allows the
certificates to be fed to another application that supports
.p12 files. Each certificate is written to a
sequentially&minus;number file, beginning with file0001.der
and continuing through file000N.der, incrementing the number
for every certificate:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">pk12util
&minus;l test.p12 &minus;r <br>
Enter password for PKCS12 file: <br>
Key(shrouded): <br>
Friendly Name: Thawte Freemail Member's Thawte Consulting
(Pty) Ltd. ID</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Encryption
algorithm: PKCS #12 V2 PBE With SHA&minus;1 And 3KEY Triple
DES&minus;CBC <br>
Parameters: <br>
Salt: <br>
45:2e:6a:a0:03:4d:7b:a1:63:3c:15:ea:67:37:62:1f <br>
Iteration Count: 1 (0x1) <br>
Certificate Friendly Name: Thawte Personal Freemail Issuing
CA &minus; Thawte Consulting</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">Certificate
Friendly Name: Thawte Freemail Member's Thawte Consulting
(Pty) Ltd. ID</font></p>

<h2>PASSWORD ENCRYPTION
<a name="PASSWORD ENCRYPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">PKCS#12
provides for not only the protection of the private keys but
also the certificate and meta&minus;data associated with the
keys. Password&minus;based encryption is used to protect
private keys on export to a PKCS#12 file and, optionally,
the entire package. If no algorithm is specified, the tool
defaults to using <b>PKCS12 V2 PBE with SHA1 and 3KEY Triple
DES&minus;cbc</b> for private key encryption. <b>PKCS12 V2
PBE with SHA1 and 40 Bit RC4</b> is the default for the
overall package encryption when not in FIPS mode. When in
FIPS mode, there is no package encryption.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
private key is always protected with strong encryption by
default.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Several
types of ciphers are supported.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Symmetric
CBC ciphers for PKCS#5 V2</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
DES&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
RC2&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
RC5&minus;CBCPad</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
DES&minus;EDE3&minus;CBC (the default for key
encryption)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
AES&minus;128&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
AES&minus;192&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
AES&minus;256&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
CAMELLIA&minus;128&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
CAMELLIA&minus;192&minus;CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
CAMELLIA&minus;256&minus;CBC</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">PKCS#12
PBE ciphers</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #12 PBE with Sha1 and 128 Bit RC4</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #12 PBE with Sha1 and 40 Bit RC4</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #12 PBE with Sha1 and Triple DES CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #12 PBE with Sha1 and 128 Bit RC2 CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #12 PBE with Sha1 and 40 Bit RC2 CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 128 Bit RC4</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 40 Bit RC4 (the default for
non&minus;FIPS mode)</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 3KEY Triple
DES&minus;cbc</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 2KEY Triple
DES&minus;cbc</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 128 Bit RC2 CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS12 V2 PBE with SHA1 and 40 Bit RC2 CBC</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">PKCS#5
PBE ciphers</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #5 Password Based Encryption with MD2 and DES
CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #5 Password Based Encryption with MD5 and DES
CBC</font></p>


<p style="margin-left:23%; margin-top: 1em"><font color="#000000">&bull;
PKCS #5 Password Based Encryption with SHA1 and DES
CBC</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">With
PKCS#12, the crypto provider may be the soft token module or
an external hardware module. If the cryptographic module
does not support the requested algorithm, then the next best
fit will be selected (usually the default). If no suitable
replacement for the desired algorithm can be found, the tool
returns the error <i>no security module can perform the
requested operation</i>.</font></p>

<h2>NSS DATABASE TYPES
<a name="NSS DATABASE TYPES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">NSS
originally used BerkeleyDB databases to store security
information. The last versions of these <i>legacy</i>
databases are:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
cert8.db for certificates</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
key3.db for keys</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
secmod.db for PKCS #11 module information</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">BerkeleyDB
has performance limitations, though, which prevent it from
being easily used by multiple applications simultaneously.
NSS has some flexibility that allows applications to use
their own, independent database engine while keeping a
shared database and working around the access issues. Still,
NSS requires more flexibility to provide a truly shared
security database.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">In
2009, NSS introduced a new set of databases that are SQLite
databases rather than BerkleyDB. These new databases provide
more accessibility and performance:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
cert9.db for certificates</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
key4.db for keys</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
pkcs11.txt, which is listing of all of the PKCS #11 modules
contained in a new subdirectory in the security databases
directory</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Because
the SQLite databases are designed to be shared, these are
the <i>shared</i> database type. The shared database type is
preferred; the legacy format is included for backward
compatibility.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">By
default, the tools (<b>certutil</b>, <b>pk12util</b>,
<b>modutil</b>) assume that the given security databases
follow the more common legacy type. Using the SQLite
databases must be manually specified by using the
<b>sql:</b> prefix with the given security directory. For
example:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">#
pk12util &minus;i /tmp/cert&minus;files/users.p12 &minus;d
sql:/home/my/sharednssdb</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">To
set the shared database type as the default type for the
tools, set the <b>NSS_DEFAULT_DB_TYPE</b> environment
variable to <b>sql</b>:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">export
NSS_DEFAULT_DB_TYPE=&quot;sql&quot;</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">This
line can be set added to the ~/.bashrc file to make the
change permanent.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Most
applications do not use the shared database by default, but
they can be configured to use them. For example, this
how&minus;to article covers how to configure Firefox and
Thunderbird to use the new shared NSS databases:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
an engineering draft on the changes in the shared NSS
databases, see the NSS project wiki:</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">certutil
(1)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">modutil
(1)</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
NSS wiki has information on the new database design and how
to configure applications to use it.</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB_Howto</font></p>


<p style="margin-left:17%; margin-top: 1em"><font color="#000000">&bull;
https://wiki.mozilla.org/NSS_Shared_DB</font></p>

<h2>ADDITIONAL RESOURCES
<a name="ADDITIONAL RESOURCES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">For
information about NSS and other tools related to NSS (like
JSS), check out the NSS project wiki at</font>
<b><font color="#0000FF">http://www.mozilla.org/projects/security/pki/nss/</font></b><font color="#000000">.
The NSS site relates directly to NSS code changes and
releases.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Mailing
lists:
https://lists.mozilla.org/listinfo/dev&minus;tech&minus;crypto</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">IRC:
Freenode at #dogtag&minus;pki</font></p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">The
NSS tools were written and maintained by developers with
Netscape, Red Hat, Sun, Oracle, Mozilla, and
Google.</font></p>


<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Authors:
Elio Maldonado &lt;emaldona@redhat.com&gt;, Deon Lackey
&lt;dlackey@redhat.com&gt;.</font></p>

<h2>LICENSE
<a name="LICENSE"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><font color="#000000">Licensed
under the Mozilla Public License, v. 2.0. If a copy of the
MPL was not distributed with this file, You can obtain one
at http://mozilla.org/MPL/2.0/.</font></p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">



<p style="margin-top: 1em"><font color="#000000">1.</font></p> </td>
<td width="2%"></td>
<td width="34%">


<p style="margin-top: 1em"><font color="#000000">Mozilla
NSS bug 836477</font></p></td>
<td width="49%">
</td></tr>
</table>


<p style="margin-left:17%;"><font color="#000000">https://bugzilla.mozilla.org/show_bug.cgi?id=836477</font></p>
<hr>
</body>
</html>
