<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:23:20 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>RSYSLOG.CONF</title>

</head>
<body>

<h1 align="center">RSYSLOG.CONF</h1>

<a href="#NAME">NAME</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#MODULES">MODULES</a><br>
<a href="#BASIC STRUCTURE">BASIC STRUCTURE</a><br>
<a href="#SELECTORS">SELECTORS</a><br>
<a href="#ACTIONS">ACTIONS</a><br>
<a href="#FILTER CONDITIONS">FILTER CONDITIONS</a><br>
<a href="#TEMPLATES">TEMPLATES</a><br>
<a href="#OUTPUT CHANNELS">OUTPUT CHANNELS</a><br>
<a href="#PROPERTY REPLACER">PROPERTY REPLACER</a><br>
<a href="#QUEUED OPERATIONS">QUEUED OPERATIONS</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">rsyslog.conf
&minus; rsyslogd(8) configuration file</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<i>rsyslog.conf</i> file is the main configuration file for
the <b>rsyslogd</b>(8) which logs system messages on *nix
systems. This file specifies rules for logging. For special
features see the <b>rsyslogd</b>(8) manpage. Rsyslog.conf is
backward-compatible with sysklogd&rsquo;s syslog.conf file.
So if you migrate from sysklogd you can rename it and it
should work.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Note that
this version of rsyslog ships with extensive documentation
in html format.</b> This is provided in the ./doc
subdirectory and probably in a separate package if you
installed rsyslog via a packaging system. To use
rsyslog&rsquo;s advanced features, you <b>need</b> to look
at the html documentation, because the man pages only cover
basic aspects of operation.</p>

<h2>MODULES
<a name="MODULES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Rsyslog has a
modular design. Consequently, there is a growing number of
modules. See the html documentation for their full
description.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>omsnmp</i></p></td>
<td width="2%"></td>
<td width="35%">


<p>SNMP trap output module</p></td>
<td width="43%">
</td></tr>
</table>

<p style="margin-left:11%;"><i>omgssapi</i></p>

<p style="margin-left:22%;">Output module for GSS-enabled
syslog</p>

<p style="margin-left:11%;"><i>ommysql</i></p>

<p style="margin-left:22%;">Output module for MySQL</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>omrelp</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Output module for the reliable RELP protocol (prevents
message loss). For details, see below at imrelp and the html
documentation. It can be used like this:</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">*.*
:omrelp:server:port</p>

<p style="margin-left:22%; margin-top: 1em">*.*
:omrelp:192.168.0.1:2514 # actual sample</p>

<p style="margin-left:11%;"><i>ompgsql</i></p>

<p style="margin-left:22%;">Output module for
PostgreSQL</p>

<p style="margin-left:11%;"><i>omlibdbi</i></p>

<p style="margin-left:22%;">Generic database output module
(Firebird/Interbase, MS SQL, Sybase, SQLite, Ingres, Oracle,
mSQL)</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>imfile</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Input module for text files</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>imudp</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Input plugin for UDP syslog. Replaces the deprecated -r
option. Can be used like this:</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">$ModLoad
imudp</p>

<p style="margin-left:22%; margin-top: 1em">$UDPServerRun
514</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p style="margin-top: 1em"><i>imtcp</i></p></td>
<td width="4%"></td>
<td width="78%">


<p style="margin-top: 1em">Input plugin for plain TCP
syslog. Replaces the deprecated -t option. Can be used like
this:</p> </td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">$ModLoad
imtcp</p>


<p style="margin-left:22%; margin-top: 1em">$InputTCPServerRun
514</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><i>imrelp</i></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Input plugin for the RELP
protocol. RELP can be used instead of UDP or plain TCP
syslog to provide reliable delivery of syslog messages.
Please note that plain TCP syslog does NOT provide truly
reliable delivery, with it messages may be lost when there
is a connection problem or the server shuts down. RELP
prevents message loss in those cases. It can be used like
this:</p> </td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">$ModLoad
imrelp</p>


<p style="margin-left:22%; margin-top: 1em">$InputRELPServerRun
2514</p>

<p style="margin-left:11%;"><i>imgssapi</i></p>

<p style="margin-left:22%;">Input plugin for plain TCP and
GSS-enable syslog</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>immark</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Support for mark messages</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>imklog</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Kernel logging. To include kernel log messages, you need
to do</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">$ModLoad
imklog</p>

<p style="margin-left:22%; margin-top: 1em">Please note
that the klogd daemon is no longer necessary and
consequently no longer provided by the rsyslog package.</p>

<p style="margin-left:11%;"><i>imuxsock</i></p>

<p style="margin-left:22%;">Unix sockets, including the
system log socket. You need to specify</p>

<p style="margin-left:22%; margin-top: 1em">$ModLoad
imuxsock</p>

<p style="margin-left:22%; margin-top: 1em">in order to
receive log messages from local system processes. This
config directive should only left out if you know exactly
what you are doing.</p>

<h2>BASIC STRUCTURE
<a name="BASIC STRUCTURE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Lines starting
with a hash mark (&rsquo;#&rsquo;) and empty lines are
ignored. Rsyslog.conf should contain following sections
(sorted by recommended order in file): <br>
Global directives</p>

<p style="margin-left:22%;">Global directives set some
global properties of whole rsyslog daemon, for example size
of main message queue ($MainMessageQueueSize), loading
external modules ($ModLoad) and so on. All global directives
need to be specified on a line by their own and must start
with a dollar-sign. The complete list of global directives
can be found in html documentation in doc directory or
online on web pages.</p>

<p style="margin-left:11%;">Templates</p>

<p style="margin-left:22%;">Templates allow you to specify
format of the logged message. They are also used for dynamic
file name generation. They have to be defined before they
are used in rules. For more info about templates see
TEMPLATES section of this manpage.</p>

<p style="margin-left:11%;">Output channels</p>

<p style="margin-left:22%;">Output channels provide an
umbrella for any type of output that the user might want.
They have to be defined before they are used in rules. For
more info about output channels see OUTPUT CHANNELS section
of this manpage.</p>

<p style="margin-left:11%;">Rules (selector + action)</p>

<p style="margin-left:22%;">Every rule line consists of two
fields, a selector field and an action field. These two
fields are separated by one or more spaces or tabs. The
selector field specifies a pattern of facilities and
priorities belonging to the specified action.</p>

<h2>SELECTORS
<a name="SELECTORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The selector
field itself again consists of two parts, a facility and a
priority, separated by a period (&rsquo;.&rsquo;). Both
parts are case insensitive and can also be specified as
decimal numbers, but don&rsquo;t do that, you have been
warned. Both facilities and priorities are described in
syslog(3). The names mentioned below correspond to the
similar LOG_-values in /usr/include/syslog.h.</p>

<p style="margin-left:11%; margin-top: 1em">The facility is
one of the following keywords: auth, authpriv, cron, daemon,
kern, lpr, mail, mark, news, security (same as auth),
syslog, user, uucp and local0 through local7. The keyword
security should not be used anymore and mark is only for
internal use and therefore should not be used in
applications. Anyway, you may want to specify and redirect
these messages here. The facility specifies the subsystem
that produced the message, i.e. all mail programs log with
the mail facility (LOG_MAIL) if they log using syslog.</p>

<p style="margin-left:11%; margin-top: 1em">The priority is
one of the following keywords, in ascending order: debug,
info, notice, warning, warn (same as warning), err, error
(same as err), crit, alert, emerg, panic (same as emerg).
The keywords error, warn and panic are deprecated and should
not be used anymore. The priority defines the severity of
the message.</p>

<p style="margin-left:11%; margin-top: 1em">The behavior of
the original BSD syslogd is that all messages of the
specified priority and higher are logged according to the
given action. Rsyslogd behaves the same, but has some
extensions.</p>

<p style="margin-left:11%; margin-top: 1em">In addition to
the above mentioned names the rsyslogd(8) understands the
following extensions: An asterisk (&rsquo;*&rsquo;) stands
for all facilities or all priorities, depending on where it
is used (before or after the period). The keyword none
stands for no priority of the given facility.</p>

<p style="margin-left:11%; margin-top: 1em">You can specify
multiple facilities with the same priority pattern in one
statement using the comma (&rsquo;,&rsquo;) operator. You
may specify as much facilities as you want. Remember that
only the facility part from such a statement is taken, a
priority part would be skipped.</p>

<p style="margin-left:11%; margin-top: 1em">Multiple
selectors may be specified for a single action using the
semicolon (&rsquo;;&rsquo;) separator. Remember that each
selector in the selector field is capable to overwrite the
preceding ones. Using this behavior you can exclude some
priorities from the pattern.</p>

<p style="margin-left:11%; margin-top: 1em">Rsyslogd has a
syntax extension to the original BSD source, that makes its
use more intuitively. You may precede every priority with an
equals sign (&rsquo;=&rsquo;) to specify only this single
priority and not any of the above. You may also (both is
valid, too) precede the priority with an exclamation mark
(&rsquo;!&rsquo;) to ignore all that priorities, either
exact this one or this and any higher priority. If you use
both extensions than the exclamation mark must occur before
the equals sign, just use it intuitively.</p>

<h2>ACTIONS
<a name="ACTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The action
field of a rule describes what to do with the message. In
general, message content is written to a kind of
&quot;logfile&quot;. But also other actions might be done,
like writing to a database table or forwarding to another
host.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Regular
file</b> <br>
Typically messages are logged to real files. The file has to
be specified with full pathname, beginning with a slash
(&rsquo;/&rsquo;).</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example:</b></p>

<p style="margin-left:22%;">*.*
/var/log/traditionalfile.log;RSYSLOG_TraditionalFileFormat #
log to a file in the traditional format</p>

<p style="margin-left:11%; margin-top: 1em">Note: if you
would like to use high-precision timestamps in your log
files, just remove the
&quot;;RSYSLOG_TraditionalFormat&quot;. That will select the
default template, which, if not changed, uses RFC 3339
timestamps.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example:</b></p>

<p style="margin-left:22%;">*.* /var/log/file.log # log to
a file with RFC3339 timestamps</p>

<p style="margin-left:11%; margin-top: 1em"><b>Named
pipes</b> <br>
This version of rsyslogd(8) has support for logging output
to named pipes (fifos). A fifo or named pipe can be used as
a destination for log messages by prepending a pipe symbol
(&rsquo;|&rsquo;) to the name of the file. This is handy for
debugging. Note that the fifo must be created with the
mkfifo(1) command before rsyslogd(8) is started.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Terminal and
console</b> <br>
If the file you specified is a tty, special tty-handling is
done, same with /dev/console.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Remote
machine</b> <br>
There are three ways to forward message: the traditional UDP
transport, which is extremely lossy but standard, the plain
TCP based transport which loses messages only during certain
situations but is widely available and the RELP transport
which does not lose messages but is currently available only
as part of rsyslogd 3.15.0 and above.</p>

<p style="margin-left:11%; margin-top: 1em">To forward
messages to another host via UDP, prepend the hostname with
the at sign (&quot;@&quot;). To forward it via plain tcp,
prepend two at signs (&quot;@@&quot;). To forward via RELP,
prepend the string &quot;:omrelp:&quot; in front of the
hostname.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example:</b></p>

<p style="margin-left:22%;">*.* @192.168.0.1</p>

<p style="margin-left:11%; margin-top: 1em">In the example
above, messages are forwarded via UDP to the machine
192.168.0.1, the destination port defaults to 514. Due to
the nature of UDP, you will probably lose some messages in
transit. If you expect high traffic volume, you can expect
to lose a quite noticeable number of messages (the higher
the traffic, the more likely and severe is message
loss).</p>

<p style="margin-left:11%; margin-top: 1em"><b>If you would
like to prevent message loss, use RELP:</b></p>

<p style="margin-left:22%;">*.*
:omrelp:192.168.0.1:2514</p>

<p style="margin-left:11%; margin-top: 1em">Note that a
port number was given as there is no standard port for
relp.</p>

<p style="margin-left:11%; margin-top: 1em">Keep in mind
that you need to load the correct input and output plugins
(see &quot;Modules&quot; above).</p>

<p style="margin-left:11%; margin-top: 1em">Please note
that rsyslogd offers a variety of options in regarding to
remote forwarding. For full details, please see the html
documentation.</p>

<p style="margin-left:11%; margin-top: 1em"><b>List of
users</b> <br>
Usually critical messages are also directed to
&lsquo;&lsquo;root&rsquo;&rsquo; on that machine. You can
specify a list of users that shall get the message by simply
writing &quot;:omusrmsg:&quot; followed by the login name.
You may specify more than one user by separating them with
commas (&rsquo;,&rsquo;). If they&rsquo;re logged in they
get the message (for example:
&quot;:omusrmsg:root,user1,user2&quot;).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Everyone
logged on</b> <br>
Emergency messages often go to all users currently online to
notify them that something strange is happening with the
system. To specify this wall(1)-feature use an
&quot;:omusrmsg:*&quot;.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Database
table</b> <br>
This allows logging of the message to a database table. By
default, a MonitorWare-compatible schema is required for
this to work. You can create that schema with the
createDB.SQL file that came with the rsyslog package. You
can also use any other schema of your liking - you just need
to define a proper template and assign this template to the
action.</p>

<p style="margin-left:11%; margin-top: 1em">See the html
documentation for further details on database logging.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Discard</b>
<br>
If the discard action is carried out, the received message
is immediately discarded. Discard can be highly effective if
you want to filter out some annoying messages that otherwise
would fill your log files. To do that, place the discard
actions early in your log files. This often plays well with
property-based filters, giving you great freedom in
specifying what you do not want.</p>

<p style="margin-left:11%; margin-top: 1em">Discard is just
the single tilde character with no further parameters.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example:</b></p>

<p style="margin-left:22%;">*.* ~ # discards
everything.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Output
channel</b> <br>
Binds an output channel definition (see there for details)
to this action. Output channel actions must start with a
$-sign, e.g. if you would like to bind your output channel
definition &quot;mychannel&quot; to the action, use
&quot;$mychannel&quot;. Output channels support template
definitions like all all other actions.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Shell
execute</b> <br>
This executes a program in a subshell. The program is passed
the template-generated message as the only command line
parameter. Rsyslog waits until the program terminates and
only then continues to run.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Example:</b></p>


<p style="margin-left:22%;">^program-to-execute;template</p>

<p style="margin-left:11%; margin-top: 1em">The
program-to-execute can be any valid executable. It receives
the template string as a single parameter (argv[1]).</p>

<h2>FILTER CONDITIONS
<a name="FILTER CONDITIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Rsyslog offers
three different types &quot;filter conditions&quot;: <br>
* &quot;traditional&quot; severity and facility based
selectors <br>
* property-based filters <br>
* expression-based filters</p>

<p style="margin-left:11%; margin-top: 1em"><b>Selectors
<br>
Selectors are the traditional way of filtering syslog
messages.</b> They have been kept in rsyslog with their
original syntax, because it is well-known, highly effective
and also needed for compatibility with stock syslogd
configuration files. If you just need to filter based on
priority and facility, you should do this with selector
lines. They are not second-class citizens in rsyslog and
offer the best performance for this job.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Property-Based
Filters</b> <br>
Property-based filters are unique to rsyslogd. They allow to
filter on any property, like HOSTNAME, syslogtag and
msg.</p>

<p style="margin-left:11%; margin-top: 1em">A
property-based filter must start with a colon in column 0.
This tells rsyslogd that it is the new filter type. The
colon must be followed by the property name, a comma, the
name of the compare operation to carry out, another comma
and then the value to compare against. This value must be
quoted. There can be spaces and tabs between the commas.
Property names and compare operations are case-sensitive, so
&quot;msg&quot; works, while &quot;MSG&quot; is an invalid
property name. In brief, the syntax is as follows:</p>

<p style="margin-left:22%; margin-top: 1em">:property,
[!]compare-operation, &quot;value&quot;</p>

<p style="margin-left:11%; margin-top: 1em">The following
compare-operations are currently supported:</p>


<p style="margin-left:22%; margin-top: 1em"><b>contains</b></p>

<p style="margin-left:32%;">Checks if the string provided
in value is contained in the property</p>


<p style="margin-left:22%; margin-top: 1em"><b>isequal</b></p>

<p style="margin-left:32%;">Compares the &quot;value&quot;
string provided and the property contents. These two values
must be exactly equal to match.</p>


<p style="margin-left:22%; margin-top: 1em"><b>startswith</b></p>

<p style="margin-left:32%;">Checks if the value is found
exactly at the beginning of the property value</p>


<p style="margin-left:22%; margin-top: 1em"><b>regex</b></p>

<p style="margin-left:32%;">Compares the property against
the provided regular expression.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Expression-Based
Filters</b> <br>
See the html documentation for this feature.</p>

<h2>TEMPLATES
<a name="TEMPLATES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Every output in
rsyslog uses templates - this holds true for files, user
messages and so on. Templates compatible with the stock
syslogd formats are hardcoded into rsyslogd. If no template
is specified, we use one of these hardcoded templates.
Search for &quot;template_&quot; in syslogd.c and you will
find the hardcoded ones.</p>

<p style="margin-left:11%; margin-top: 1em">A template
consists of a template directive, a name, the actual
template text and optional options. A sample is:</p>

<p style="margin-left:22%; margin-top: 1em"><b>$template
MyTemplateName,&quot;\7Text %property% some more
text\n&quot;,&lt;options&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">The
&quot;$template&quot; is the template directive. It tells
rsyslog that this line contains a template. The backslash is
an escape character. For example, \7 rings the bell (this is
an ASCII value), \n is a new line. The set in rsyslog is a
bit restricted currently.</p>

<p style="margin-left:11%; margin-top: 1em">All text in the
template is used literally, except for things within percent
signs. These are properties and allow you access to the
contents of the syslog message. Properties are accessed via
the property replacer and it can for example pick a
substring or do date-specific formatting. More on this is
the PROPERTY REPLACER section of this manpage.</p>

<p style="margin-left:11%; margin-top: 1em">To escape: <br>
% = \% <br>
\ = \\ --&gt; &rsquo;\&rsquo; is used to escape (as in C)
<br>
$template TraditionalFormat,&quot;%timegenerated% %HOSTNAME%
%syslogtag%%msg%\n&quot;</p>

<p style="margin-left:11%; margin-top: 1em">Properties can
be accessed by the property replacer (see there for
details).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Please note
that templates can also by used to generate selector lines
with dynamic file names.</b> For example, if you would like
to split syslog messages from different hosts to different
files (one per host), you can define the following
template:</p>

<p style="margin-left:22%; margin-top: 1em"><b>$template
DynFile,&quot;/var/log/system-%HOSTNAME%.log&quot;</b></p>

<p style="margin-left:11%; margin-top: 1em">This template
can then be used when defining an output selector line. It
will result in something like
&quot;/var/log/system-localhost.log&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>Template
options</b> <br>
The &lt;options&gt; part is optional. It carries options
influencing the template as whole. See details below. Be
sure NOT to mistake template options with property options -
the later ones are processed by the property replacer and
apply to a SINGLE property, only (and not the whole
template).</p>

<p style="margin-left:11%; margin-top: 1em">Template
options are case-insensitive. Currently defined are:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p>sql</p></td>
<td width="1%"></td>
<td width="68%">


<p>format the string suitable for a SQL statement in MySQL
format. This will replace single quotes
(&quot;&rsquo;&quot;) and the backslash character by their
backslash-escaped counterpart (&quot;&acute;&quot; and
&quot;\&quot;) inside each field. Please note that in MySQL
configuration, the NO_BACKSLASH_ESCAPES mode must be turned
off for this format to work (this is the default).</p></td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="9%">


<p>stdsql</p></td>
<td width="1%"></td>
<td width="68%">


<p>format the string suitable for a SQL statement that is
to be sent to a standards-compliant sql server. This will
replace single quotes (&quot;&rsquo;&quot;) by two single
quotes (&quot;&rsquo;&rsquo;&quot;) inside each field. You
must use stdsql together with MySQL if in MySQL
configuration the NO_BACKSLASH_ESCAPES is turned on.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Either the
<b>sql</b> or <b>stdsql</b> option <b>MUST</b> be specified
when a template is used for writing to a database, otherwise
injection might occur. Please note that due to the
unfortunate fact that several vendors have violated the sql
standard and introduced their own escape methods, it is
impossible to have a single option doing all the work. So
you yourself must make sure you are using the right format.
<b>If you choose the wrong one, you are still vulnerable to
sql injection.</b></p>

<p style="margin-left:11%; margin-top: 1em">Please note
that the database writer *checks* that the sql option is
present in the template. If it is not present, the write
database action is disabled. This is to guard you against
accidental forgetting it and then becoming vulnerable to SQL
injection. The sql option can also be useful with files -
especially if you want to import them into a database on
another machine for performance reasons. However, do NOT use
it if you do not have a real need for it - among others, it
takes some toll on the processing time. Not much, but on a
really busy system you might notice it ;)</p>

<p style="margin-left:11%; margin-top: 1em">The default
template for the write to database action has the sql option
set.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Template
examples</b> <br>
Please note that the samples are split across multiple
lines. A template MUST NOT actually be split across multiple
lines.</p>

<p style="margin-left:11%; margin-top: 1em">A template that
resembles traditional syslogd file output:</p>

<p style="margin-left:22%; margin-top: 1em">$template
TraditionalFormat,&quot;%timegenerated% %HOSTNAME% <br>
%syslogtag%%msg:::drop-last-lf%\n&quot;</p>

<p style="margin-left:11%; margin-top: 1em">A template that
tells you a little more about the message:</p>

<p style="margin-left:22%; margin-top: 1em">$template
precise,&quot;%syslogpriority%,%syslogfacility%,%timegenerated%,%HOSTNAME%,
<br>
%syslogtag%,%msg%\n&quot;</p>

<p style="margin-left:11%; margin-top: 1em">A template for
RFC 3164 format:</p>

<p style="margin-left:22%; margin-top: 1em">$template
RFC3164fmt,&quot;&lt;%PRI%&gt;%TIMESTAMP% %HOSTNAME%
%syslogtag%%msg%&quot;</p>

<p style="margin-left:11%; margin-top: 1em">A template for
the format traditionally used for user messages:</p>

<p style="margin-left:22%; margin-top: 1em">$template
usermsg,&quot; XXXX%syslogtag%%msg%\n\r&quot;</p>

<p style="margin-left:11%; margin-top: 1em">And a template
with the traditional wall-message format:</p>

<p style="margin-left:22%; margin-top: 1em">$template
wallmsg,&quot;\r\n\7Message from syslogd@%HOSTNAME% at
%timegenerated%&quot;</p>

<p style="margin-left:11%; margin-top: 1em"><b>A template
that can be used for writing to a database (please note the
SQL template option)</b></p>

<p style="margin-left:22%; margin-top: 1em">$template
MySQLInsert,&quot;insert iut, message, receivedat values
(&rsquo;%iut%&rsquo;, &rsquo;%msg:::UPPERCASE%&rsquo;,
&rsquo;%timegenerated:::date-mysql%&rsquo;) into
systemevents\r\n&quot;, SQL</p>

<p style="margin-left:22%; margin-top: 1em">NOTE 1: This
template is embedded into core application under name
<b>StdDBFmt</b> , so you don&rsquo;t need to define it.</p>

<p style="margin-left:22%; margin-top: 1em">NOTE 2: You
have to have MySQL module installed to use this
template.</p>

<h2>OUTPUT CHANNELS
<a name="OUTPUT CHANNELS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Output Channels
are a new concept first introduced in rsyslog 0.9.0. As of
this writing, it is most likely that they will be replaced
by something different in the future. So if you use them, be
prepared to change you configuration file syntax when you
upgrade to a later release.</p>

<p style="margin-left:11%; margin-top: 1em">Output channels
are defined via an $outchannel directive. It&rsquo;s syntax
is as follows:</p>

<p style="margin-left:22%; margin-top: 1em"><b>$outchannel
name,file-name,max-size,action-on-max-size</b></p>

<p style="margin-left:11%; margin-top: 1em">name is the
name of the output channel (not the file), file-name is the
file name to be written to, max-size the maximum allowed
size and action-on-max-size a command to be issued when the
max size is reached. This command always has exactly one
parameter. The binary is that part of action-on-max-size
before the first space, its parameter is everything behind
that space.</p>

<p style="margin-left:11%; margin-top: 1em">Keep in mind
that $outchannel just defines a channel with
&quot;name&quot;. It does not activate it. To do so, you
must use a selector line (see below). That selector line
includes the channel name plus &quot;:omfile:$&quot; in
front of it. A sample might be:</p>

<p style="margin-left:22%; margin-top: 1em">*.*
:omfile:$mychannel</p>

<h2>PROPERTY REPLACER
<a name="PROPERTY REPLACER"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The property
replacer is a core component in rsyslogd&rsquo;s output
system. A syslog message has a number of well-defined
properties (see below). Each of this properties can be
accessed and manipulated by the property replacer. With it,
it is easy to use only part of a property value or
manipulate the value, e.g. by converting all characters to
lower case.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Accessing
Properties</b> <br>
Syslog message properties are used inside templates. They
are accessed by putting them between percent signs.
Properties can be modified by the property replacer. The
full syntax is as follows:</p>


<p style="margin-left:22%; margin-top: 1em"><b>%propname:fromChar:toChar:options%</b></p>

<p style="margin-left:11%; margin-top: 1em">propname is the
name of the property to access. <b>It is
case-sensitive.</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>Available
Properties</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><b>msg</b></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">the MSG part of the message (aka
&quot;the message&quot; ;))</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>rawmsg</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>the message exactly as it was received from the socket.
Should be useful for debugging.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>HOSTNAME</b></p>

<p style="margin-left:22%;">hostname from the message</p>

<p style="margin-left:11%;"><b>FROMHOST</b></p>

<p style="margin-left:22%;">hostname of the system the
message was received from (in a relay chain, this is the
system immediately in front of us and not necessarily the
original sender)</p>

<p style="margin-left:11%;"><b>syslogtag</b></p>

<p style="margin-left:22%;">TAG from the message</p>

<p style="margin-left:11%;"><b>programname</b></p>

<p style="margin-left:22%;">the &quot;static&quot; part of
the tag, as defined by BSD syslogd. For example, when TAG is
&quot;named[12345]&quot;, programname is
&quot;named&quot;.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>PRI</b></p></td>
<td width="7%"></td>
<td width="76%">


<p>PRI part of the message - undecoded (single value)</p></td>
<td width="2%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>PRI-text</b></p>

<p style="margin-left:22%;">the PRI part of the message in
a textual form (e.g. &quot;syslog.info&quot;)</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>IUT</b></p></td>
<td width="7%"></td>
<td width="78%">


<p>the monitorware InfoUnitType - used when talking to a
MonitorWare backend (also for phpLogCon)</p></td></tr>
</table>

<p style="margin-left:11%;"><b>syslogfacility</b></p>

<p style="margin-left:22%;">the facility from the message -
in numerical form</p>

<p style="margin-left:11%;"><b>syslogfacility-text</b></p>

<p style="margin-left:22%;">the facility from the message -
in text form</p>

<p style="margin-left:11%;"><b>syslogseverity</b></p>

<p style="margin-left:22%;">severity from the message - in
numerical form</p>

<p style="margin-left:11%;"><b>syslogseverity-text</b></p>

<p style="margin-left:22%;">severity from the message - in
text form</p>

<p style="margin-left:11%;"><b>timegenerated</b></p>

<p style="margin-left:22%;">timestamp when the message was
RECEIVED. Always in high resolution</p>

<p style="margin-left:11%;"><b>timereported</b></p>

<p style="margin-left:22%;">timestamp from the message.
Resolution depends on what was provided in the message (in
most cases, only seconds)</p>

<p style="margin-left:11%;"><b>TIMESTAMP</b></p>

<p style="margin-left:22%;">alias for timereported</p>

<p style="margin-left:11%;"><b>PROTOCOL-VERSION</b></p>

<p style="margin-left:22%;">The contents of the
PROTOCOL-VERSION field from IETF draft
draft-ietf-syslog-protocol</p>

<p style="margin-left:11%;"><b>STRUCTURED-DATA</b></p>

<p style="margin-left:22%;">The contents of the
STRUCTURED-DATA field from IETF draft
draft-ietf-syslog-protocol</p>

<p style="margin-left:11%;"><b>APP-NAME</b></p>

<p style="margin-left:22%;">The contents of the APP-NAME
field from IETF draft draft-ietf-syslog-protocol</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>PROCID</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The contents of the PROCID field from IETF draft
draft-ietf-syslog-protocol</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>MSGID</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The contents of the MSGID field from IETF draft
draft-ietf-syslog-protocol</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>$NOW</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The current date stamp in the format YYYY-MM-DD</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>$YEAR</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The current year (4-digit)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>$MONTH</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The current month (2-digit)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>$DAY</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The current day of the month (2-digit)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><b>$HOUR</b></p></td>
<td width="2%"></td>
<td width="78%">


<p>The current hour in military (24 hour) time
(2-digit)</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>$MINUTE</b></p>

<p style="margin-left:22%;">The current minute
(2-digit)</p>

<p style="margin-left:11%; margin-top: 1em">Properties
starting with a $-sign are so-called system properties.
These do NOT stem from the message but are rather
internally-generated.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Character
Positions</b> <br>
FromChar and toChar are used to build substrings. They
specify the offset within the string that should be copied.
Offset counting starts at 1, so if you need to obtain the
first 2 characters of the message text, you can use this
syntax: &quot;%msg:1:2%&quot;. If you do not wish to specify
from and to, but you want to specify options, you still need
to include the colons. For example, if you would like to
convert the full message text to lower case, use
&quot;%msg:::lowercase%&quot;. If you would like to extract
from a position until the end of the string, you can place a
dollar-sign (&quot;$&quot;) in toChar (e.g. %msg:10:$%,
which will extract from position 10 to the end of the
string).</p>

<p style="margin-left:11%; margin-top: 1em">There is also
support for <b>regular expressions.</b> To use them, you
need to place a &quot;R&quot; into FromChar. This tells
rsyslog that a regular expression instead of position-based
extraction is desired. The actual regular expression
<b>must</b> then be provided in toChar. The regular
expression must be followed by the string &quot;--end&quot;.
It denotes the end of the regular expression and will not
become part of it. If you are using regular expressions, the
property replacer will return the part of the property text
that matches the regular expression. An example for a
property replacer sequence with a regular expression is:
&quot;%msg:R:.*Sev:. \(.*\) \[.*--end%&quot;</p>

<p style="margin-left:11%; margin-top: 1em">Also,
extraction can be done based on so-called
&quot;fields&quot;. To do so, place a &quot;F&quot; into
FromChar. A field in its current definition is anything that
is delimited by a delimiter character. The delimiter by
default is TAB (US-ASCII value 9). However, if can be
changed to any other US-ASCII character by specifying a
comma and the decimal US-ASCII value of the delimiter
immediately after the &quot;F&quot;. For example, to use
comma (&quot;,&quot;) as a delimiter, use this field
specifier: &quot;F,44&quot;. If your syslog data is
delimited, this is a quicker way to extract than via regular
expressions (actually, a *much* quicker way). Field counting
starts at 1. Field zero is accepted, but will always lead to
a &quot;field not found&quot; error. The same happens if a
field number higher than the number of fields in the
property is requested. The field number must be placed in
the &quot;ToChar&quot; parameter. An example where the 3rd
field (delimited by TAB) from the msg property is extracted
is as follows: &quot;%msg:F:3%&quot;. The same example with
semicolon as delimiter is &quot;%msg:F,59:3%&quot;.</p>

<p style="margin-left:11%; margin-top: 1em">Please note
that the special characters &quot;F&quot; and &quot;R&quot;
are case-sensitive. Only upper case works, lower case will
return an error. There are no white spaces permitted inside
the sequence (that will lead to error messages and will NOT
provide the intended result).</p>

<p style="margin-left:11%; margin-top: 1em"><b>Property
Options</b> <br>
Property options are case-insensitive. Currently, the
following options are defined: <br>
uppercase</p>

<p style="margin-left:22%;">convert property to lowercase
only</p>

<p style="margin-left:11%;">lowercase</p>

<p style="margin-left:22%;">convert property text to
uppercase only</p>

<p style="margin-left:11%;">drop-last-lf</p>

<p style="margin-left:22%;">The last LF in the message (if
any), is dropped. Especially useful for PIX.</p>

<p style="margin-left:11%;">date-mysql</p>

<p style="margin-left:22%;">format as mysql date</p>

<p style="margin-left:11%;">date-rfc3164</p>

<p style="margin-left:22%;">format as RFC 3164 date</p>

<p style="margin-left:11%;">date-rfc3339</p>

<p style="margin-left:22%;">format as RFC 3339 date</p>

<p style="margin-left:11%;">escape-cc</p>

<p style="margin-left:22%;">replace control characters
(ASCII value 127 and values less then 32) with an escape
sequence. The sequence is &quot;#&lt;charval&gt;&quot; where
charval is the 3-digit decimal value of the control
character. For example, a tabulator would be replaced by
&quot;#009&quot;.</p>

<p style="margin-left:11%;">space-cc</p>

<p style="margin-left:22%;">replace control characters by
spaces</p>

<p style="margin-left:11%;">drop-cc</p>

<p style="margin-left:22%;">drop control characters - the
resulting string will neither contain control characters,
escape sequences nor any other replacement character like
space.</p>

<h2>QUEUED OPERATIONS
<a name="QUEUED OPERATIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Rsyslogd
supports queued operations to handle offline outputs (like
remote syslogd&rsquo;s or database servers being down). When
running in queued mode, rsyslogd buffers messages to memory
and optionally to disk (on an as-needed basis). Queues
survive rsyslogd restarts.</p>

<p style="margin-left:11%; margin-top: 1em">It is highly
suggested to use remote forwarding and database writing in
queued mode, only.</p>

<p style="margin-left:11%; margin-top: 1em">To learn more
about queued operations, see the html documentation.</p>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>/etc/rsyslog.conf</i></p>

<p style="margin-left:22%;">Configuration file for
<b>rsyslogd</b></p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>rsyslogd</b>(8),
<b>logger</b>(1), <b>syslog</b>(3)</p>

<p style="margin-left:11%; margin-top: 1em">The complete
documentation can be found in the doc folder of the rsyslog
distribution or online at</p>


<p style="margin-left:22%; margin-top: 1em"><b>http://www.rsyslog.com/doc</b></p>

<p style="margin-left:11%; margin-top: 1em">Please note
that the man page reflects only a subset of the
configuration options. Be sure to read the html
documentation for all features and details. This is
especially vital if you plan to set up a
more-then-extremely-simple system.</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>rsyslogd</b>
is taken from sysklogd sources, which have been heavily
modified by Rainer Gerhards (rgerhards@adiscon.com) and
others.</p>
<hr>
</body>
</html>
