<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:00:31 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>VIRT-WHAT</title>

</head>
<body>

<h1 align="center">VIRT-WHAT</h1>

<a href="#NAME">NAME</a><br>
<a href="#SUMMARY">SUMMARY</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#FACTS">FACTS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#RUNNING VIRT-WHAT FROM OTHER PROGRAMS">RUNNING VIRT-WHAT FROM OTHER PROGRAMS</a><br>
<a href="#IMPORTANT NOTE">IMPORTANT NOTE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHORS">AUTHORS</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>
<a href="#REPORTING BUGS">REPORTING BUGS</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">virt&minus;what
&minus; detect if we are running in a virtual machine</p>

<h2>SUMMARY
<a name="SUMMARY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">virt-what
[options]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><tt>&quot;virt&minus;what&quot;</tt>
is a shell script which can be used to detect if the program
is running in a virtual machine.</p>

<p style="margin-left:11%; margin-top: 1em">The program
prints out a list of &quot;facts&quot; about the virtual
machine, derived from heuristics. One fact is printed per
line.</p>

<p style="margin-left:11%; margin-top: 1em">If nothing is
printed and the script exits with code 0 (no error), then it
can mean <i>either</i> that the program is running on
bare-metal <i>or</i> the program is running inside a type of
virtual machine which we don&rsquo;t know about or cannot
detect.</p>

<h2>FACTS
<a name="FACTS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>docker</b></p>

<p style="margin-left:17%;">This is a Docker container.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by Charles Nguyen</p>

<p style="margin-left:11%;"><b>hyperv</b></p>

<p style="margin-left:17%;">This is Microsoft Hyper-V
hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<p style="margin-left:11%;"><b>ibm_systemz</b></p>

<p style="margin-left:17%;">This is an <small>IBM</small>
SystemZ (or other S/390) hardware partitioning system.
Additional facts listed below may also be printed.</p>


<p style="margin-left:11%;"><b>ibm_systemz&minus;direct</b></p>

<p style="margin-left:17%;">This is Linux running directly
on a <small>IBM</small> SystemZ hardware partitioning
system.</p>

<p style="margin-left:17%; margin-top: 1em">This is
expected to be a highly unusual configuration &minus; if you
see this result you should treat it with suspicion.</p>

<p style="margin-left:17%; margin-top: 1em">Status: not
confirmed</p>


<p style="margin-left:11%;"><b>ibm_systemz&minus;lpar</b></p>

<p style="margin-left:17%;">This is Linux running directly
on an <small>LPAR</small> on an <small>IBM</small> SystemZ
hardware partitioning system.</p>

<p style="margin-left:17%; margin-top: 1em">Status: not
confirmed</p>


<p style="margin-left:11%;"><b>ibm_systemz&minus;zvm</b></p>

<p style="margin-left:17%;">This is a z/VM guest running in
an <small>LPAR</small> on an <small>IBM</small> SystemZ
hardware partitioning system.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small> using a Fedora guest
running in z/VM</p>

<p style="margin-left:11%;"><b>linux_vserver</b></p>

<p style="margin-left:17%;">This is printed for backwards
compatibility with older virt-what which could not
distinguish between a Linux VServer container guest and
host.</p>


<p style="margin-left:11%;"><b>linux_vserver&minus;guest</b></p>

<p style="margin-left:17%;">This process is running in a
Linux VServer container.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by BarXX Metin</p>


<p style="margin-left:11%;"><b>linux_vserver&minus;host</b></p>

<p style="margin-left:17%;">This process is running as the
Linux VServer host (VxID 0).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by BarXX Metin and Elan Ruusamaee</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>lxc</b></p></td>
<td width="2%"></td>
<td width="75%">


<p>This process is running in a Linux <small>LXC</small>
container.</p> </td>
<td width="8%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Marc Fournier</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p style="margin-top: 1em"><b>kvm</b></p></td>
<td width="2%"></td>
<td width="83%">


<p style="margin-top: 1em">This guest is running on the
<small>KVM</small> hypervisor using hardware
acceleration.</p> </td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Note that if
the hypervisor is using software acceleration you should
<i>not</i> see this, but should see the
<tt>&quot;qemu&quot;</tt> fact instead.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ.</small></p>

<p style="margin-left:11%;"><b>lkvm</b></p>

<p style="margin-left:17%;">This guest is running on the
<small>KVM</small> hypervisor using hardware acceleration,
and the userspace component of the hypervisor is lkvm (a.k.a
kvmtool).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Andrew Jones</p>

<p style="margin-left:11%;"><b>openvz</b></p>

<p style="margin-left:17%;">The guest appears to be running
inside an OpenVZ or Virtuozzo container.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Evgeniy Sokolov</p>

<p style="margin-left:11%;"><b>parallels</b></p>

<p style="margin-left:17%;">The guest is running inside
Parallels Virtual Platform (Parallels Desktop, Parallels
Server).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Justin Clift</p>

<p style="margin-left:11%;"><b>powervm_lx86</b></p>

<p style="margin-left:17%;">The guest is running inside
<small>IBM</small> PowerVM Lx86 Linux/x86 emulator.</p>

<p style="margin-left:17%; margin-top: 1em">Status: data
originally supplied by Jeffrey Scheel, confirmed by Yufang
Zhang and <small>RWMJ</small></p>

<p style="margin-left:11%;"><b>qemu</b></p>

<p style="margin-left:17%;">This is <small>QEMU</small>
hypervisor using software emulation.</p>

<p style="margin-left:17%; margin-top: 1em">Note that for
<small>KVM</small> (hardware accelerated) guests you should
<i>not</i> see this.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ.</small></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>uml</b></p></td>
<td width="2%"></td>
<td width="58%">


<p>This is a User-Mode Linux ( <small>UML</small> )
guest.</p> </td>
<td width="25%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Laurent Leonard</p>

<p style="margin-left:11%;"><b>virt</b></p>

<p style="margin-left:17%;">Some sort of virtualization
appears to be present, but we are not sure what it is. In
some very rare corner cases where we know that
virtualization is hard to detect, we will try a timing
attack to see if certain machine instructions are running
much more slowly than they should be, which would indicate
virtualization. In this case, the generic fact
<tt>&quot;virt&quot;</tt> is printed.</p>

<p style="margin-left:11%;"><b>virtage</b></p>

<p style="margin-left:17%;">This is Hitachi Virtualization
Manager ( <small>HVM</small> ) Virtage hardware partitioning
system.</p>

<p style="margin-left:17%; margin-top: 1em">Status: data
supplied by Bhavna Sarathy, not confirmed</p>

<p style="margin-left:11%;"><b>virtualbox</b></p>

<p style="margin-left:17%;">This is a VirtualBox guest.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
contributed by Laurent Leonard</p>

<p style="margin-left:11%;"><b>virtualpc</b></p>

<p style="margin-left:17%;">The guest appears to be running
on Microsoft VirtualPC.</p>

<p style="margin-left:17%; margin-top: 1em">Status: not
confirmed</p>

<p style="margin-left:11%;"><b>vmware</b></p>

<p style="margin-left:17%;">The guest appears to be running
on VMware hypervisor.</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p><b>xen</b></p></td>
<td width="2%"></td>
<td width="77%">


<p>The guest appears to be running on Xen hypervisor.</p></td>
<td width="6%">
</td></tr>
</table>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<p style="margin-left:11%;"><b>xen&minus;dom0</b></p>

<p style="margin-left:17%;">This is the Xen dom0
(privileged domain).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<p style="margin-left:11%;"><b>xen-domU</b></p>

<p style="margin-left:17%;">This is a Xen domU
(paravirtualized guest domain).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<p style="margin-left:11%;"><b>xen-hvm</b></p>

<p style="margin-left:17%;">This is a Xen guest fully
virtualized ( <small>HVM</small> ).</p>

<p style="margin-left:17%; margin-top: 1em">Status:
confirmed by <small>RWMJ</small></p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Programs that
use or wrap <tt>&quot;virt&minus;what&quot;</tt> should
check that the exit status is 0 before they attempt to parse
the output of the command.</p>

<p style="margin-left:11%; margin-top: 1em">A non-zero exit
status indicates some error, for example, an unrecognized
command line argument. If the exit status is non-zero then
the output &quot;facts&quot; (if any were printed) cannot be
guaranteed and should be ignored.</p>

<p style="margin-left:11%; margin-top: 1em">The exit status
does <i>not</i> have anything to do with whether the program
is running on baremetal or under virtualization, nor with
whether <tt>&quot;virt&minus;what&quot;</tt> managed
detection &quot;correctly&quot; (which is basically
unknowable given the large variety of virtualization systems
out there and that some systems deliberately emulate
others).</p>

<h2>RUNNING VIRT-WHAT FROM OTHER PROGRAMS
<a name="RUNNING VIRT-WHAT FROM OTHER PROGRAMS"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><tt>&quot;virt&minus;what&quot;</tt>
is designed so that you can easily run it from other
programs or wrap it up in a library.</p>

<p style="margin-left:11%; margin-top: 1em">Your program
should check the exit status (see the section above).</p>

<p style="margin-left:11%; margin-top: 1em">Some
programming languages (notably Python: issue 1652)
erroneously mask the <tt>&quot;SIGPIPE&quot;</tt> signal and
do not restore it when executing subprocesses.
<tt>&quot;virt&minus;what&quot;</tt> is a shell script and
some shell commands do not work correctly when you do this.
You may see warnings from
<tt>&quot;virt&minus;what&quot;</tt> similar to this:</p>

<pre style="margin-left:11%; margin-top: 1em"> echo: write error: Broken pipe</pre>


<p style="margin-left:11%; margin-top: 1em">The solution is
to set the <tt>&quot;SIGPIPE&quot;</tt> signal handler back
to <tt>&quot;SIG_DFL&quot;</tt> before running
<tt>&quot;virt&minus;what&quot;</tt>.</p>

<h2>IMPORTANT NOTE
<a name="IMPORTANT NOTE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Most of the
time, using this program is the <i>wrong</i> thing to do.
Instead you should detect the specific features you actually
want to use. (As an example, if you wanted to issue Xen
hypervisor commands you would look for the
<tt>&quot;/proc/xen/privcmd&quot;</tt> file).</p>

<p style="margin-left:11%; margin-top: 1em">However people
keep asking for this, so we provide it. There are a few
legitimate uses: <br>
Bug reporting tool</p>

<p style="margin-left:17%;">If you think that
virtualization could affect how your program runs, then you
might use <tt>&quot;virt&minus;what&quot;</tt> to report
this in a bug reporting tool.</p>

<p style="margin-left:11%;">Status display and monitoring
tools</p>

<p style="margin-left:17%;">You might include this
information in status and monitoring programs.</p>

<p style="margin-left:11%;">System tuning (sometimes)</p>

<p style="margin-left:17%;">You might use this program to
tune an operating system so it runs better as a virtual
machine of a particular hypervisor. However if installing
paravirtualized drivers, it&rsquo;s better to check for the
specific features your drivers need (eg. for the presence of
<small>PCI</small> devices).</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">&lt;http://people.redhat.com/~rjones/virt&minus;what/&gt;,
&lt;http://www.vmware.com/&gt;,
&lt;http://www.microsoft.com/windows/products/winfamily/virtualpc&gt;,
&lt;http://xensource.com/&gt;,
&lt;http://bellard.org/qemu/&gt;,
&lt;http://kvm.qumranet.com/&gt;,
&lt;http://openvz.org/&gt;</p>

<h2>AUTHORS
<a name="AUTHORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Richard W.M.
Jones &lt;rjones @ redhat . com&gt;</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">(C) Copyright
2008&minus;2011 Red Hat Inc.,
&lt;http://people.redhat.com/~rjones/virt&minus;what/&gt;</p>

<p style="margin-left:11%; margin-top: 1em">This program is
free software; you can redistribute it and/or modify it
under the terms of the <small>GNU</small> General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>

<p style="margin-left:11%; margin-top: 1em">This program is
distributed in the hope that it will be useful, but
<small>WITHOUT ANY WARRANTY</small> ; without even the
implied warranty of <small>MERCHANTABILITY</small> or
<small>FITNESS FOR A PARTICULAR PURPOSE.</small> See the
<small>GNU</small> General Public License for more
details.</p>

<p style="margin-left:11%; margin-top: 1em">You should have
received a copy of the <small>GNU</small> General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 675 Mass Ave, Cambridge,
<small>MA 02139, USA.</small></p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Bugs can be
viewed on the Red Hat Bugzilla page:
&lt;https://bugzilla.redhat.com/&gt;.</p>

<p style="margin-left:11%; margin-top: 1em">If you find a
bug in virt-what, please follow these steps to report it:
<br>
1. Check for existing bug reports</p>

<p style="margin-left:17%;">Go to
&lt;https://bugzilla.redhat.com/&gt; and search for similar
bugs. Someone may already have reported the same bug, and
they may even have fixed it.</p>

<p style="margin-left:11%;">2. Capture debug and error
messages</p>

<p style="margin-left:17%;">Run</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;what &gt; virt&minus;what.log 2&gt;&amp;1</pre>


<p style="margin-left:17%; margin-top: 1em">and keep
<i>virt&minus;what.log</i>. It may contain error messages
which you should submit with your bug report.</p>

<p style="margin-left:11%;">3. Get version of
virt-what.</p>

<p style="margin-left:17%;">Run</p>

<pre style="margin-left:17%; margin-top: 1em"> virt&minus;what &minus;&minus;version</pre>


<p style="margin-left:11%;">4. Submit a bug report.</p>

<p style="margin-left:17%;">Go to
&lt;https://bugzilla.redhat.com/&gt; and enter a new bug.
Please describe the problem in as much detail as
possible.</p>

<p style="margin-left:17%; margin-top: 1em">Remember to
include the version numbers (step 3) and the debug messages
file (step 2) and as much other detail as possible.</p>

<p style="margin-left:11%;">5. Assign the bug to rjones @
redhat.com</p>

<p style="margin-left:17%;">Assign or reassign the bug to
<b>rjones @ redhat.com</b> (without the spaces). You can
also send me an email with the bug number if you want a
faster response.</p>
<hr>
</body>
</html>
