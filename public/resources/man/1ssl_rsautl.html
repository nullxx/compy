<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:01:20 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>RSAUTL</title>

</head>
<body>

<h1 align="center">RSAUTL</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#COMMAND OPTIONS">COMMAND OPTIONS</a><br>
<a href="#NOTES">NOTES</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">rsautl &minus;
RSA utility</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>openssl
rsautl</b> [<b>&minus;in file</b>] [<b>&minus;out file</b>]
[<b>&minus;inkey file</b>] [<b>&minus;pubin</b>]
[<b>&minus;certin</b>] [<b>&minus;sign</b>]
[<b>&minus;verify</b>] [<b>&minus;encrypt</b>]
[<b>&minus;decrypt</b>] [<b>&minus;pkcs</b>]
[<b>&minus;ssl</b>] [<b>&minus;raw</b>]
[<b>&minus;hexdump</b>] [<b>&minus;asn1parse</b>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>rsautl</b> command can be used to sign, verify, encrypt
and decrypt data using the <small>RSA</small> algorithm.</p>

<h2>COMMAND OPTIONS
<a name="COMMAND OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>&minus;in
filename</b></p>

<p style="margin-left:17%;">This specifies the input
filename to read data from or standard input if this option
is not specified.</p>

<p style="margin-left:11%;"><b>&minus;out filename</b></p>

<p style="margin-left:17%;">specifies the output filename
to write to or standard output by default.</p>

<p style="margin-left:11%;"><b>&minus;inkey file</b></p>

<p style="margin-left:17%;">the input key file, by default
it should be an <small>RSA</small> private key.</p>

<p style="margin-left:11%;"><b>&minus;pubin</b></p>

<p style="margin-left:17%;">the input file is an
<small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>&minus;certin</b></p>

<p style="margin-left:17%;">the input is a certificate
containing an <small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>&minus;sign</b></p>

<p style="margin-left:17%;">sign the input data and output
the signed result. This requires and <small>RSA</small>
private key.</p>

<p style="margin-left:11%;"><b>&minus;verify</b></p>

<p style="margin-left:17%;">verify the input data and
output the recovered data.</p>

<p style="margin-left:11%;"><b>&minus;encrypt</b></p>

<p style="margin-left:17%;">encrypt the input data using an
<small>RSA</small> public key.</p>

<p style="margin-left:11%;"><b>&minus;decrypt</b></p>

<p style="margin-left:17%;">decrypt the input data using an
<small>RSA</small> private key.</p>

<p style="margin-left:11%;"><b>&minus;pkcs, &minus;oaep,
&minus;ssl, &minus;raw</b></p>

<p style="margin-left:17%;">the padding to use: PKCS#1 v1.5
(the default), PKCS#1 <small>OAEP,</small> special padding
used in <small>SSL</small> v2 backwards compatible
handshakes, or no padding, respectively. For signatures,
only <b>&minus;pkcs</b> and <b>&minus;raw</b> can be
used.</p>

<p style="margin-left:11%;"><b>&minus;hexdump</b></p>

<p style="margin-left:17%;">hex dump the output data.</p>

<p style="margin-left:11%;"><b>&minus;asn1parse</b></p>

<p style="margin-left:17%;">asn1parse the output data, this
is useful when combined with the <b>&minus;verify</b>
option.</p>

<h2>NOTES
<a name="NOTES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>rsautl</b>
because it uses the <small>RSA</small> algorithm directly
can only be used to sign or verify small pieces of data.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Sign some data
using a private key:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl rsautl &minus;sign &minus;in file &minus;inkey key.pem &minus;out sig</pre>


<p style="margin-left:11%; margin-top: 1em">Recover the
signed data</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl rsautl &minus;verify &minus;in sig &minus;inkey key.pem</pre>


<p style="margin-left:11%; margin-top: 1em">Examine the raw
signed data:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl rsautl &minus;verify &minus;in file &minus;inkey key.pem &minus;raw &minus;hexdump
 0000 &minus; 00 01 ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0010 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0020 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0030 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0040 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0050 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0060 &minus; ff ff ff ff ff ff ff ff&minus;ff ff ff ff ff ff ff ff   ................
 0070 &minus; ff ff ff ff 00 68 65 6c&minus;6c 6f 20 77 6f 72 6c 64   .....hello world</pre>


<p style="margin-left:11%; margin-top: 1em">The PKCS#1
block formatting is evident from this. If this was done
using encrypt and decrypt the block would have been of type
2 (the second byte) and random padding data visible instead
of the 0xff bytes.</p>

<p style="margin-left:11%; margin-top: 1em">It is possible
to analyse the signature of certificates using this utility
in conjunction with <b>asn1parse</b>. Consider the self
signed example in certs/pca&minus;cert.pem . Running
<b>asn1parse</b> as follows yields:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl asn1parse &minus;in pca&minus;cert.pem
    0:d=0  hl=4 l= 742 cons: SEQUENCE
    4:d=1  hl=4 l= 591 cons:  SEQUENCE
    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]
   10:d=3  hl=2 l=   1 prim:    INTEGER           :02
   13:d=2  hl=2 l=   1 prim:   INTEGER           :00
   16:d=2  hl=2 l=  13 cons:   SEQUENCE
   18:d=3  hl=2 l=   9 prim:    OBJECT            :md5WithRSAEncryption
   29:d=3  hl=2 l=   0 prim:    NULL
   31:d=2  hl=2 l=  92 cons:   SEQUENCE
   33:d=3  hl=2 l=  11 cons:    SET
   35:d=4  hl=2 l=   9 cons:     SEQUENCE
   37:d=5  hl=2 l=   3 prim:      OBJECT            :countryName
   42:d=5  hl=2 l=   2 prim:      PRINTABLESTRING   :AU
  ....
  599:d=1  hl=2 l=  13 cons:  SEQUENCE
  601:d=2  hl=2 l=   9 prim:   OBJECT            :md5WithRSAEncryption
  612:d=2  hl=2 l=   0 prim:   NULL
  614:d=1  hl=3 l= 129 prim:  BIT STRING</pre>


<p style="margin-left:11%; margin-top: 1em">The final
<small>BIT STRING</small> contains the actual signature. It
can be extracted with:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl asn1parse &minus;in pca&minus;cert.pem &minus;out sig &minus;noout &minus;strparse 614</pre>


<p style="margin-left:11%; margin-top: 1em">The certificate
public key can be extracted with:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl x509 &minus;in test/testx509.pem &minus;pubkey &minus;noout &gt;pubkey.pem</pre>


<p style="margin-left:11%; margin-top: 1em">The signature
can be analysed with:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl rsautl &minus;in sig &minus;verify &minus;asn1parse &minus;inkey pubkey.pem &minus;pubin
    0:d=0  hl=2 l=  32 cons: SEQUENCE
    2:d=1  hl=2 l=  12 cons:  SEQUENCE
    4:d=2  hl=2 l=   8 prim:   OBJECT            :md5
   14:d=2  hl=2 l=   0 prim:   NULL
   16:d=1  hl=2 l=  16 prim:  OCTET STRING
      0000 &minus; f3 46 9e aa 1a 4a 73 c9&minus;37 ea 93 00 48 25 08 b5   .F...Js.7...H%..</pre>


<p style="margin-left:11%; margin-top: 1em">This is the
parsed version of an <small>ASN1</small> DigestInfo
structure. It can be seen that the digest used was md5. The
actual part of the certificate that was signed can be
extracted with:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl asn1parse &minus;in pca&minus;cert.pem &minus;out tbs &minus;noout &minus;strparse 4</pre>


<p style="margin-left:11%; margin-top: 1em">and its digest
computed with:</p>

<pre style="margin-left:11%; margin-top: 1em"> openssl md5 &minus;c tbs
 MD5(tbs)= f3:46:9e:aa:1a:4a:73:c9:37:ea:93:00:48:25:08:b5</pre>


<p style="margin-left:11%; margin-top: 1em">which it can be
seen agrees with the recovered value above.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>dgst</i>(1),
<i>rsa</i>(1), <i>genrsa</i>(1)</p>
<hr>
</body>
</html>
