<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:03:44 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Tcl_SetResult</title>

</head>
<body>

<h1 align="center">Tcl_SetResult</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#ARGUMENTS">ARGUMENTS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OLD STRING PROCEDURES">OLD STRING PROCEDURES</a><br>
<a href="#DIRECT ACCESS TO INTERP-&gt;RESULT IS DEPRECATED">DIRECT ACCESS TO INTERP-&gt;RESULT IS DEPRECATED</a><br>
<a href="#THE TCL_FREEPROC ARGUMENT TO TCL_SETRESULT">THE TCL_FREEPROC ARGUMENT TO TCL_SETRESULT</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#KEYWORDS">KEYWORDS</a><br>

<hr>



<p>______________________________________________________________________________</p>

<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Tcl_SetObjResult,
Tcl_GetObjResult, Tcl_SetResult, Tcl_GetStringResult,
Tcl_AppendResult, Tcl_AppendResultVA, Tcl_AppendElement,
Tcl_ResetResult, Tcl_FreeResult &minus; manipulate Tcl
result</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;tcl.h&gt;</b></p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_SetObjResult</b>(<i>interp,
objPtr</i>)</p>

<p style="margin-left:11%; margin-top: 1em">Tcl_Obj *
<b><br>
Tcl_GetObjResult</b>(<i>interp</i>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_SetResult</b>(<i>interp,
result, freeProc</i>)</p>

<p style="margin-left:11%; margin-top: 1em">const char *
<b><br>
Tcl_GetStringResult</b>(<i>interp</i>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendResult</b>(<i>interp,
result, result, ... ,</i> <b>(char *) NULL</b>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendResultVA</b>(<i>interp,
argList</i>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendElement</b>(<i>interp,
element</i>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_ResetResult</b>(<i>interp</i>)</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_FreeResult</b>(<i>interp</i>)</p>

<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p style="margin-top: 1em">Tcl_Interp <i>*interp</i>
(out)</p> </td>
<td width="14%"></td>
<td width="34%">


<p style="margin-top: 1em">Interpreter whose result is to
be modified or read.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p>Tcl_Obj <i>*objPtr</i> (in)</p></td>
<td width="14%"></td>
<td width="34%">


<p>Object value to become result for <i>interp</i>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p>char <i>*result</i> (in)</p></td>
<td width="14%"></td>
<td width="34%">


<p>String value to become result for <i>interp</i> or to be
appended to the existing result.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p>char <i>*element</i> (in)</p></td>
<td width="14%"></td>
<td width="34%">


<p>String value to append as a list element to the existing
result of <i>interp</i>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p>Tcl_FreeProc <i>*freeProc</i> (in)</p></td>
<td width="14%"></td>
<td width="34%">


<p>Address of procedure to call to release storage at
<i>result</i>, or <b>TCL_STATIC</b>, <b>TCL_DYNAMIC</b>, or
<b>TCL_VOLATILE</b>.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="41%">


<p>va_list <i>argList</i> (in)</p></td>
<td width="14%"></td>
<td width="34%">


<p>An argument list which must have been initialized using
<b>va_start</b>, and cleared using <b>va_end</b>.</p></td></tr>
</table>


<p style="margin-left:66%;">_________________________________________________________________</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The procedures
described here are utilities for manipulating the result
value in a Tcl interpreter. The interpreter result may be
either a Tcl object or a string. For example,
<b>Tcl_SetObjResult</b> and <b>Tcl_SetResult</b> set the
interpreter result to, respectively, an object and a string.
Similarly, <b>Tcl_GetObjResult</b> and
<b>Tcl_GetStringResult</b> return the interpreter result as
an object and as a string. The procedures always keep the
string and object forms of the interpreter result
consistent. For example, if <b>Tcl_SetObjResult</b> is
called to set the result to an object, then
<b>Tcl_GetStringResult</b> is called, it will return the
object&rsquo;s string value.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_SetObjResult</b>
arranges for <i>objPtr</i> to be the result for
<i>interp</i>, replacing any existing result. The result is
left pointing to the object referenced by <i>objPtr</i>.
<i>objPtr</i>&rsquo;s reference count is incremented since
there is now a new reference to it from <i>interp</i>. The
reference count for any old result object is decremented and
the old result object is freed if no references to it
remain.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_GetObjResult</b>
returns the result for <i>interp</i> as an object. The
object&rsquo;s reference count is not incremented; if the
caller needs to retain a long-term pointer to the object
they should use <b>Tcl_IncrRefCount</b> to increment its
reference count in order to keep it from being freed too
early or accidentally changed.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_SetResult</b>
arranges for <i>result</i> to be the result for the current
Tcl command in <i>interp</i>, replacing any existing result.
The <i>freeProc</i> argument specifies how to manage the
storage for the <i>result</i> argument; it is discussed in
the section <b>THE TCL_FREEPROC ARGUMENT TO
TCL_SETRESULT</b> below. If <i>result</i> is <b>NULL</b>,
then <i>freeProc</i> is ignored and <b>Tcl_SetResult</b>
re-initializes <i>interp</i>&rsquo;s result to point to an
empty string.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_GetStringResult</b>
returns the result for <i>interp</i> as a string. If the
result was set to an object by a <b>Tcl_SetObjResult</b>
call, the object form will be converted to a string and
returned. If the object&rsquo;s string representation
contains null bytes, this conversion will lose information.
For this reason, programmers are encouraged to write their
code to use the new object API procedures and to call
<b>Tcl_GetObjResult</b> instead.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_ResetResult</b>
clears the result for <i>interp</i> and leaves the result in
its normal empty initialized state. If the result is an
object, its reference count is decremented and the result is
left pointing to an unshared object representing an empty
string. If the result is a dynamically allocated string, its
memory is free*d and the result is left as a empty string.
<b>Tcl_ResetResult</b> also clears the error state managed
by <b>Tcl_AddErrorInfo</b>, <b>Tcl_AddObjErrorInfo</b>, and
<b>Tcl_SetErrorCode</b>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendResult</b>
makes it easy to build up Tcl results in pieces. It takes
each of its <i>result</i> arguments and appends them in
order to the current result associated with <i>interp</i>.
If the result is in its initialized empty state (e.g. a
command procedure was just invoked or <b>Tcl_ResetResult</b>
was just called), then <b>Tcl_AppendResult</b> sets the
result to the concatenation of its <i>result</i> arguments.
<b>Tcl_AppendResult</b> may be called repeatedly as
additional pieces of the result are produced.
<b>Tcl_AppendResult</b> takes care of all the storage
management issues associated with managing
<i>interp</i>&rsquo;s result, such as allocating a larger
result area if necessary. It also manages conversion to and
from the <i>result</i> field of the <i>interp</i> so as to
handle backward-compatibility with old-style extensions. Any
number of <i>result</i> arguments may be passed in a single
call; the last argument in the list must be a NULL
pointer.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendResultVA</b>
is the same as <b>Tcl_AppendResult</b> except that instead
of taking a variable number of arguments it takes an
argument list.</p>

<h2>OLD STRING PROCEDURES
<a name="OLD STRING PROCEDURES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Use of the
following procedures (is deprecated since they manipulate
the Tcl result as a string. Procedures such as
<b>Tcl_SetObjResult</b> that manipulate the result as an
object can be significantly more efficient.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_AppendElement</b>
is similar to <b>Tcl_AppendResult</b> in that it allows
results to be built up in pieces. However,
<b>Tcl_AppendElement</b> takes only a single <i>element</i>
argument and it appends that argument to the current result
as a proper Tcl list element. <b>Tcl_AppendElement</b> adds
backslashes or braces if necessary to ensure that
<i>interp</i>&rsquo;s result can be parsed as a list and
that <i>element</i> will be extracted as a single element.
Under normal conditions, <b>Tcl_AppendElement</b> will add a
space character to <i>interp</i>&rsquo;s result just before
adding the new list element, so that the list elements in
the result are properly separated. However if the new list
element is the first in a list or sub-list (i.e.
<i>interp</i>&rsquo;s current result is empty, or consists
of the single character &ldquo;{&rdquo;, or ends in the
characters &ldquo; {&rdquo;) then no space is added.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_FreeResult</b>
performs part of the work of <b>Tcl_ResetResult</b>. It
frees up the memory associated with <i>interp</i>&rsquo;s
result. It also sets <i>interp-&gt;freeProc</i> to zero, but
does not change <i>interp-&gt;result</i> or clear error
state. <b>Tcl_FreeResult</b> is most commonly used when a
procedure is about to replace one result value with
another.</p>

<h2>DIRECT ACCESS TO INTERP-&gt;RESULT IS DEPRECATED
<a name="DIRECT ACCESS TO INTERP-&gt;RESULT IS DEPRECATED"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">It used to be
legal for programs to directly read and write
<i>interp-&gt;result</i> to manipulate the interpreter
result. Direct access to <i>interp-&gt;result</i> is now
strongly deprecated because it can make the result&rsquo;s
string and object forms inconsistent. Programs should always
read the result using the procedures <b>Tcl_GetObjResult</b>
or <b>Tcl_GetStringResult</b>, and write the result using
<b>Tcl_SetObjResult</b> or <b>Tcl_SetResult</b>.</p>

<h2>THE TCL_FREEPROC ARGUMENT TO TCL_SETRESULT
<a name="THE TCL_FREEPROC ARGUMENT TO TCL_SETRESULT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Tcl_SetResult</b>&rsquo;s
<i>freeProc</i> argument specifies how the Tcl system is to
manage the storage for the <i>result</i> argument. If
<b>Tcl_SetResult</b> or <b>Tcl_SetObjResult</b> are called
at a time when <i>interp</i> holds a string result, they do
whatever is necessary to dispose of the old string result
(see the <b>Tcl_Interp</b> manual entry for details on
this).</p>

<p style="margin-left:11%; margin-top: 1em">If
<i>freeProc</i> is <b>TCL_STATIC</b> it means that
<i>result</i> refers to an area of static storage that is
guaranteed not to be modified until at least the next call
to <b>Tcl_Eval</b>. If <i>freeProc</i> is <b>TCL_DYNAMIC</b>
it means that <i>result</i> was allocated with a call to
<b>Tcl_Alloc</b> and is now the property of the Tcl system.
<b>Tcl_SetResult</b> will arrange for the string&rsquo;s
storage to be released by calling <b>Tcl_Free</b> when it is
no longer needed. If <i>freeProc</i> is <b>TCL_VOLATILE</b>
it means that <i>result</i> points to an area of memory that
is likely to be overwritten when <b>Tcl_SetResult</b>
returns (e.g. it points to something in a stack frame). In
this case <b>Tcl_SetResult</b> will make a copy of the
string in dynamically allocated storage and arrange for the
copy to be the result for the current Tcl command.</p>

<p style="margin-left:11%; margin-top: 1em">If
<i>freeProc</i> is not one of the values <b>TCL_STATIC</b>,
<b>TCL_DYNAMIC</b>, and <b>TCL_VOLATILE</b>, then it is the
address of a procedure that Tcl should call to free the
string. This allows applications to use non-standard storage
allocators. When Tcl no longer needs the storage for the
string, it will call <i>freeProc</i>. <i>FreeProc</i> should
have arguments and result that match the type
<b>Tcl_FreeProc</b>:</p>

<p style="margin-left:22%;">typedef void Tcl_FreeProc(char
*<i>blockPtr</i>);</p>

<p style="margin-left:11%;">When <i>freeProc</i> is called,
its <i>blockPtr</i> will be set to the value of
<i>result</i> passed to <b>Tcl_SetResult</b>.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Tcl_AddErrorInfo,
Tcl_CreateObjCommand, Tcl_SetErrorCode, Tcl_Interp</p>

<h2>KEYWORDS
<a name="KEYWORDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">append,
command, element, list, object, result, return value,
interpreter</p>
<hr>
</body>
</html>
