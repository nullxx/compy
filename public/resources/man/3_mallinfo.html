<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:08:47 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>MALLINFO</title>

</head>
<body>

<h1 align="center">MALLINFO</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#CONFORMING TO">CONFORMING TO</a><br>
<a href="#BUGS">BUGS</a><br>
<a href="#EXAMPLE">EXAMPLE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COLOPHON">COLOPHON</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">mallinfo
&minus; obtain memory allocation information</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;malloc.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>struct
mallinfo mallinfo(void);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The
<b>mallinfo</b>() function returns a copy of a structure
containing information about memory allocations performed by
<b>malloc</b>(3) and related functions. This structure is
defined as follows:</p>

<p style="margin-left:17%; margin-top: 1em">struct mallinfo
{ <br>
int arena; /* Non-mmapped space allocated (bytes) */ <br>
int ordblks; /* Number of free chunks */ <br>
int smblks; /* Number of free fastbin blocks */ <br>
int hblks; /* Number of mmapped regions */ <br>
int hblkhd; /* Space allocated in mmapped regions (bytes) */
<br>
int usmblks; /* Maximum total allocated space (bytes) */
<br>
int fsmblks; /* Space in freed fastbin blocks (bytes) */
<br>
int uordblks; /* Total allocated space (bytes) */ <br>
int fordblks; /* Total free space (bytes) */ <br>
int keepcost; /* Top-most, releasable space (bytes) */ <br>
};</p>

<p style="margin-left:11%; margin-top: 1em">The fields of
the <i>mallinfo</i> structure contain the following
information:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>arena</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The total amount of memory allocated by means other than
<b>mmap</b>(2) (i.e., memory allocated on the heap). This
figure includes both in-use blocks and blocks on the free
list.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>ordblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The number of ordinary (i.e., non-fastbin) free
blocks.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>smblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The number of fastbin free blocks (see
<b>mallopt</b>(3)).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>hblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The number of blocks currently allocated using
<b>mmap</b>(2). (See the discussion of
<b>M_MMAP_THRESHOLD</b> in <b>mallopt</b>(3).)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>hblkhd</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The number of bytes in blocks currently allocated using
<b>mmap</b>(2).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>usmblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The &quot;highwater mark&quot; for allocated
space&mdash;that is, the maximum amount of space that was
ever allocated. This field is maintained only in
nonthreading environments.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>fsmblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The total number of bytes in fastbin free blocks.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>uordblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The total number of bytes used by in-use
allocations.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>fordblks</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The total number of bytes in free blocks.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="12%">


<p><i>keepcost</i></p></td>
<td width="3%"></td>
<td width="74%">


<p>The total amount of releasable free space at the top of
the heap. This is the maximum number of bytes that could
ideally (i.e., ignoring page alignment restrictions, and so
on) be released by <b>malloc_trim</b>(3).</p></td></tr>
</table>

<h2>CONFORMING TO
<a name="CONFORMING TO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This function
is not specified by POSIX or the C standards. A similar
function exists on many System V derivatives, and was
specified in the SVID.</p>

<h2>BUGS
<a name="BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>Information
is returned for only the main memory allocation area.</b>
Allocations in other arenas are excluded. See
<b>malloc_stats</b>(3) and <b>malloc_info</b>(3) for
alternatives that include information about other
arenas.</p>

<p style="margin-left:11%; margin-top: 1em">The fields of
the <i>mallinfo</i> structure are typed as <i>int</i>.
However, because some internal bookkeeping values may be of
type <i>long</i>, the reported values may wrap around zero
and thus be inaccurate.</p>

<h2>EXAMPLE
<a name="EXAMPLE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The program
below employs <b>mallinfo</b>() to retrieve memory
allocation statistics before and after allocating and
freeing some blocks of memory. The statistics are displayed
on standard output.</p>

<p style="margin-left:11%; margin-top: 1em">The first two
command-line arguments specify the number and size of blocks
to be allocated with <b>malloc</b>(3).</p>

<p style="margin-left:11%; margin-top: 1em">The remaining
three arguments specify which of the allocated blocks should
be freed with <b>free</b>(3). These three arguments are
optional, and specify (in order): the step size to be used
in the loop that frees blocks (the default is 1, meaning
free all blocks in the range); the ordinal position of the
first block to be freed (default 0, meaning the first
allocated block); and a number one greater than the ordinal
position of the last block to be freed (default is one
greater than the maximum block number). If these three
arguments are omitted, then the defaults cause all allocated
blocks to be freed.</p>

<p style="margin-left:11%; margin-top: 1em">In the
following example run of the program, 1000 allocations of
100 bytes are performed, and then every second allocated
block is freed:</p>

<p style="margin-left:17%; margin-top: 1em">$ <b>./a.out
1000 100 2</b> <br>
============== Before allocating blocks ============== <br>
Total non&minus;mmapped bytes (arena): 0 <br>
# of free chunks (ordblks): 1 <br>
# of free fastbin blocks (smblks): 0 <br>
# of mapped regions (hblks): 0 <br>
Bytes in mapped regions (hblkhd): 0 <br>
Max. total allocated space (usmblks): 0 <br>
Free bytes held in fastbins (fsmblks): 0 <br>
Total allocated space (uordblks): 0 <br>
Total free space (fordblks): 0 <br>
Topmost releasable block (keepcost): 0</p>

<p style="margin-left:17%; margin-top: 1em">==============
After allocating blocks ============== <br>
Total non&minus;mmapped bytes (arena): 135168 <br>
# of free chunks (ordblks): 1 <br>
# of free fastbin blocks (smblks): 0 <br>
# of mapped regions (hblks): 0 <br>
Bytes in mapped regions (hblkhd): 0 <br>
Max. total allocated space (usmblks): 0 <br>
Free bytes held in fastbins (fsmblks): 0 <br>
Total allocated space (uordblks): 104000 <br>
Total free space (fordblks): 31168 <br>
Topmost releasable block (keepcost): 31168</p>

<p style="margin-left:17%; margin-top: 1em">==============
After freeing blocks ============== <br>
Total non&minus;mmapped bytes (arena): 135168 <br>
# of free chunks (ordblks): 501 <br>
# of free fastbin blocks (smblks): 0 <br>
# of mapped regions (hblks): 0 <br>
Bytes in mapped regions (hblkhd): 0 <br>
Max. total allocated space (usmblks): 0 <br>
Free bytes held in fastbins (fsmblks): 0 <br>
Total allocated space (uordblks): 52000 <br>
Total free space (fordblks): 83168 <br>
Topmost releasable block (keepcost): 31168</p>

<p style="margin-left:11%; margin-top: 1em"><b>Program
source</b> <br>
#include &lt;malloc.h&gt; <br>
#include &quot;tlpi_hdr.h&quot;</p>

<p style="margin-left:11%; margin-top: 1em">static void
<br>
display_mallinfo(void) <br>
{ <br>
struct mallinfo mi;</p>

<p style="margin-left:11%; margin-top: 1em">mi =
mallinfo();</p>


<p style="margin-left:11%; margin-top: 1em">printf(&quot;Total
non&minus;mmapped bytes (arena): %d\n&quot;, mi.arena); <br>
printf(&quot;# of free chunks (ordblks): %d\n&quot;,
mi.ordblks); <br>
printf(&quot;# of free fastbin blocks (smblks): %d\n&quot;,
mi.smblks); <br>
printf(&quot;# of mapped regions (hblks): %d\n&quot;,
mi.hblks); <br>
printf(&quot;Bytes in mapped regions (hblkhd): %d\n&quot;,
mi.hblkhd); <br>
printf(&quot;Max. total allocated space (usmblks):
%d\n&quot;, mi.usmblks); <br>
printf(&quot;Free bytes held in fastbins (fsmblks):
%d\n&quot;, mi.fsmblks); <br>
printf(&quot;Total allocated space (uordblks): %d\n&quot;,
mi.uordblks); <br>
printf(&quot;Total free space (fordblks): %d\n&quot;,
mi.fordblks); <br>
printf(&quot;Topmost releasable block (keepcost):
%d\n&quot;, mi.keepcost); <br>
}</p>

<p style="margin-left:11%; margin-top: 1em">int <br>
main(int argc, char *argv[]) <br>
{ <br>
#define MAX_ALLOCS 2000000 <br>
char *alloc[MAX_ALLOCS]; <br>
int numBlocks, j, freeBegin, freeEnd, freeStep; <br>
size_t blockSize;</p>

<p style="margin-left:11%; margin-top: 1em">if (argc &lt; 3
|| strcmp(argv[1], &quot;&minus;&minus;help&quot;) == 0)
<br>
usageErr(&quot;%s num&minus;blocks block&minus;size
[free&minus;step [start&minus;free &quot; <br>
&quot;[end&minus;free]]]\n&quot;, argv[0]);</p>

<p style="margin-left:11%; margin-top: 1em">numBlocks =
atoi(argv[1]); <br>
blockSize = atoi(argv[2]); <br>
freeStep = (argc &gt; 3) ? atoi(argv[3]) : 1; <br>
freeBegin = (argc &gt; 4) ? atoi(argv[4]) : 0; <br>
freeEnd = (argc &gt; 5) ? atoi(argv[5]) : numBlocks;</p>


<p style="margin-left:11%; margin-top: 1em">printf(&quot;==============
Before allocating blocks ==============\n&quot;); <br>
display_mallinfo();</p>

<p style="margin-left:11%; margin-top: 1em">for (j = 0; j
&lt; numBlocks; j++) { <br>
if (numBlocks &gt;= MAX_ALLOCS) <br>
fatal(&quot;Too many allocations&quot;);</p>

<p style="margin-left:11%; margin-top: 1em">alloc[j] =
malloc(blockSize); <br>
if (alloc[j] == NULL) <br>
errExit(&quot;malloc&quot;); <br>
}</p>


<p style="margin-left:11%; margin-top: 1em">printf(&quot;\n==============
After allocating blocks ==============\n&quot;); <br>
display_mallinfo();</p>

<p style="margin-left:11%; margin-top: 1em">for (j =
freeBegin; j &lt; freeEnd; j += freeStep) <br>
free(alloc[j]);</p>


<p style="margin-left:11%; margin-top: 1em">printf(&quot;\n==============
After freeing blocks ==============\n&quot;); <br>
display_mallinfo();</p>


<p style="margin-left:11%; margin-top: 1em">exit(EXIT_SUCCESS);
<br>
}</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>mmap</b>(2),
<b>malloc</b>(3), <b>malloc_info</b>(3),
<b>malloc_stats</b>(3), <b>malloc_trim</b>(3),
<b>mallopt</b>(3)</p>

<h2>COLOPHON
<a name="COLOPHON"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This page is
part of release 3.53 of the Linux <i>man-pages</i> project.
A description of the project, and information about
reporting bugs, can be found at
http://www.kernel.org/doc/man&minus;pages/.</p>
<hr>
</body>
</html>
