<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:24:44 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>FSCK</title>

</head>
<body>

<h1 align="center">FSCK</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#FILES">FILES</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#AVAILABILITY">AVAILABILITY</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">fsck &minus;
check and repair a Linux filesystem</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>fsck</b>
[<b>&minus;lrsAVRTMNP</b>] [<b>&minus;C</b> [<i>fd</i>]]
[<b>&minus;t</b> <i>fstype</i>] [<i>filesystem</i>...]
[<b>&minus;&minus;</b>] [<i>fs-specific-options</i>]</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>fsck</b> is
used to check and optionally repair one or more Linux
filesystems. <i>filesys</i> can be a device name (e.g.
<i>/dev/hdc1</i>, <i>/dev/sdb2</i>), a mount point (e.g.
<i>/</i>, <i>/usr</i>, <i>/home</i>), or an ext2 label or
UUID specifier (e.g.
UUID=8868abf6-88c5-4a83-98b8-bfc24057f7bd or LABEL=root).
Normally, the <b>fsck</b> program will try to handle
filesystems on different physical disk drives in parallel to
reduce the total amount of time needed to check all of
them.</p>

<p style="margin-left:11%; margin-top: 1em">If no
filesystems are specified on the command line, and the
<b>&minus;A</b> option is not specified, <b>fsck</b> will
default to checking filesystems in <b>/etc/fstab</b>
serially. This is equivalent to the <b>&minus;As</b>
options.</p>

<p style="margin-left:11%; margin-top: 1em">The exit code
returned by <b>fsck</b> is the sum of the following
conditions:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>0</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>No errors</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>1</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Filesystem errors corrected</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>2</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>System should be rebooted</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>4</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Filesystem errors left uncorrected</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>8</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Operational error</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>16</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Usage or syntax error</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>32</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Checking canceled by user request</p></td>
<td width="15%">
</td></tr>
<tr valign="top" align="left">
<td width="22%"></td>
<td width="4%">


<p><b>128</b></p></td>
<td width="6%"></td>
<td width="53%">


<p>Shared-library error</p></td>
<td width="15%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The exit code
returned when multiple filesystems are checked is the
bit-wise OR of the exit codes for each filesystem that is
checked.</p>

<p style="margin-left:11%; margin-top: 1em">In actuality,
<b>fsck</b> is simply a front-end for the various filesystem
checkers (<b>fsck</b>.<i>fstype</i>) available under Linux.
The filesystem-specific checker is searched for in
<i>/sbin</i> first, then in <i>/etc/fs</i> and <i>/etc</i>,
and finally in the directories listed in the PATH
environment variable. Please see the filesystem-specific
checker manual pages for further details.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>&minus;l</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Lock the whole-disk device by an
exclusive <b>flock</b>(2). This option can be used with one
device only (this means that <b>-A</b> and <b>-l</b> are
mutually exclusive). This option is recommended when more
<b>fsck</b>(8) instances are executed in the same time. The
option is ignored when used for multiple devices or for
non-rotating disks. <b>fsck</b> does not lock underlying
devices when executed to check stacked devices (e.g. MD or
DM) -- this feature is not implemented yet.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;r</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Report certain statistics for each fsck when it
completes. These statistics include the exit status, the
maximum run set size (in kilobytes), the elapsed all-clock
time and the user and system CPU time used by the fsck run.
For example:</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">/dev/sda1:
status 0, rss 92828, real 4.002804, user 2.677592, sys
0.86186</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p style="margin-top: 1em"><b>&minus;s</b></p></td>
<td width="8%"></td>
<td width="78%">


<p style="margin-top: 1em">Serialize <b>fsck</b>
operations. This is a good idea if you are checking multiple
filesystems and the checkers are in an interactive mode.
(Note: <b>e2fsck</b>(8) runs in an interactive mode by
default. To make <b>e2fsck</b>(8) run in a non-interactive
mode, you must either specify the <b>&minus;p</b> or
<b>&minus;a</b> option, if you wish for errors to be
corrected automatically, or the <b>&minus;n</b> option if
you do not.)</p></td></tr>
</table>

<p style="margin-left:11%;"><b>&minus;t</b>
<i>fslist</i></p>

<p style="margin-left:22%;">Specifies the type(s) of
filesystem to be checked. When the <b>&minus;A</b> flag is
specified, only filesystems that match <i>fslist</i> are
checked. The <i>fslist</i> parameter is a comma-separated
list of filesystems and options specifiers. All of the
filesystems in this comma-separated list may be prefixed by
a negation operator &rsquo;<b>no</b>&rsquo; or
&rsquo;<b>!</b>&rsquo;, which requests that only those
filesystems not listed in <i>fslist</i> will be checked. If
none of the filesystems in <i>fslist</i> is prefixed by a
negation operator, then only those listed filesystems will
be checked.</p>

<p style="margin-left:22%; margin-top: 1em">Options
specifiers may be included in the comma-separated
<i>fslist</i>. They must have the format
<b>opts=</b><i>fs-option</i>. If an options specifier is
present, then only filesystems which contain
<i>fs-option</i> in their mount options field of
<b>/etc/fstab</b> will be checked. If the options specifier
is prefixed by a negation operator, then only those
filesystems that do not have <i>fs-option</i> in their mount
options field of <b>/etc/fstab</b> will be checked.</p>

<p style="margin-left:22%; margin-top: 1em">For example, if
<b>opts=ro</b> appears in <i>fslist</i>, then only
filesystems listed in <b>/etc/fstab</b> with the <b>ro</b>
option will be checked.</p>

<p style="margin-left:22%; margin-top: 1em">For
compatibility with Mandrake distributions whose boot scripts
depend upon an unauthorized UI change to the <b>fsck</b>
program, if a filesystem type of <b>loop</b> is found in
<i>fslist</i>, it is treated as if <b>opts=loop</b> were
specified as an argument to the <b>&minus;t</b> option.</p>

<p style="margin-left:22%; margin-top: 1em">Normally, the
filesystem type is deduced by searching for <i>filesys</i>
in the <i>/etc/fstab</i> file and using the corresponding
entry. If the type can not be deduced, and there is only a
single filesystem given as an argument to the
<b>&minus;t</b> option, <b>fsck</b> will use the specified
filesystem type. If this type is not available, then the
default filesystem type (currently ext2) is used.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;A</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Walk through the <i>/etc/fstab</i> file and try to check
all filesystems in one run. This option is typically used
from the <i>/etc/rc</i> system initialization file, instead
of multiple commands for checking a single filesystem.</p></td></tr>
</table>

<p style="margin-left:22%; margin-top: 1em">The root
filesystem will be checked first unless the <b>&minus;P</b>
option is specified (see below). After that, filesystems
will be checked in the order specified by the
<i>fs_passno</i> (the sixth) field in the <i>/etc/fstab</i>
file. Filesystems with a <i>fs_passno</i> value of 0 are
skipped and are not checked at all. Filesystems with a
<i>fs_passno</i> value of greater than zero will be checked
in order, with filesystems with the lowest <i>fs_passno</i>
number being checked first. If there are multiple
filesystems with the same pass number, <b>fsck</b> will
attempt to check them in parallel, although it will avoid
running multiple filesystem checks on the same physical
disk.</p>

<p style="margin-left:22%; margin-top: 1em"><b>fsck</b>
does not check stacked devices (RAIDs, dm-crypt, ...) in
parallel with any other device. See below for
FSCK_FORCE_ALL_PARALLEL setting. The /sys filesystem is used
to detemine dependencies between devices.</p>

<p style="margin-left:22%; margin-top: 1em">Hence, a very
common configuration in <i>/etc/fstab</i> files is to set
the root filesystem to have a <i>fs_passno</i> value of 1
and to set all other filesystems to have a <i>fs_passno</i>
value of 2. This will allow <b>fsck</b> to automatically run
filesystem checkers in parallel if it is advantageous to do
so. System administrators might choose not to use this
configuration if they need to avoid multiple filesystem
checks running in parallel for some reason --- for example,
if the machine in question is short on memory so that
excessive paging is a concern.</p>

<p style="margin-left:22%; margin-top: 1em"><b>fsck</b>
normally does not check whether the device actually exists
before calling a filesystem specific checker. Therefore
non-existing devices may cause the system to enter
filesystem repair mode during boot if the filesystem
specific checker returns a fatal error. The
<b>/etc/fstab</b> mount option <b>nofail</b> may be used to
have <b>fsck</b> skip non-existing devices. <b>fsck</b> also
skips non-existing devices that have the special filesystem
type <b>auto</b>.</p>


<p style="margin-left:11%;"><b>&minus;C&nbsp;</b>[<i>fd</i>]</p>

<p style="margin-left:22%;">Display completion/progress
bars for those filesystem checkers (currently only for ext2
and ext3) which support them. <b>fsck</b> will manage the
filesystem checkers so that only one of them will display a
progress bar at a time. GUI front-ends may specify a file
descriptor <i>fd</i>, in which case the progress bar
information will be sent to that file descriptor.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;M</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Do not check mounted filesystems and return an exit code
of 0 for mounted filesystems.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;N</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Don&rsquo;t execute, just show what would be done.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;P</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>When the <b>&minus;A</b> flag is set, check the root
filesystem in parallel with the other filesystems. This is
not the safest thing in the world to do, since if the root
filesystem is in doubt things like the <b>e2fsck</b>(8)
executable might be corrupted! This option is mainly
provided for those sysadmins who don&rsquo;t want to
repartition the root filesystem to be small and compact
(which is really the right solution).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;R</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>When checking all filesystems with the <b>&minus;A</b>
flag, skip the root filesystem. (This is useful in case the
root filesystem has already been mounted read-write.)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;T</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Don&rsquo;t show the title on startup.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;V</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Produce verbose output, including all
filesystem-specific commands that are executed.</p></td></tr>
</table>

<p style="margin-left:11%;"><b>fs-specific-options</b></p>

<p style="margin-left:22%;">Options which are not
understood by <b>fsck</b> are passed to the
filesystem-specific checker. These options <b>must</b> not
take arguments, as there is no way for <b>fsck</b> to be
able to properly guess which options take arguments and
which don&rsquo;t.</p>

<p style="margin-left:22%; margin-top: 1em">Options and
arguments which follow the <b>&minus;&minus;</b> are treated
as filesystem-specific options to be passed to the
filesystem-specific checker.</p>

<p style="margin-left:22%; margin-top: 1em">Please note
that <b>fsck</b> is not designed to pass arbitrarily
complicated options to filesystem-specific checkers. If
you&rsquo;re doing something complicated, please just
execute the filesystem-specific checker directly. If you
pass <b>fsck</b> some horribly complicated options and
arguments, and it doesn&rsquo;t do what you expect,
<b>don&rsquo;t bother reporting it as a bug.</b>
You&rsquo;re almost certainly doing something that you
shouldn&rsquo;t be doing with <b>fsck.</b></p>

<p style="margin-left:11%; margin-top: 1em">Options to
different filesystem-specific fsck&rsquo;s are not
standardized. If in doubt, please consult the man pages of
the filesystem-specific checker. Although not guaranteed,
the following options are supported by most filesystem
checkers:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;a</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Automatically repair the filesystem without any
questions (use this option with caution). Note that
<b>e2fsck</b>(8) supports <b>&minus;a</b> for backward
compatibility only. This option is mapped to
<b>e2fsck</b>&rsquo;s <b>&minus;p</b> option which is safe
to use, unlike the <b>&minus;a</b> option that some
filesystem checkers support.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;n</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>For some filesystem-specific checkers, the
<b>&minus;n</b> option will cause the fs-specific fsck to
avoid attempting to repair any problems, but simply report
such problems to stdout. This is however not true for all
filesystem-specific checkers. In particular,
<b>fsck.reiserfs</b>(8) will not report any corruption if
given this option. <b>fsck.minix</b>(8) does not support the
<b>&minus;n</b> option at all.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;r</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Interactively repair the filesystem (ask for
confirmations). Note: It is generally a bad idea to use this
option if multiple fsck&rsquo;s are being run in parallel.
Also note that this is <b>e2fsck</b>&rsquo;s default
behavior; it supports this option for backward compatibility
reasons only.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>&minus;y</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>For some filesystem-specific checkers, the
<b>&minus;y</b> option will cause the fs-specific fsck to
always attempt to fix any detected filesystem corruption
automatically. Sometimes an expert may be able to do better
driving the fsck manually. Note that <b>not</b> all
filesystem-specific checkers implement this option. In
particular <b>fsck.minix</b>(8) and <b>fsck.cramfs</b>(8) do
not support the <b>-y</b> option as of this writing.</p></td></tr>
</table>

<h2>FILES
<a name="FILES"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><i>/etc/fstab</i>.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <b>fsck</b>
program&rsquo;s behavior is affected by the following
environment variables: <b><br>
FSCK_FORCE_ALL_PARALLEL</b></p>

<p style="margin-left:22%;">If this environment variable is
set, <b>fsck</b> will attempt to check all of the specified
filesystems in parallel, regardless of whether the
filesystems appear to be on the same device. (This is useful
for RAID systems or high-end storage systems such as those
sold by companies such as IBM or EMC.) Note that the
fs_passno value is still used.</p>

<p style="margin-left:11%;"><b>FSCK_MAX_INST</b></p>

<p style="margin-left:22%;">This environment variable will
limit the maximum number of filesystem checkers that can be
running at one time. This allows configurations which have a
large number of disks to avoid <b>fsck</b> starting too many
filesystem checkers at once, which might overload CPU and
memory resources available on the system. If this value is
zero, then an unlimited number of processes can be spawned.
This is currently the default, but future versions of
<b>fsck</b> may attempt to automatically determine how many
filesystem checks can be run based on gathering accounting
data from the operating system.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p><b>PATH</b></p></td>
<td width="5%"></td>
<td width="78%">


<p>The <b>PATH</b> environment variable is used to find
filesystem checkers. A set of system directories are
searched first: <b>/sbin</b>, <b>/sbin/fs.d</b>,
<b>/sbin/fs</b>, <b>/etc/fs</b>, and <b>/etc</b>. Then the
set of directories found in the <b>PATH</b> environment are
searched.</p> </td></tr>
</table>

<p style="margin-left:11%;"><b>FSTAB_FILE</b></p>

<p style="margin-left:22%;">This environment variable
allows the system administrator to override the standard
location of the <b>/etc/fstab</b> file. It is also useful
for developers who are testing <b>fsck</b>.</p>


<p style="margin-left:11%;"><b>LIBBLKID_DEBUG=0xffff</b></p>

<p style="margin-left:22%;">enables debug output.</p>


<p style="margin-left:11%;"><b>LIBMOUNT_DEBUG=0xffff</b></p>

<p style="margin-left:22%;">enables debug output.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>fstab</b>(5),
<b>mkfs</b>(8), <b>fsck.ext2</b>(8) or <b>fsck.ext3</b>(8)
or <b>e2fsck</b>(8), <b>cramfsck</b>(8),
<b>fsck.minix</b>(8), <b>fsck.msdos</b>(8),
<b>fsck.jfs</b>(8), <b>fsck.nfs</b>(8), <b>fsck.vfat</b>(8),
<b>fsck.xfs</b>(8), <b>fsck.xiafs</b>(8),
<b>reiserfsck</b>(8).</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><a href="mailto:tytso@mit.edu">Theodore
Ts&rsquo;o</a></p>

<h2>AVAILABILITY
<a name="AVAILABILITY"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The fsck
command is part of the util-linux package and is available
from
<a href="ftp://ftp.kernel.org/pub/linux/utils/util-linux/">Linux
Kernel Archive</a>.</p>
<hr>
</body>
</html>
