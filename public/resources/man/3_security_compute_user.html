<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:09:37 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>security_compute_av</title>

</head>
<body>

<h1 align="center">security_compute_av</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#RETURN VALUE">RETURN VALUE</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">security_compute_av,
security_compute_av_flags, security_compute_create,
security_compute_create_name, security_compute_relabel,
security_compute_member, security_compute_user,
security_get_initial_context &minus; query the SELinux
policy database in the kernel</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;selinux/selinux.h&gt; <br>
#include &lt;selinux/flask.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_av(security_context_t</b> <i>scon</i><b>,
security_context_t</b> <i>tcon</i><b>, security_class_t</b>
<i>tclass</i><b>, access_vector_t</b> <i>requested</i><b>,
struct av_decision *</b><i>avd</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_av_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, access_vector_t</b>
<i>requested</i><b>, struct av_decision
*</b><i>avd</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_av_flags(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, access_vector_t</b>
<i>requested</i><b>, struct av_decision
*</b><i>avd</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_av_flags_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, access_vector_t</b>
<i>requested</i><b>, struct av_decision
*</b><i>avd</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_create(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_create_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_create_name(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, const char
*</b><i>objname</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_create_name_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, const char
*</b><i>objname</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_relabel(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_relabel_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_member(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_member_raw(security_context_t</b>
<i>scon</i><b>, security_context_t</b> <i>tcon</i><b>,
security_class_t</b> <i>tclass</i><b>, security_context_t
*</b><i>newcon</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_user(security_context_t</b> <i>scon</i><b>,
const char *</b><i>username</i><b>, security_context_t
**</b><i>con</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_compute_user_raw(security_context_t</b>
<i>scon</i><b>, const char *</b><i>username</i><b>,
security_context_t **</b><i>con</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_get_initial_context(const char *</b><i>name</i><b>,
security_context_t *</b><i>con</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
security_get_initial_context_raw(const char
*</b><i>name</i><b>, security_context_t
*</b><i>con</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
selinux_check_access(const security_context_t</b>
<i>scon</i><b>, const security_context_t</b> <i>tcon</i><b>,
const char *</b><i>class</i><b>, const char
*</b><i>perm</i><b>, void *</b><i>auditdata);</i></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
selinux_check_passwd_access(access_vector_t</b>
<i>requested</i><b>);</b></p>

<p style="margin-left:11%; margin-top: 1em"><b>int
checkPasswdAccess(access_vector_t</b>
<i>requested</i><b>);</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>security_compute_av</b>()
queries whether the policy permits the source context
<i>scon</i> to access the target context <i>tcon</i> via
class <i>tclass</i> with the <i>requested</i> access vector.
The decision is returned in <i>avd</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_av_flags</b>()
is identical to <b>security_compute_av</b> but additionally
sets the <i>flags</i> field of <i>avd</i>. Currently one
flag is supported: <b>SELINUX_AVD_FLAGS_PERMISSIVE</b>,
which indicates the decision is computed on a permissive
domain.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_create</b>()
is used to compute a context to use for labeling a new
object in a particular class based on a SID pair.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_create_name</b>()
is identical to <b>security_compute_create</b>() but also
takes name of the new object in creation as an argument.
When <b>TYPE_TRANSITION</b> rule on the given class and a
SID pair has object name extension, we shall be able to
obtain a correct <i>newcon</i> according to the security
policy. Note that this interface is only supported on the
linux 2.6.40 or later. In the older kernel, the object name
will be simply ignored.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_relabel</b>()
is used to compute the new context to use when relabeling an
object, it is used in the pam_selinux.so source and the
newrole source to determine the correct label for the tty at
login time, but can be used for other things.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_member</b>()
is used to compute the context to use when labeling a
polyinstantiated object instance.</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_user</b>()
is used to determine the set of user contexts that can be
reached from a source context. It is mainly used by
<b>get_ordered_context_list</b>().</p>


<p style="margin-left:11%; margin-top: 1em"><b>security_get_initial_context</b>()
is used to get the context of a kernel initial security
identifier specified by <i>name</i></p>


<p style="margin-left:11%; margin-top: 1em"><b>security_compute_av_raw</b>(),
<b>security_compute_av_flags_raw</b>(),
<b>security_compute_create_raw</b>(),
<b>security_compute_create_name_raw</b>(),
<b>security_compute_relabel_raw</b>(),
<b>security_compute_member_raw</b>(),
<b>security_compute_user_raw</b>() and
<b>security_get_initial_context_raw</b>() behave identically
to their non-raw counterparts but do not perform context
translation.</p>


<p style="margin-left:11%; margin-top: 1em"><b>selinux_check_access</b>()
is used to check if the source context has the access
permission for the specified class on the target
context.</p>


<p style="margin-left:11%; margin-top: 1em"><b>selinux_check_passwd_access</b>()
is used to check for a permission in the <i>passwd</i>
class. <b>selinux_check_passwd_access</b>() uses
getprevcon() for the source and target security
contexts.</p>


<p style="margin-left:11%; margin-top: 1em"><b>checkPasswdAccess</b>()
is a deprecated alias of the
<b>selinux_check_passwd_access</b>() function.</p>

<h2>RETURN VALUE
<a name="RETURN VALUE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Returns zero on
success or &minus;1 on error.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>selinux</b>(8),
<b>getcon</b>(3), <b>getfilecon</b>(3),
<b>get_ordered_context_list</b>(3)</p>
<hr>
</body>
</html>
