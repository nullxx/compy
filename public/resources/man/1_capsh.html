<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 14:57:10 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>CAPSH</title>

</head>
<body>

<h1 align="center">CAPSH</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#AUTHOR">AUTHOR</a><br>
<a href="#REPORTING BUGS">REPORTING BUGS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">capsh &minus;
capability shell wrapper</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>capsh</b>
[<i>OPTION</i>]...</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Linux
capability support and use can be explored and constrained
with this tool. This tool provides a handy wrapper for
certain types of capability testing and environment
creation. It also provides some debugging features useful
for summarizing capability state.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The tool takes
a number of optional arguments, acting on them in the order
they are provided. They are as follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--print</b></p></td>
<td width="7%"></td>
<td width="55%">


<p>Display prevailing capability and related state.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--</b> <i>[args]</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Execute <b>/bin/bash</b> with trailing arguments. Note,
you can use <b>-c &rsquo;command to execute&rsquo;</b> for
specific commands.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>==</b></p></td>
<td width="7%"></td>
<td width="55%">


<p>Execute <b>capsh</b> again with remaining arguments.
Useful for testing <b>exec</b>() behavior.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--caps=</b><i>cap-set</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Set the prevailing process capabilities to those
specified by <i>cap-set</i>. Where <i>cap-set</i> is a
text-representation of capability state as per
<b>cap_from_text</b>(3).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--drop=</b><i>cap-list</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Remove the listed capabilities from the prevailing
bounding set. The capabilites are a comma separated list of
capabilities as recognized by the <b>cap_from_name</b>(3)
function. Use of this feature requires that the capsh
program is operating with <b>CAP_SETPCAP</b> in its
effective set.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--inh=</b><i>cap-list</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Set the inheritable set of capabilities for the current
process to equal those provided in the comma separated list.
For this action to succeed, the prevailing process should
already have each of these capabilities in the union of the
current inheritable and permitted capability sets, or the
capsh program is operating with <b>CAP_SETPCAP</b> in its
effective set.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--user=</b><i>username</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Assume the identity of the named user. That is, look up
the user&rsquo;s <i>uid</i> and <i>gid</i> with
<b>getpwuid</b>(3) and their group memberships with
<b>getgrouplist</b>(3) and set them all.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--uid=</b><i>id</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Force all <b>uid</b> values to equal <i>id</i> using the
<b>setuid</b>(2) system call.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--gid=</b><i>&lt;id&gt;</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Force all <b>gid</b> values to equal <i>id</i> using the
<b>setgid</b>(2) system call.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--groups=</b><i>&lt;id-list&gt;</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Set the supplementary groups to the numerical list
provided. The groups are set with the <b>setgroups</b>(2)
system call.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--keep=</b><i>&lt;0|1&gt;</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>In a non-pure capability mode, the kernel provides
liberal privilege to the super-user. However, it is normally
the case that when the super-user changes <i>uid</i> to some
lesser user, then capabilities are dropped. For these
situations, the kernel can permit the process to retain its
capabilities after a <b>setuid</b>(2) system call. This
feature is known as <i>keep-caps</i> support. The way to
activate it using this script is with this argument. Setting
the value to 1 will cause <i>keep-caps</i> to be active.
Setting it to 0 will cause keep-caps to deactivate for the
current process. In all cases, <i>keep-caps</i> is
deactivated when an <b>exec</b>() is performed. See
<b>--secbits</b> for ways to disable this feature.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--secbits=</b><i>N</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>XXX - need to document this feature.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--chroot=</b><i>path</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>Execute the <b>chroot</b>(2) system call with the new
root-directory (/) equal to <i>path</i>. This operation
requires <b>CAP_SYS_CHROOT</b> to be in effect.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--forkfor=</b><i>sec</i></p></td>
<td width="7%"></td>
<td width="55%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--killit=</b><i>sig</i></p></td>
<td width="7%"></td>
<td width="55%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="27%">


<p><b>--decode=</b><i>N</i></p></td>
<td width="7%"></td>
<td width="55%">


<p>This is a convenience feature. If you look at
<b>/proc/1/status</b> there are some capability related
fields of the following form:</p></td></tr>
</table>

<p style="margin-left:45%; margin-top: 1em">CapInh:
0000000000000000 <br>
CapPrm: ffffffffffffffff <br>
CapEff: fffffffffffffeff <br>
CapBnd: ffffffffffffffff</p>

<p style="margin-left:45%; margin-top: 1em">This option
provides a quick way to decode a capability vector
represented in this form. For example, the missing
capability from this effective set is 0x0100. By
running:</p>

<p style="margin-left:45%; margin-top: 1em">capsh
--decode=0x0100</p>

<p style="margin-left:45%; margin-top: 1em">we observe that
the missing capability is: <b>cap_setpcap</b>.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="21%">



<p style="margin-top: 1em"><b>--supports=</b><i>xxx</i></p> </td>
<td width="13%"></td>
<td width="55%">


<p style="margin-top: 1em">As the kernel evolves, more
capabilities are added. This option can be used to verify
the existence of a capability on the system. For example,
<b>--supports=</b><i>cap_syslog</i> will cause capsh to
promptly exit with a status of 1 when run on kernel 2.6.27.
However, when run on kernel 2.6.38 it will silently
succeed.</p> </td></tr>
</table>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:22%; margin-top: 1em">Following
successful execution the tool exits with status 0. Following
an error, the tool immediately exits with status 1.</p>

<h2>AUTHOR
<a name="AUTHOR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Written by
Andrew G. Morgan &lt;morgan@kernel.org&gt;.</p>

<h2>REPORTING BUGS
<a name="REPORTING BUGS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please report
bugs to the author.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>libcap</b>(3),
<b>getcap</b>(8),<b>setcap</b>(8) and
<b>capabilities</b>(7).</p>
<hr>
</body>
</html>
