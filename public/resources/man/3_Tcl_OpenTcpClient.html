<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:03:59 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>Tcl_OpenTcpClient</title>

</head>
<body>

<h1 align="center">Tcl_OpenTcpClient</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#ARGUMENTS">ARGUMENTS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#TCL_OPENTCPCLIENT">TCL_OPENTCPCLIENT</a><br>
<a href="#TCL_MAKETCPCLIENTCHANNEL">TCL_MAKETCPCLIENTCHANNEL</a><br>
<a href="#TCL_OPENTCPSERVER">TCL_OPENTCPSERVER</a><br>
<a href="#PLATFORM ISSUES">PLATFORM ISSUES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#KEYWORDS">KEYWORDS</a><br>

<hr>



<p>______________________________________________________________________________</p>

<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Tcl_OpenTcpClient,
Tcl_MakeTcpClientChannel, Tcl_OpenTcpServer &minus;
procedures to open channels using TCP sockets</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>#include
&lt;tcl.h&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">Tcl_Channel
<b><br>
Tcl_OpenTcpClient</b>(<i>interp, port, host, myaddr, myport,
async</i>)</p>

<p style="margin-left:11%; margin-top: 1em">Tcl_Channel
<b><br>
Tcl_MakeTcpClientChannel</b>(<i>sock</i>)</p>

<p style="margin-left:11%; margin-top: 1em">Tcl_Channel
<b><br>
Tcl_OpenTcpServer</b>(<i>interp, port, myaddr, proc,
clientData</i>)</p>

<h2>ARGUMENTS
<a name="ARGUMENTS"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p style="margin-top: 1em">Tcl_Interp <i>*interp</i>
(in)</p> </td>
<td width="23%"></td>
<td width="23%">


<p style="margin-top: 1em">Tcl interpreter to use for error
reporting. If non-NULL and an error occurs, an error message
is left in the interpreter&rsquo;s result.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>int <i>port</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>A port number to connect to as a client or to listen on
as a server.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>const char <i>*host</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>A string specifying a host name or address for the
remote end of the connection.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>int <i>myport</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>A port number for the client&rsquo;s end of the socket.
If 0, a port number is allocated at random.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>const char <i>*myaddr</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>A string specifying the host name or address for network
interface to use for the local end of the connection. If
NULL, a default interface is chosen.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>int <i>async</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>If nonzero, the client socket is connected
asynchronously to the server.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>ClientData <i>sock</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>Platform-specific handle for client TCP socket.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>Tcl_TcpAcceptProc <i>*proc</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>Pointer to a procedure to invoke each time a new
connection is accepted via the socket.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="43%">


<p>ClientData <i>clientData</i> (in)</p></td>
<td width="23%"></td>
<td width="23%">


<p>Arbitrary one-word value to pass to <i>proc</i>.</p></td></tr>
</table>


<p style="margin-left:77%;">_________________________________________________________________</p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">These functions
are convenience procedures for creating channels that
communicate over TCP sockets. The operations on a channel
are described in the manual entry for
<b>Tcl_OpenFileChannel</b>.</p>

<h2>TCL_OPENTCPCLIENT
<a name="TCL_OPENTCPCLIENT"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Tcl_OpenTcpClient</b>
opens a client TCP socket connected to a <i>port</i> on a
specific <i>host</i>, and returns a channel that can be used
to communicate with the server. The host to connect to can
be specified either as a domain name style name (e.g.
<b>www.sunlabs.com</b>), or as a string containing the
alphanumeric representation of its four-byte address (e.g.
<b>127.0.0.1</b>). Use the string <b>localhost</b> to
connect to a TCP socket on the host on which the function is
invoked.</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>myaddr</i> and <i>myport</i> arguments allow a client to
specify an address for the local end of the connection. If
<i>myaddr</i> is NULL, then an interface is chosen
automatically by the operating system. If <i>myport</i> is
0, then a port number is chosen at random by the operating
system.</p>

<p style="margin-left:11%; margin-top: 1em">If <i>async</i>
is zero, the call to <b>Tcl_OpenTcpClient</b> returns only
after the client socket has either successfully connected to
the server, or the attempted connection has failed. If
<i>async</i> is nonzero the socket is connected
asynchronously and the returned channel may not yet be
connected to the server when the call to
<b>Tcl_OpenTcpClient</b> returns. If the channel is in
blocking mode and an input or output operation is done on
the channel before the connection is completed or fails,
that operation will wait until the connection either
completes successfully or fails. If the channel is in
nonblocking mode, the input or output operation will return
immediately and a subsequent call to <b>Tcl_InputBlocked</b>
on the channel will return nonzero.</p>

<p style="margin-left:11%; margin-top: 1em">The returned
channel is opened for reading and writing. If an error
occurs in opening the socket, <b>Tcl_OpenTcpClient</b>
returns NULL and records a POSIX error code that can be
retrieved with <b>Tcl_GetErrno</b>. In addition, if
<i>interp</i> is non-NULL, an error message is left in the
interpreter&rsquo;s result.</p>

<p style="margin-left:11%; margin-top: 1em">The newly
created channel is not registered in the supplied
interpreter; to register it, use <b>Tcl_RegisterChannel</b>.
If one of the standard channels, <b>stdin, stdout</b> or
<b>stderr</b> was previously closed, the act of creating the
new channel also assigns it as a replacement for the
standard channel.</p>

<h2>TCL_MAKETCPCLIENTCHANNEL
<a name="TCL_MAKETCPCLIENTCHANNEL"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Tcl_MakeTcpClientChannel</b>
creates a <b>Tcl_Channel</b> around an existing, platform
specific, handle for a client TCP socket.</p>

<p style="margin-left:11%; margin-top: 1em">The newly
created channel is not registered in the supplied
interpreter; to register it, use <b>Tcl_RegisterChannel</b>.
If one of the standard channels, <b>stdin, stdout</b> or
<b>stderr</b> was previously closed, the act of creating the
new channel also assigns it as a replacement for the
standard channel.</p>

<h2>TCL_OPENTCPSERVER
<a name="TCL_OPENTCPSERVER"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Tcl_OpenTcpServer</b>
opens a TCP socket on the local host on a specified
<i>port</i> and uses the Tcl event mechanism to accept
requests from clients to connect to it. The <i>myaddr</i>
argument specifies the network interface. If <i>myaddr</i>
is NULL the special address INADDR_ANY should be used to
allow connections from any network interface. Each time a
client connects to this socket, Tcl creates a channel for
the new connection and invokes <i>proc</i> with information
about the channel. <i>Proc</i> must match the following
prototype:</p>

<p style="margin-left:22%;">typedef void Tcl_TcpAcceptProc(
<br>
ClientData <i>clientData</i>, <br>
Tcl_Channel <i>channel</i>, <br>
char *<i>hostName</i>, <br>
int <i>port</i>);</p>

<p style="margin-left:11%; margin-top: 1em">The
<i>clientData</i> argument will be the same as the
<i>clientData</i> argument to <b>Tcl_OpenTcpServer</b>,
<i>channel</i> will be the handle for the new channel,
<i>hostName</i> points to a string containing the name of
the client host making the connection, and <i>port</i> will
contain the client&rsquo;s port number. The new channel is
opened for both input and output. If <i>proc</i> raises an
error, the connection is closed automatically. <i>Proc</i>
has no return value, but if it wishes to reject the
connection it can close <i>channel</i>.</p>


<p style="margin-left:11%; margin-top: 1em"><b>Tcl_OpenTcpServer</b>
normally returns a pointer to a channel representing the
server socket. If an error occurs, <b>Tcl_OpenTcpServer</b>
returns NULL and records a POSIX error code that can be
retrieved with <b>Tcl_GetErrno</b>. In addition, if the
interpreter is non-NULL, an error message is left in the
interpreter&rsquo;s result.</p>

<p style="margin-left:11%; margin-top: 1em">The channel
returned by <b>Tcl_OpenTcpServer</b> cannot be used for
either input or output. It is simply a handle for the socket
used to accept connections. The caller can close the channel
to shut down the server and disallow further connections
from new clients.</p>

<p style="margin-left:11%; margin-top: 1em">TCP server
channels operate correctly only in applications that
dispatch events through <b>Tcl_DoOneEvent</b> or through Tcl
commands such as <b>vwait</b>; otherwise Tcl will never
notice that a connection request from a remote client is
pending.</p>

<p style="margin-left:11%; margin-top: 1em">The newly
created channel is not registered in the supplied
interpreter; to register it, use <b>Tcl_RegisterChannel</b>.
If one of the standard channels, <b>stdin, stdout</b> or
<b>stderr</b> was previously closed, the act of creating the
new channel also assigns it as a replacement for the
standard channel.</p>

<h2>PLATFORM ISSUES
<a name="PLATFORM ISSUES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">On Unix
platforms, the socket handle is a Unix file descriptor as
returned by the <b>socket</b> system call. On the Windows
platform, the socket handle is a <b>SOCKET</b> as defined in
the WinSock API.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em">Tcl_OpenFileChannel(3),
Tcl_RegisterChannel(3), vwait(n)</p>

<h2>KEYWORDS
<a name="KEYWORDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">client, server,
TCP</p>
<hr>
</body>
</html>
