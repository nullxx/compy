<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Thu Aug 18 15:00:50 2016 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>ED</title>

</head>
<body>

<h1 align="center">ED</h1>

<a href="#PROLOG">PROLOG</a><br>
<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#OPERANDS">OPERANDS</a><br>
<a href="#STDIN">STDIN</a><br>
<a href="#INPUT FILES">INPUT FILES</a><br>
<a href="#ENVIRONMENT VARIABLES">ENVIRONMENT VARIABLES</a><br>
<a href="#ASYNCHRONOUS EVENTS">ASYNCHRONOUS EVENTS</a><br>
<a href="#STDOUT">STDOUT</a><br>
<a href="#STDERR">STDERR</a><br>
<a href="#OUTPUT FILES">OUTPUT FILES</a><br>
<a href="#EXTENDED DESCRIPTION">EXTENDED DESCRIPTION</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#CONSEQUENCES OF ERRORS">CONSEQUENCES OF ERRORS</a><br>
<a href="#APPLICATION USAGE">APPLICATION USAGE</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#RATIONALE">RATIONALE</a><br>
<a href="#FUTURE DIRECTIONS">FUTURE DIRECTIONS</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>PROLOG
<a name="PROLOG"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">This manual
page is part of the POSIX Programmer&rsquo;s Manual. The
Linux implementation of this interface may differ (consult
the corresponding Linux manual page for details of Linux
behavior), or the interface may not be implemented on
Linux.</p>

<h2>NAME
<a name="NAME"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">ed &minus; edit
text</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>ed [-p</b>
<i>string</i><b>][-s][</b><i>file</i><b>]</b></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <i>ed</i>
utility is a line-oriented text editor that uses two modes:
<i>command mode</i> and <i>input mode</i>. In command mode
the input characters shall be interpreted as commands, and
in input mode they shall be interpreted as text. See the
EXTENDED DESCRIPTION section.</p>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <i>ed</i>
utility shall conform to the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, Section 12.2, Utility Syntax
Guidelines.</p>

<p style="margin-left:11%; margin-top: 1em">The following
options shall be supported: <b><br>
-p&nbsp;</b> <i>string</i></p>

<p style="margin-left:22%;">Use <i>string</i> as the prompt
string when in command mode. By default, there shall be no
prompt string.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-s</b></p></td>
<td width="8%"></td>
<td width="78%">


<p>Suppress the writing of byte counts by <b>e</b>,
<b>E</b>, <b>r</b>, and <b>w</b> commands and of the
<b>&rsquo;!&rsquo;</b> prompt after a !<i>command</i>.</p></td></tr>
</table>

<h2>OPERANDS
<a name="OPERANDS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
operand shall be supported:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="6%">


<p style="margin-top: 1em"><i>file</i></p></td>
<td width="5%"></td>
<td width="78%">


<p style="margin-top: 1em">If the <i>file</i> argument is
given, <i>ed</i> shall simulate an <b>e</b> command on the
file named by the pathname, <i>file</i>, before accepting
commands from the standard input. If the <i>file</i> operand
is <b>&rsquo;-&rsquo;</b>, the results are unspecified.</p></td></tr>
</table>

<h2>STDIN
<a name="STDIN"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The standard
input shall be a text file consisting of commands, as
described in the EXTENDED DESCRIPTION section.</p>

<h2>INPUT FILES
<a name="INPUT FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The input files
shall be text files.</p>

<h2>ENVIRONMENT VARIABLES
<a name="ENVIRONMENT VARIABLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
environment variables shall affect the execution of
<i>ed</i>:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p style="margin-top: 1em"><i>HOME</i></p></td>
<td width="2%"></td>
<td width="78%">


<p style="margin-top: 1em">Determine the pathname of the
user&rsquo;s home directory.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>LANG</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>Provide a default value for the internationalization
variables that are unset or null. (See the Base Definitions
volume of IEEE&nbsp;Std&nbsp;1003.1-2001, Section 8.2,
Internationalization Variables for the precedence of
internationalization variables used to determine the values
of locale categories.)</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p><i>LC_ALL</i></p></td>
<td width="2%"></td>
<td width="78%">


<p>If set to a non-empty string value, override the values
of all the other internationalization variables.</p></td></tr>
</table>

<p style="margin-left:11%;"><i>LC_COLLATE</i></p>

<p style="margin-left:22%; margin-top: 1em">Determine the
locale for the behavior of ranges, equivalence classes, and
multi-character collating elements within regular
expressions.</p>

<p style="margin-left:11%;"><i>LC_CTYPE</i></p>

<p style="margin-left:22%;">Determine the locale for the
interpretation of sequences of bytes of text data as
characters (for example, single-byte as opposed to
multi-byte characters in arguments and input files) and the
behavior of character classes within regular
expressions.</p>

<p style="margin-left:11%;"><i>LC_MESSAGES</i></p>

<p style="margin-left:22%;">Determine the locale that
should be used to affect the format and contents of
diagnostic messages written to standard error and
informative messages written to standard output.</p>

<p style="margin-left:11%;"><i>NLSPATH</i></p>

<p style="margin-left:22%;">Determine the location of
message catalogs for the processing of <i>LC_MESSAGES
.</i></p>

<h2>ASYNCHRONOUS EVENTS
<a name="ASYNCHRONOUS EVENTS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <i>ed</i>
utility shall take the standard action for all signals (see
the ASYNCHRONOUS EVENTS section in <i>Utility Description
Defaults</i> ) with the following exceptions:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>SIGINT</p></td>
<td width="2%"></td>
<td width="78%">


<p>The <i>ed</i> utility shall interrupt its current
activity, write the string <b>&quot;?\n&quot;</b> to
standard output, and return to command mode (see the
EXTENDED DESCRIPTION section).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="9%">


<p>SIGHUP</p></td>
<td width="2%"></td>
<td width="78%">


<p>If the buffer is not empty and has changed since the
last write, the <i>ed</i> utility shall attempt to write a
copy of the buffer in a file. First, the file named
<b>ed.hup</b> in the current directory shall be used; if
that fails, the file named <b>ed.hup</b> in the directory
named by the <i>HOME</i> environment variable shall be used.
In any case, the <i>ed</i> utility shall exit without
returning to command mode.</p></td></tr>
</table>

<p style="margin-left:11%;">SIGQUIT</p>

<p style="margin-left:22%;">The <i>ed</i> utility shall
ignore this event.</p>

<h2>STDOUT
<a name="STDOUT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Various editing
commands and the prompting feature (see <b>-p</b>) write to
standard output, as described in the EXTENDED DESCRIPTION
section.</p>

<h2>STDERR
<a name="STDERR"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The standard
error shall be used only for diagnostic messages.</p>

<h2>OUTPUT FILES
<a name="OUTPUT FILES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The output
files shall be text files whose formats are dependent on the
editing commands given.</p>

<h2>EXTENDED DESCRIPTION
<a name="EXTENDED DESCRIPTION"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The <i>ed</i>
utility shall operate on a copy of the file it is editing;
changes made to the copy shall have no effect on the file
until a <b>w</b> (write) command is given. The copy of the
text is called the <i>buffer</i>.</p>

<p style="margin-left:11%; margin-top: 1em">Commands to
<i>ed</i> have a simple and regular structure: zero, one, or
two <i>addresses</i> followed by a single-character
<i>command</i>, possibly followed by parameters to that
command. These addresses specify one or more lines in the
buffer. Every command that requires addresses has default
addresses, so that the addresses very often can be omitted.
If the <b>-p</b> option is specified, the prompt string
shall be written to standard output before each command is
read.</p>

<p style="margin-left:11%; margin-top: 1em">In general,
only one command can appear on a line. Certain commands
allow text to be input. This text is placed in the
appropriate place in the buffer. While <i>ed</i> is
accepting text, it is said to be in <i>input mode</i>. In
this mode, no commands shall be recognized; all input is
merely collected. Input mode is terminated by entering a
line consisting of two characters: a period (
<b>&rsquo;.&rsquo;</b> ) followed by a &lt;newline&gt;. This
line is not considered part of the input text.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Regular
Expressions in ed</b> <br>
The <i>ed</i> utility shall support basic regular
expressions, as described in the Base Definitions volume of
IEEE&nbsp;Std&nbsp;1003.1-2001, Section 9.3, Basic Regular
Expressions. Since regular expressions in <i>ed</i> are
always matched against single lines (excluding the
terminating &lt;newline&gt;s), never against any larger
section of text, there is no way for a regular expression to
match a &lt;newline&gt;.</p>

<p style="margin-left:11%; margin-top: 1em">A null RE shall
be equivalent to the last RE encountered.</p>

<p style="margin-left:11%; margin-top: 1em">Regular
expressions are used in addresses to specify lines, and in
some commands (for example, the <b>s</b> substitute command)
to specify portions of a line to be substituted.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Addresses in
ed</b> <br>
Addressing in <i>ed</i> relates to the current line.
Generally, the current line is the last line affected by a
command. The current line number is the address of the
current line. If the edit buffer is not empty, the initial
value for the current line shall be the last line in the
edit buffer; otherwise, zero.</p>

<p style="margin-left:11%; margin-top: 1em">Addresses shall
be constructed as follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>1.</p></td>
<td width="2%"></td>
<td width="83%">


<p>The period character ( <b>&rsquo;.&rsquo;</b> ) shall
address the current line.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>2.</p></td>
<td width="2%"></td>
<td width="83%">


<p>The dollar sign character ( <b>&rsquo;$&rsquo;</b> )
shall address the last line of the edit buffer.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>3.</p></td>
<td width="2%"></td>
<td width="83%">


<p>The positive decimal number <i>n</i> shall address the
<i>n</i>th line of the edit buffer.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>4.</p></td>
<td width="2%"></td>
<td width="83%">


<p>The apostrophe-x character pair (
<b>&quot;&rsquo;x&quot;</b> ) shall address the line marked
with the mark name character <i>x</i>, which shall be a
lowercase letter from the portable character set. It shall
be an error if the character has not been set to mark a line
or if the line that was marked is not currently present in
the edit buffer.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>5.</p></td>
<td width="2%"></td>
<td width="83%">


<p>A BRE enclosed by slash characters (
<b>&rsquo;/&rsquo;</b> ) shall address the first line found
by searching forwards from the line following the current
line toward the end of the edit buffer and stopping at the
first line for which the line excluding the terminating
&lt;newline&gt; matches the BRE. The BRE consisting of a
null BRE delimited by a pair of slash characters shall
address the next line for which the line excluding the
terminating &lt;newline&gt; matches the last BRE
encountered. In addition, the second slash can be omitted at
the end of a command line. Within the BRE, a backslash-slash
pair ( <b>&quot;\/&quot;</b> ) shall represent a literal
slash instead of the BRE delimiter. If necessary, the search
shall wrap around to the beginning of the buffer and
continue up to and including the current line, so that the
entire buffer is searched.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>6.</p></td>
<td width="2%"></td>
<td width="83%">


<p>A BRE enclosed by question-mark characters (
<b>&rsquo;?&rsquo;</b> ) shall address the first line found
by searching backwards from the line preceding the current
line toward the beginning of the edit buffer and stopping at
the first line for which the line excluding the terminating
&lt;newline&gt; matches the BRE. The BRE consisting of a
null BRE delimited by a pair of question-mark characters (
<b>&quot;??&quot;</b> ) shall address the previous line for
which the line excluding the terminating &lt;newline&gt;
matches the last BRE encountered. In addition, the second
question-mark can be omitted at the end of a command line.
Within the BRE, a backslash-question-mark pair (
<b>&quot;\?&quot;</b> ) shall represent a literal question
mark instead of the BRE delimiter. If necessary, the search
shall wrap around to the end of the buffer and continue up
to and including the current line, so that the entire buffer
is searched.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="3%">


<p>7.</p></td>
<td width="2%"></td>
<td width="83%">


<p>A plus-sign ( <b>&rsquo;+&rsquo;</b> ) or hyphen
character ( <b>&rsquo;-&rsquo;</b> ) followed by a decimal
number shall address the current line plus or minus the
number. A plus-sign or hyphen character not followed by a
decimal number shall address the current line plus or minus
1.</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Addresses can
be followed by zero or more address offsets, optionally
&lt;blank&gt;-separated. Address offsets are constructed as
follows:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">A plus-sign or hyphen character
followed by a decimal number shall add or subtract,
respectively, the indicated number of lines to or from the
address. A plus-sign or hyphen character not followed by a
decimal number shall add or subtract 1 to or from the
address.</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>A decimal number shall add the indicated number of lines
to the address.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">It shall not be
an error for an intermediate address value to be less than
zero or greater than the last line in the edit buffer. It
shall be an error for the final address value to be less
than zero or greater than the last line in the edit buffer.
It shall be an error if a search for a BRE fails to find a
matching line.</p>

<p style="margin-left:11%; margin-top: 1em">Commands accept
zero, one, or two addresses. If more than the required
number of addresses are provided to a command that requires
zero addresses, it shall be an error. Otherwise, if more
than the required number of addresses are provided to a
command, the addresses specified first shall be evaluated
and then discarded until the maximum number of valid
addresses remain, for the specified command.</p>

<p style="margin-left:11%; margin-top: 1em">Addresses shall
be separated from each other by a comma (
<b>&rsquo;,&rsquo;</b> ) or semicolon character (
<b>&rsquo;;&rsquo;</b> ). In the case of a semicolon
separator, the current line ( <b>&rsquo;.&rsquo;</b> ) shall
be set to the first address, and only then will the second
address be calculated. This feature can be used to determine
the starting line for forwards and backwards searches; see
rules 5. and 6.</p>

<p style="margin-left:11%; margin-top: 1em">Addresses can
be omitted on either side of the comma or semicolon
separator, in which case the resulting address pairs shall
be as follows:</p>

<p style="margin-left:11%; margin-top: 1em">Any
&lt;blank&gt;s included between addresses, address
separators, or address offsets shall be ignored.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Commands in
ed</b> <br>
In the following list of <i>ed</i> commands, the default
addresses are shown in parentheses. The number of addresses
shown in the default shall be the number expected by the
command. The parentheses are not part of the address; they
show that the given addresses are the default.</p>

<p style="margin-left:11%; margin-top: 1em">It is generally
invalid for more than one command to appear on a line.
However, any command (except <b>e</b>, <b>E</b>, <b>f</b>,
<b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, and <b>!</b>) can be
suffixed by the letter <b>l</b>, <b>n</b>, or <b>p</b>; in
which case, except for the <b>l</b>, <b>n</b>, and <b>p</b>
commands, the command shall be executed and then the new
current line shall be written as described below under the
<b>l</b>, <b>n</b>, and <b>p</b> commands. When an <b>l</b>,
<b>n</b>, or <b>p</b> suffix is used with an <b>l</b>,
<b>n</b>, or <b>p</b> command, the command shall write to
standard output as described below, but it is unspecified
whether the suffix writes the current line again in the
requested format or whether the suffix has no effect. For
example, the <b>pl</b> command (base <b>p</b> command with
an <b>l</b> suffix) shall either write just the current line
or write it twice-once as specified for <b>p</b> and once as
specified for <b>l</b>. Also, the <b>g</b>, <b>G</b>,
<b>v</b>, and <b>V</b> commands shall take a command as a
parameter.</p>

<p style="margin-left:11%; margin-top: 1em">Each address
component can be preceded by zero or more &lt;blank&gt;s.
The command letter can be preceded by zero or more
&lt;blank&gt;s. If a suffix letter ( <b>l</b>, <b>n</b>, or
<b>p</b>) is given, the application shall ensure that it
immediately follows the command.</p>

<p style="margin-left:11%; margin-top: 1em">The <b>e</b>,
<b>E</b>, <b>f</b>, <b>r</b>, and <b>w</b> commands shall
take an optional <i>file</i> parameter, separated from the
command letter by one or more &lt;blank&gt;s.</p>

<p style="margin-left:11%; margin-top: 1em">If changes have
been made in the buffer since the last <b>w</b> command that
wrote the entire buffer, <i>ed</i> shall warn the user if an
attempt is made to destroy the editor buffer via the
<b>e</b> or <b>q</b> commands. The <i>ed</i> utility shall
write the string:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;?\n&quot;</b></p>

<p style="margin-left:11%; margin-top: 1em">(followed by an
explanatory message if <i>help mode</i> has been enabled via
the <b>H</b> command) to standard output and shall continue
in command mode with the current line number unchanged. If
the <b>e</b> or <b>q</b> command is repeated with no
intervening command, it shall take effect.</p>

<p style="margin-left:11%; margin-top: 1em">If a terminal
disconnect is detected:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">If the buffer is not empty and
has changed since the last write, the <i>ed</i> utility
shall attempt to write a copy of the buffer to a file named
<b>ed.hup</b> in the current directory. If this write fails,
<i>ed</i> shall attempt to write a copy of the buffer to a
filename <b>ed.hup</b> in the directory named by the
<i>HOME</i> environment variable. If both these attempts
fail, <i>ed</i> shall exit without saving the buffer.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>The <i>ed</i> utility shall not write the file to the
currently remembered pathname or return to command mode, and
shall terminate with a non-zero exit status.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">If an
end-of-file is detected on standard input:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">If the <i>ed</i> utility is in
input mode, <i>ed</i> shall terminate input mode and return
to command mode. It is unspecified if any partially entered
lines (that is, input text without a terminating
&lt;newline&gt;) are discarded from the input text.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>If the <i>ed</i> utility is in command mode, it shall
act as if a <b>q</b> command had been entered.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">If the closing
delimiter of an RE or of a replacement string (for example,
<b>&rsquo;/&rsquo;</b> ) in a <b>g</b>, <b>G</b>, <b>s</b>,
<b>v</b>, or <b>V</b> command would be the last character
before a &lt;newline&gt;, that delimiter can be omitted, in
which case the addressed line shall be written. For example,
the following pairs of commands are equivalent:</p>

<p style="margin-left:22%; margin-top: 1em"><b>s/s1/s2
s/s1/s2/p <br>
g/s1 g/s1/p <br>
?s1 ?s1?</b></p>

<p style="margin-left:11%; margin-top: 1em">If an invalid
command is entered, <i>ed</i> shall write the string:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;?\n&quot;</b></p>

<p style="margin-left:11%; margin-top: 1em">(followed by an
explanatory message if <i>help mode</i> has been enabled via
the <b>H</b> command) to standard output and shall continue
in command mode with the current line number unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Append
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(.)a <br>
&lt;</b><i>text</i><b>&gt; <br>
.</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>a</b>
command shall read the given text and append it after the
addressed line; the current line number shall become the
address of the last inserted line or, if there were none,
the addressed line. Address 0 shall be valid for this
command; it shall cause the appended text to be placed at
the beginning of the buffer.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Change
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(.,.)c <br>
&lt;</b><i>text</i><b>&gt; <br>
.</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>c</b>
command shall delete the addressed lines, then accept input
text that replaces these lines; the current line shall be
set to the address of the last line input; or, if there were
none, at the line after the last line deleted; if the lines
deleted were originally at the end of the buffer, the
current line number shall be set to the address of the new
last line; if no lines remain in the buffer, the current
line number shall be set to zero. Address 0 shall be valid
for this command; it shall be interpreted as if address 1
were specified.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Delete
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)d</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>d</b>
command shall delete the addressed lines from the buffer.
The address of the line after the last line deleted shall
become the current line number; if the lines deleted were
originally at the end of the buffer, the current line number
shall be set to the address of the new last line; if no
lines remain in the buffer, the current line number shall be
set to zero.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Edit
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>e
[</b><i>file</i><b>]</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>e</b>
command shall delete the entire contents of the buffer and
then read in the file named by the pathname <i>file</i>. The
current line number shall be set to the address of the last
line of the buffer. If no pathname is given, the currently
remembered pathname, if any, shall be used (see the <b>f</b>
command). The number of bytes read shall be written to
standard output, unless the <b>-s</b> option was specified,
in the following format:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;%d\n&quot;,
&lt;</b><i>number of bytes read</i><b>&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">The name
<i>file</i> shall be remembered for possible use as a
default pathname in subsequent <b>e</b>, <b>E</b>, <b>r</b>,
and <b>w</b> commands. If <i>file</i> is replaced by
<b>&rsquo;!&rsquo;</b>, the rest of the line shall be taken
to be a shell command line whose output is to be read. Such
a shell command line shall not be remembered as the current
<i>file</i>. All marks shall be discarded upon the
completion of a successful <b>e</b> command. If the buffer
has changed since the last time the entire buffer was
written, the user shall be warned, as described
previously.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Edit Without
Checking Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>E
[</b><i>file</i><b>]</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>E</b>
command shall possess all properties and restrictions of the
<b>e</b> command except that the editor shall not check to
see whether any changes have been made to the buffer since
the last <b>w</b> command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Filename
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>f
[</b><i>file</i><b>]</b></p>

<p style="margin-left:11%; margin-top: 1em">If <i>file</i>
is given, the <b>f</b> command shall change the currently
remembered pathname to <i>file</i>; whether the name is
changed or not, it shall then write the (possibly new)
currently remembered pathname to the standard output in the
following format:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;%s\n&quot;,
&lt;</b><i>pathname</i><b>&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">The current
line number shall be unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Global
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(1,$)g/</b><i>RE</i><b>/</b><i>command
list</i></p>

<p style="margin-left:11%; margin-top: 1em">In the <b>g</b>
command, the first step shall be to mark every line for
which the line excluding the terminating &lt;newline&gt;
matches the given RE. Then, going sequentially from the
beginning of the file to the end of the file, the given
<i>command list</i> shall be executed for each marked line,
with the current line number set to the address of that
line. Any line modified by the <i>command list</i> shall be
unmarked. When the <b>g</b> command completes, the current
line number shall have the value assigned by the last
command in the <i>command list</i>. If there were no
matching lines, the current line number shall not be
changed. A single command or the first of a list of commands
shall appear on the same line as the global command. All
lines of a multi-line list except the last line shall be
ended with a backslash preceding the terminating
&lt;newline&gt;; the <b>a</b>, <b>i</b>, and <b>c</b>
commands and associated input are permitted. The
<b>&rsquo;.&rsquo;</b> terminating input mode can be omitted
if it would be the last line of the <i>command list</i>. An
empty <i>command list</i> shall be equivalent to the
<b>p</b> command. The use of the <b>g</b>, <b>G</b>,
<b>v</b>, <b>V</b>, and <b>!</b> commands in the <i>command
list</i> produces undefined results. Any character other
than &lt;space&gt; or &lt;newline&gt; can be used instead of
a slash to delimit the RE. Within the RE, the RE delimiter
itself can be used as a literal character if it is preceded
by a backslash.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Interactive
Global Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(1,$)G/</b><i>RE</i><b>/</b></p>

<p style="margin-left:11%; margin-top: 1em">In the <b>G</b>
command, the first step shall be to mark every line for
which the line excluding the terminating &lt;newline&gt;
matches the given RE. Then, for every such line, that line
shall be written, the current line number shall be set to
the address of that line, and any one command (other than
one of the <b>a</b>, <b>c</b>, <b>i</b>, <b>g</b>, <b>G</b>,
<b>v</b>, and <b>V</b> commands) shall be read and executed.
A &lt;newline&gt; shall act as a null command (causing no
action to be taken on the current line); an
<b>&rsquo;&amp;&rsquo;</b> shall cause the re-execution of
the most recent non-null command executed within the current
invocation of <b>G</b>. Note that the commands input as part
of the execution of the <b>G</b> command can address and
affect any lines in the buffer. Any line modified by the
command shall be unmarked. The final value of the current
line number shall be the value set by the last command
successfully executed. (Note that the last command
successfully executed shall be the <b>G</b> command itself
if a command fails or the null command is specified.) If
there were no matching lines, the current line number shall
not be changed. The <b>G</b> command can be terminated by a
SIGINT signal. Any character other than &lt;space&gt; or
&lt;newline&gt; can be used instead of a slash to delimit
the RE and the replacement. Within the RE, the RE delimiter
itself can be used as a literal character if it is preceded
by a backslash.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Help
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>h</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>h</b>
command shall write a short message to standard output that
explains the reason for the most recent
<b>&rsquo;?&rsquo;</b> notification. The current line number
shall be unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Help-Mode
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>H</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>H</b>
command shall cause <i>ed</i> to enter a mode in which help
messages (see the <b>h</b> command) shall be written to
standard output for all subsequent <b>&rsquo;?&rsquo;</b>
notifications. The <b>H</b> command alternately shall turn
this mode on and off; it is initially off. If the help-mode
is being turned on, the <b>H</b> command also explains the
previous <b>&rsquo;?&rsquo;</b> notification, if there was
one. The current line number shall be unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Insert
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(.)i <br>
&lt;</b><i>text</i><b>&gt; <br>
.</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>i</b>
command shall insert the given text before the addressed
line; the current line is set to the last inserted line or,
if there was none, to the addressed line. This command
differs from the <b>a</b> command only in the placement of
the input text. Address 0 shall be valid for this command;
it shall be interpreted as if address 1 were specified.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Join
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.+1)j</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>j</b>
command shall join contiguous lines by removing the
appropriate &lt;newline&gt;s. If exactly one address is
given, this command shall do nothing. If lines are joined,
the current line number shall be set to the address of the
joined line; otherwise, the current line number shall be
unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Mark
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.)k</b><i>x</i></p>

<p style="margin-left:11%; margin-top: 1em">The <b>k</b>
command shall mark the addressed line with name <i>x</i>,
which the application shall ensure is a lowercase letter
from the portable character set. The address
<b>&quot;&rsquo;x&quot;</b> shall then refer to this line;
the current line number shall be unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>List
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)l</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>l</b>
command shall write to standard output the addressed lines
in a visually unambiguous form. The characters listed in the
Base Definitions volume of IEEE&nbsp;Std&nbsp;1003.1-2001,
Table 5-1, Escape Sequences and Associated Actions (
<b>&rsquo;\\&rsquo;</b>, <b>&rsquo;\a&rsquo;</b>,
<b>&rsquo;\b&rsquo;</b>, <b>&rsquo;\f&rsquo;</b>,
<b>&rsquo;\r&rsquo;</b>, <b>&rsquo;\t&rsquo;</b>,
<b>&rsquo;\v&rsquo;</b> ) shall be written as the
corresponding escape sequence; the <b>&rsquo;\n&rsquo;</b>
in that table is not applicable. Non-printable characters
not in the table shall be written as one three-digit octal
number (with a preceding backslash character) for each byte
in the character (most significant byte first). If the size
of a byte on the system is greater than nine bits, the
format used for non-printable characters is
implementation-defined.</p>

<p style="margin-left:11%; margin-top: 1em">Long lines
shall be folded, with the point of folding indicated by
&lt;newline&gt; preceded by a backslash; the length at which
folding occurs is unspecified, but should be appropriate for
the output device. The end of each line shall be marked with
a <b>&rsquo;$&rsquo;</b>, and <b>&rsquo;$&rsquo;</b>
characters within the text shall be written with a preceding
backslash. An <b>l</b> command can be appended to any other
command other than <b>e</b>, <b>E</b>, <b>f</b>, <b>q</b>,
<b>Q</b>, <b>r</b>, <b>w</b>, or <b>!</b>. The current line
number shall be set to the address of the last line
written.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Move
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)m</b><i>address</i></p>

<p style="margin-left:11%; margin-top: 1em">The <b>m</b>
command shall reposition the addressed lines after the line
addressed by <i>address</i>. Address 0 shall be valid for
<i>address</i> and cause the addressed lines to be moved to
the beginning of the buffer. It shall be an error if address
<i>address</i> falls within the range of moved lines. The
current line number shall be set to the address of the last
line moved.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Number
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)n</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>n</b>
command shall write to standard output the addressed lines,
preceding each line by its line number and a &lt;tab&gt;;
the current line number shall be set to the address of the
last line written. The <b>n</b> command can be appended to
any command other than <b>e</b>, <b>E</b>, <b>f</b>,
<b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, or <b>!</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Print
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)p</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>p</b>
command shall write to standard output the addressed lines;
the current line number shall be set to the address of the
last line written. The <b>p</b> command can be appended to
any command other than <b>e</b>, <b>E</b>, <b>f</b>,
<b>q</b>, <b>Q</b>, <b>r</b>, <b>w</b>, or <b>!</b>.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Prompt
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>P</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>P</b>
command shall cause <i>ed</i> to prompt with an asterisk (
<b>&rsquo;*&rsquo;</b> ) (or <i>string</i>, if <b>-p</b> is
specified) for all subsequent commands. The <b>P</b> command
alternatively shall turn this mode on and off; it shall be
initially on if the <b>-p</b> option is specified;
otherwise, off. The current line number shall be
unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Quit
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>q</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>q</b>
command shall cause <i>ed</i> to exit. If the buffer has
changed since the last time the entire buffer was written,
the user shall be warned, as described previously.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Quit Without
Checking Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>Q</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>Q</b>
command shall cause <i>ed</i> to exit without checking
whether changes have been made in the buffer since the last
<b>w</b> command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Read
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>($)r
[</b><i>file</i><b>]</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>r</b>
command shall read in the file named by the pathname
<i>file</i> and append it after the addressed line. If no
<i>file</i> argument is given, the currently remembered
pathname, if any, shall be used (see the <b>e</b> and
<b>f</b> commands). The currently remembered pathname shall
not be changed unless there is no remembered pathname.
Address 0 shall be valid for <b>r</b> and shall cause the
file to be read at the beginning of the buffer. If the read
is successful, and <b>-s</b> was not specified, the number
of bytes read shall be written to standard output in the
following format:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;%d\n&quot;,
&lt;</b><i>number of bytes read</i><b>&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">The current
line number shall be set to the address of the last line
read in. If <i>file</i> is replaced by
<b>&rsquo;!&rsquo;</b>, the rest of the line shall be taken
to be a shell command line whose output is to be read. Such
a shell command line shall not be remembered as the current
pathname.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Substitute
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)s/</b><i>RE</i><b>/</b><i>replacement</i><b>/</b><i>flags</i></p>

<p style="margin-left:11%; margin-top: 1em">The <b>s</b>
command shall search each addressed line for an occurrence
of the specified RE and replace either the first or all
(non-overlapped) matched strings with the
<i>replacement</i>; see the following description of the
<b>g</b> suffix. It is an error if the substitution fails on
every addressed line. Any character other than &lt;space&gt;
or &lt;newline&gt; can be used instead of a slash to delimit
the RE and the replacement. Within the RE, the RE delimiter
itself can be used as a literal character if it is preceded
by a backslash. The current line shall be set to the address
of the last line on which a substitution occurred.</p>

<p style="margin-left:11%; margin-top: 1em">An ampersand (
<b>&rsquo;&amp;&rsquo;</b> ) appearing in the
<i>replacement</i> shall be replaced by the string matching
the RE on the current line. The special meaning of
<b>&rsquo;&amp;&rsquo;</b> in this context can be suppressed
by preceding it by backslash. As a more general feature, the
characters <b>&rsquo;\n&rsquo;</b>, where <i>n</i> is a
digit, shall be replaced by the text matched by the
corresponding back-reference expression. When the character
<b>&rsquo;%&rsquo;</b> is the only character in the
<i>replacement</i>, the <i>replacement</i> used in the most
recent substitute command shall be used as the
<i>replacement</i> in the current substitute command; if
there was no previous substitute command, the use of
<b>&rsquo;%&rsquo;</b> in this manner shall be an error. The
<b>&rsquo;%&rsquo;</b> shall lose its special meaning when
it is in a replacement string of more than one character or
is preceded by a backslash. For each backslash (
<b>&rsquo;\&rsquo;</b> ) encountered in scanning
<i>replacement</i> from beginning to end, the following
character shall lose its special meaning (if any). It is
unspecified what special meaning is given to any character
other than <b>&rsquo;&amp;&rsquo;</b>,
<b>&rsquo;\&rsquo;</b>, <b>&rsquo;%&rsquo;</b>, or
digits.</p>

<p style="margin-left:11%; margin-top: 1em">A line can be
split by substituting a &lt;newline&gt; into it. The
application shall ensure it escapes the &lt;newline&gt; in
the <i>replacement</i> by preceding it by backslash. Such
substitution cannot be done as part of a <b>g</b> or
<b>v</b> <i>command list</i>. The current line number shall
be set to the address of the last line on which a
substitution is performed. If no substitution is performed,
the current line number shall be unchanged. If a line is
split, a substitution shall be considered to have been
performed on each of the new lines for the purpose of
determining the new current line number. A substitution
shall be considered to have been performed even if the
replacement string is identical to the string that it
replaces.</p>

<p style="margin-left:11%; margin-top: 1em">The application
shall ensure that the value of <i>flags</i> is zero or more
of:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><i>count</i></p></td>
<td width="4%"></td>
<td width="78%">


<p>Substitute for the <i>count</i>th occurrence only of the
RE found on each addressed line.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>g</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Globally substitute for all non-overlapping instances of
the RE rather than just the first one. If both <b>g</b> and
<i>count</i> are specified, the results are unspecified.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>l</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Write to standard output the final line in which a
substitution was made. The line shall be written in the
format specified for the <b>l</b> command.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>n</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Write to standard output the final line in which a
substitution was made. The line shall be written in the
format specified for the <b>n</b> command.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>p</b></p></td>
<td width="4%"></td>
<td width="78%">


<p>Write to standard output the final line in which a
substitution was made. The line shall be written in the
format specified for the <b>p</b> command.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><b>Copy
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.,.)t</b><i>address</i></p>

<p style="margin-left:11%; margin-top: 1em">The <b>t</b>
command shall be equivalent to the <b>m</b> command, except
that a copy of the addressed lines shall be placed after
address <i>address</i> (which can be 0); the current line
number shall be set to the address of the last line
added.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Undo
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>u</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>u</b>
command shall nullify the effect of the most recent command
that modified anything in the buffer, namely the most recent
<b>a</b>, <b>c</b>, <b>d</b>, <b>g</b>, <b>i</b>, <b>j</b>,
<b>m</b>, <b>r</b>, <b>s</b>, <b>t</b>, <b>u</b>, <b>v</b>,
<b>G</b>, or <b>V</b> command. All changes made to the
buffer by a <b>g</b>, <b>G</b>, <b>v</b>, or <b>V</b> global
command shall be undone as a single change; if no changes
were made by the global command (such as with <b>g</b>/RE/
<b>p</b>), the <b>u</b> command shall have no effect. The
current line number shall be set to the value it had
immediately before the command being undone started.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Global
Non-Matched Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(1,$)v/</b><i>RE</i><b>/</b><i>command
list</i></p>

<p style="margin-left:11%; margin-top: 1em">This command
shall be equivalent to the global command <b>g</b> except
that the lines that are marked during the first step shall
be those for which the line excluding the terminating
&lt;newline&gt; does not match the RE.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Interactive
Global Not-Matched Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(1,$)V/</b><i>RE</i><b>/</b></p>

<p style="margin-left:11%; margin-top: 1em">This command
shall be equivalent to the interactive global command
<b>G</b> except that the lines that are marked during the
first step shall be those for which the line excluding the
terminating &lt;newline&gt; does not match the RE.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Write
Command</b> <i><br>
Synopsis</i>:</p>

<p style="margin-left:22%; margin-top: 1em"><b>(1,$)w
[</b><i>file</i><b>]</b></p>

<p style="margin-left:11%; margin-top: 1em">The <b>w</b>
command shall write the addressed lines into the file named
by the pathname <i>file</i>. The command shall create the
file, if it does not exist, or shall replace the contents of
the existing file. The currently remembered pathname shall
not be changed unless there is no remembered pathname. If no
pathname is given, the currently remembered pathname, if
any, shall be used (see the <b>e</b> and <b>f</b> commands);
the current line number shall be unchanged. If the command
is successful, the number of bytes written shall be written
to standard output, unless the <b>-s</b> option was
specified, in the following format:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;%d\n&quot;,
&lt;</b><i>number of bytes written</i><b>&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">If <i>file</i>
begins with <b>&rsquo;!&rsquo;</b>, the rest of the line
shall be taken to be a shell command line whose standard
input shall be the addressed lines. Such a shell command
line shall not be remembered as the current pathname. This
usage of the write command with <b>&rsquo;!&rsquo;</b> shall
not be considered as a &quot;last <b>w</b> command that
wrote the entire buffer&quot;, as described previously;
thus, this alone shall not prevent the warning to the user
if an attempt is made to destroy the editor buffer via the
<b>e</b> or <b>q</b> commands.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Line Number
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>($)=</b></p>

<p style="margin-left:11%; margin-top: 1em">The line number
of the addressed line shall be written to standard output in
the following format:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;%d\n&quot;,
&lt;</b><i>line number</i><b>&gt;</b></p>

<p style="margin-left:11%; margin-top: 1em">The current
line number shall be unchanged by this command.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Shell Escape
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>!</b><i>command</i></p>

<p style="margin-left:11%; margin-top: 1em">The remainder
of the line after the <b>&rsquo;!&rsquo;</b> shall be sent
to the command interpreter to be interpreted as a shell
command line. Within the text of that shell command line,
the unescaped character <b>&rsquo;%&rsquo;</b> shall be
replaced with the remembered pathname; if a
<b>&rsquo;!&rsquo;</b> appears as the first character of the
command, it shall be replaced with the text of the previous
shell command executed via <b>&rsquo;!&rsquo;</b> . Thus,
<b>&quot;!!&quot;</b> shall repeat the previous
!<i>command</i>. If any replacements of
<b>&rsquo;%&rsquo;</b> or <b>&rsquo;!&rsquo;</b> are
performed, the modified line shall be written to the
standard output before <i>command</i> is executed. The
<b>!</b> command shall write:</p>


<p style="margin-left:22%; margin-top: 1em"><b>&quot;!\n&quot;</b></p>

<p style="margin-left:11%; margin-top: 1em">to standard
output upon completion, unless the <b>-s</b> option is
specified. The current line number shall be unchanged.</p>

<p style="margin-left:11%; margin-top: 1em"><b>Null
Command</b> <i><br>
Synopsis</i>:</p>


<p style="margin-left:22%; margin-top: 1em"><b>(.+1)</b></p>

<p style="margin-left:11%; margin-top: 1em">An address
alone on a line shall cause the addressed line to be
written. A &lt;newline&gt; alone shall be equivalent to
<b>&quot;+1p&quot;</b> . The current line number shall be
set to the address of the written line.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The following
exit values shall be returned:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&nbsp; 0</p></td>
<td width="8%"></td>
<td width="78%">


<p>Successful completion without any file or command
errors.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p>&gt;0</p></td>
<td width="8%"></td>
<td width="78%">


<p>An error occurred.</p></td></tr>
</table>

<h2>CONSEQUENCES OF ERRORS
<a name="CONSEQUENCES OF ERRORS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">When an error
in the input script is encountered, or when an error is
detected that is a consequence of the data (not) present in
the file or due to an external condition such as a read or
write error:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">If the standard input is a
terminal device file, all input shall be flushed, and a new
command read.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>If the standard input is a regular file, <i>ed</i> shall
terminate with a non-zero exit status.</p></td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em"><i>The
following sections are informative.</i></p>

<h2>APPLICATION USAGE
<a name="APPLICATION USAGE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Because of the
extremely terse nature of the default error messages, the
prudent script writer begins the <i>ed</i> input commands
with an <b>H</b> command, so that if any errors do occur at
least some clue as to the cause is made available.</p>

<p style="margin-left:11%; margin-top: 1em">In previous
versions, an obsolescent <b>-</b> option was described. This
is no longer specified. Applications should use the
<b>-s</b> option. Using <b>-</b> as a <i>file</i> operand
now produces unspecified results. This allows
implementations to continue to support the former required
behavior.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>RATIONALE
<a name="RATIONALE"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The initial
description of this utility was adapted from the SVID. It
contains some features not found in Version 7 or BSD-derived
systems. Some of the differences between the POSIX and BSD
<i>ed</i> utilities include, but need not be limited to:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p style="margin-top: 1em">*</p></td>
<td width="1%"></td>
<td width="85%">


<p style="margin-top: 1em">The BSD <b>-</b> option does not
suppress the <b>&rsquo;!&rsquo;</b> prompt after a <b>!</b>
command.</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the special meanings of the
<b>&rsquo;%&rsquo;</b> and <b>&rsquo;!&rsquo;</b> characters
within a <b>!</b> command.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the <i>addresses</i>
<b>&rsquo;;&rsquo;</b> and <b>&rsquo;,&rsquo;</b> .</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD allows the command/suffix pairs <b>pp</b>,
<b>ll</b>, and so on, which are unspecified in this volume
of IEEE&nbsp;Std&nbsp;1003.1-2001.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the <b>&rsquo;!&rsquo;</b>
character part of the <b>e</b>, <b>r</b>, or <b>w</b>
commands.</p> </td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>A failed <b>g</b> command in BSD sets the line number to
the last line searched if there are no matches.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not default the <i>command list</i> to the
<b>p</b> command.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the <b>G</b>, <b>h</b>, <b>H</b>,
<b>n</b>, or <b>V</b> commands.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>On BSD, if there is no inserted text, the insert command
changes the current line to the referenced line -1; that is,
the line before the specified line.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>On BSD, the <i>join</i> command with only a single
address changes the current line to that address.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the <b>P</b> command; moreover, in
BSD it is synonymous with the <b>p</b> command.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>BSD does not support the <i>undo</i> of the commands
<b>j</b>, <b>m</b>, <b>r</b>, <b>s</b>, or <b>t</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="12%"></td>
<td width="2%">


<p>*</p></td>
<td width="1%"></td>
<td width="85%">


<p>The Version 7 <i>ed</i> command <b>W</b>, and the BSD
<i>ed</i> commands <b>W</b>, <b>wq</b>, and <b>z</b> are not
present in this volume of
IEEE&nbsp;Std&nbsp;1003.1-2001.</p> </td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">The <b>-s</b>
option was added to allow the functionality of the now
withdrawn <b>-</b> option in a manner compatible with the
Utility Syntax Guidelines.</p>

<p style="margin-left:11%; margin-top: 1em">In early
proposals there was a limit, {ED_FILE_MAX}, that described
the historical limitations of some <i>ed</i> utilities in
their handling of large files; some of these have had
problems with files larger than 100000 bytes. It was this
limitation that prompted much of the desire to include a
<i>split</i> command in this volume of
IEEE&nbsp;Std&nbsp;1003.1-2001. Since this limit was
removed, this volume of IEEE&nbsp;Std&nbsp;1003.1-2001
requires that implementations document the file size limits
imposed by <i>ed</i> in the conformance document. The limit
{ED_LINE_MAX} was also removed; therefore, the global limit
{LINE_MAX} is used for input and output lines.</p>

<p style="margin-left:11%; margin-top: 1em">The manner in
which the <b>l</b> command writes non-printable characters
was changed to avoid the historical backspace-overstrike
method. On video display terminals, the overstrike is
ambiguous because most terminals simply replace overstruck
characters, making the <b>l</b> format not useful for its
intended purpose of unambiguously understanding the content
of the line. The historical backslash escapes were also
ambiguous. (The string <b>&quot;a\0011&quot;</b> could
represent a line containing those six characters or a line
containing the three characters <b>&rsquo;a&rsquo;</b>, a
byte with a binary value of 1, and a 1.) In the format
required here, a backslash appearing in the line is written
as <b>&quot;\\&quot;</b> so that the output is truly
unambiguous. The method of marking the ends of lines was
adopted from the <i>ex</i> editor and is required for any
line ending in &lt;space&gt;s; the <b>&rsquo;$&rsquo;</b> is
placed on all lines so that a real <b>&rsquo;$&rsquo;</b> at
the end of a line cannot be misinterpreted.</p>

<p style="margin-left:11%; margin-top: 1em">Systems with
bytes too large to fit into three octal digits must devise
other means of displaying non-printable characters.
Consideration was given to requiring that the number of
octal digits be large enough to hold a byte, but this seemed
to be too confusing for applications on the vast majority of
systems where three digits are adequate. It would be
theoretically possible for the application to use the
<i>getconf</i> utility to find out the CHAR_BIT value and
deal with such an algorithm; however, there is really no
portable way that an application can use the octal values of
the bytes across various coded character sets, so the
additional specification was not worthwhile.</p>

<p style="margin-left:11%; margin-top: 1em">The description
of how a NUL is written was removed. The NUL character
cannot be in text files, and this volume of
IEEE&nbsp;Std&nbsp;1003.1-2001 should not dictate behavior
in the case of undefined, erroneous input.</p>

<p style="margin-left:11%; margin-top: 1em">Unlike some of
the other editing utilities, the filenames accepted by the
<b>E</b>, <b>e</b>, <b>R</b>, and <b>r</b> commands are not
patterns.</p>

<p style="margin-left:11%; margin-top: 1em">Early proposals
stated that the <b>-p</b> option worked only when standard
input was associated with a terminal device. This has been
changed to conform to historical implementations, thereby
allowing applications to interpose themselves between a user
and the <i>ed</i> utility.</p>

<p style="margin-left:11%; margin-top: 1em">The form of the
substitute command that uses the <b>n</b> suffix was limited
in some historical documentation (where this was described
incorrectly as &quot;backreferencing&quot;). This limit has
been omitted because there is no reason why an editor
processing lines of {LINE_MAX} length should have this
restriction. The command <b>s/x/X/2047</b> should be able to
substitute the 2047th occurrence of <b>&rsquo;x&rsquo;</b>
on a line.</p>

<p style="margin-left:11%; margin-top: 1em">The use of
printing commands with printing suffixes (such as <b>pn</b>,
<b>lp</b>, and so on) was made unspecified because BSD-based
systems allow this, whereas System V does not.</p>

<p style="margin-left:11%; margin-top: 1em">Some BSD-based
systems exit immediately upon receipt of end-of-file if all
of the lines in the file have been deleted. Since this
volume of IEEE&nbsp;Std&nbsp;1003.1-2001 refers to the
<b>q</b> command in this instance, such behavior is not
allowed.</p>

<p style="margin-left:11%; margin-top: 1em">Some historical
implementations returned exit status zero even if command
errors had occurred; this is not allowed by this volume of
IEEE&nbsp;Std&nbsp;1003.1-2001.</p>

<p style="margin-left:11%; margin-top: 1em">Some historical
implementations contained a bug that allowed a single period
to be entered in input mode as &lt;backslash&gt;
&lt;period&gt; &lt;newline&gt;. This is not allowed by
<i>ed</i> because there is no description of escaping any of
the characters in input mode; backslashes are entered into
the buffer exactly as typed. The typical method of entering
a single period has been to precede it with another
character and then use the substitute command to delete that
character.</p>

<p style="margin-left:11%; margin-top: 1em">It is difficult
under some modes of some versions of historical operating
system terminal drivers to distinguish between an
end-of-file condition and terminal disconnect.
IEEE&nbsp;Std&nbsp;1003.1-2001 does not require
implementations to distinguish between the two situations,
which permits historical implementations of the <i>ed</i>
utility on historical platforms to conform. Implementations
are encouraged to distinguish between the two, if possible,
and take appropriate action on terminal disconnect.</p>

<p style="margin-left:11%; margin-top: 1em">Historically,
<i>ed</i> accepted a zero address for the <b>a</b> and
<b>r</b> commands in order to insert text at the start of
the edit buffer. When the buffer was empty the command
<b>.=</b> returned zero. IEEE&nbsp;Std&nbsp;1003.1-2001
requires conformance to historical practice.</p>

<p style="margin-left:11%; margin-top: 1em">For consistency
with the <b>a</b> and <b>r</b> commands and better user
functionality, the <b>i</b> and <b>c</b> commands must also
accept an address of 0, in which case 0<i>i</i> is treated
as 1<i>i</i> and likewise for the <b>c</b> command.</p>

<p style="margin-left:11%; margin-top: 1em">All of the
following are valid addresses:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p style="margin-top: 1em"><b>+++</b></p></td>
<td width="7%"></td>
<td width="53%">


<p style="margin-top: 1em">Three lines after the current
line.</p> </td>
<td width="25%">
</td></tr>
</table>


<p style="margin-left:11%;"><b>/</b><i>pattern</i><b>/-</b></p>

<p style="margin-left:22%;">One line before the next
occurrence of pattern.</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="3%">


<p><b>-2</b></p></td>
<td width="8%"></td>
<td width="52%">


<p>Two lines before the current line.</p></td>
<td width="26%">
</td></tr>
</table>

<p style="margin-left:11%;"><b>3&nbsp;----&nbsp;2</b></p>

<p style="margin-left:22%;">Line one (note the intermediate
negative address).</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="7%">


<p><b>1&nbsp;2&nbsp;3</b></p></td>
<td width="4%"></td>
<td width="13%">


<p>Line six.</p></td>
<td width="65%">
</td></tr>
</table>

<p style="margin-left:11%; margin-top: 1em">Any number of
addresses can be provided to commands taking addresses; for
example, <b>&quot;1,2,3,4,5p&quot;</b> prints lines 4 and 5,
because two is the greatest valid number of addresses
accepted by the <b>print</b> command. This, in combination
with the semicolon delimiter, permits users to create
commands based on ordered patterns in the file. For example,
the command <b>&quot;3;/foo/;+2p&quot;</b> will display the
first line after line 3 that contains the pattern
<i>foo</i>, plus the next two lines. Note that the address
<b>&quot;3;&quot;</b> must still be evaluated before being
discarded, because the search origin for the
<b>&quot;/foo/&quot;</b> command depends on this.</p>

<p style="margin-left:11%; margin-top: 1em">Historically,
<i>ed</i> disallowed address chains, as discussed above,
consisting solely of comma or semicolon separators; for
example, <b>&quot;,,,&quot;</b> or <b>&quot;;;;&quot;</b>
were considered an error. For consistency of address
specification, this restriction is removed. The following
table lists some of the address forms now possible:</p>

<p style="margin-left:11%; margin-top: 1em">&nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
&nbsp;</p>

<p style="margin-left:11%; margin-top: 1em">Historically,
values could be added to addresses by including them after
one or more &lt;blank&gt;s; for example,
<b>&quot;3&nbsp;-&nbsp;5p&quot;</b> wrote the seventh line
of the file, and <b>&quot;/foo/&nbsp;5&quot;</b> was the
same as <b>&quot;5&nbsp;/foo/&quot;</b> . However, only
absolute values could be added; for example,
<b>&quot;5&nbsp;/foo/&quot;</b> was an error.
IEEE&nbsp;Std&nbsp;1003.1-2001 requires conformance to
historical practice.</p>

<p style="margin-left:11%; margin-top: 1em">Historically,
<i>ed</i> accepted the <b>&rsquo;^&rsquo;</b> character as
an address, in which case it was identical to the hyphen
character. IEEE&nbsp;Std&nbsp;1003.1-2001 does not require
or prohibit this behavior.</p>

<h2>FUTURE DIRECTIONS
<a name="FUTURE DIRECTIONS"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">None.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><i>Utility
Description Defaults</i>, <i>ex</i>, <i>sed</i>, <i>sh</i>,
<i>vi</i></p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Portions of
this text are reprinted and reproduced in electronic form
from IEEE Std 1003.1, 2003 Edition, Standard for Information
Technology -- Portable Operating System Interface (POSIX),
The Open Group Base Specifications Issue 6, Copyright (C)
2001-2003 by the Institute of Electrical and Electronics
Engineers, Inc and The Open Group. In the event of any
discrepancy between this version and the original IEEE and
The Open Group Standard, the original IEEE and The Open
Group Standard is the referee document. The original
Standard can be obtained online at
http://www.opengroup.org/unix/online.html .</p>
<hr>
</body>
</html>
